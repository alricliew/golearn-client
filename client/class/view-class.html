<!doctype html>
<html lang="en">

<head>
  <title>GoLearn Tutor</title>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <!--     Fonts and icons     -->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <script src="https://kit.fontawesome.com/2bdd669e92.js" crossorigin="anonymous"></script>
  <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous"> -->
  <!-- Material Kit CSS -->
  <link href="../../assets/css/material-dashboard.css?v=2.1.2" rel="stylesheet" />
  <!-- <link href="../assets/demo/demo.css" rel="stylesheet" /> -->
  <link href="../css/tutor-portal.css" rel="stylesheet" />
  <!-- Firebase Init -->
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-storage.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-firestore.js"></script>
  <script src="../js/firebase.js"></script>
  <link href="../../assets/css/multistepform.css" rel="stylesheet" />
  <link href="../../assets/css/multitabform.css" rel="stylesheet" />
  <link href="../../assets/css/mc-calendar.min.css" rel="stylesheet"/>
  <link href="../../assets/css/star-rating.css" media="all" rel="stylesheet" type="text/css"/>

  <!-- ClockPicker Stylesheet -->
  <link rel="stylesheet" type="text/css" href="../../assets/css/bootstrap-clockpicker.min.css">

  <style>
    #addStudentModal{
      overflow-y:auto;
    }
  </style>
</head>

<body>

  <div class="wrapper ">
    <div class="sidebar" data-color="purple" data-background-color="white" data-image="../../assets/img/sidebar-3.jpg">

      <div class="logo">
        <a href="../" class="simple-text logo-mini">
			    <img src="../../assets/img/logo.png" style="width: 216px; height: auto;" alt=""></img>
          
        </a>
        <a href="../" class="simple-text logo-normal">
         Welcome!
        </a>
      </div>
      <div class="sidebar-wrapper">
        <ul class="nav">
          <li class="nav-item">
            <a class="nav-link" href="../">
              <i class="material-icons">home</i>
              <p>Home</p>
            </a>
          </li>
		  		<li class="nav-item active">
            <a class="nav-link" href="../class/">
              <i class="material-icons">school</i>
              <p>My Classes</p>
            </a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="../dependant/">
              <i class="material-icons">escalator_warning</i>
              <p>My Dependants</p>
            </a>
          </li>
		  		<!-- <li class="nav-item">
            <a class="nav-link" href="./job.html">
              <i class="material-icons">work_outline</i>
              <p>Tuition Jobs</p>
            </a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="./course.html">
              <i class="material-icons">format_list_bulleted</i>
              <p>My Courses</p>
            </a>
          </li>
          <li class="nav-item active">
            <a class="nav-link" href="./update.html">
              <i class="material-icons">note_alt</i>
              <p>Update Information</p>
            </a>
          </li> -->
        </ul>
      </div>
    </div>
    <div class="main-panel">
      <!-- Navbar -->
      <nav class="navbar navbar-expand-lg navbar-transparent navbar-absolute fixed-top ">
        <div class="container-fluid">
          <div class="navbar-wrapper">
            <a class="navbar-brand" href="javascript:;">Classes <span><i class="material-icons" style="color: gray;">chevron_right</i></span> <span id="titleClassName">View Class</span></a>
          </div>
          <button class="navbar-toggler" type="button" data-toggle="collapse" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="navbar-toggler-icon icon-bar"></span>
            <span class="navbar-toggler-icon icon-bar"></span>
            <span class="navbar-toggler-icon icon-bar"></span>
          </button>
          <div class="collapse navbar-collapse justify-content-end">
            <form class="navbar-form">
              <!-- Put empty placeholder here -->
            </form>

            <ul class="navbar-nav">
              <li class="nav-item" id="activationNavItem">
                <a href="#" class="btn btn-danger btn-round" style="visibility: hidden;" id="btnActivateAccount" ></a>
              </li>
              <li class="nav-item">
                <a class="navbar-brand" href="javascript:;">
                   Hi <span id="user"></span> !
                </a> 
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link" href="javascript:;" id="navbarDropdownNotification" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <i class="material-icons">notifications</i> Notifications
                </a>
                <!-- <a class="nav-link" href="http://example.com" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <i class="material-icons">notifications</i>
                  <span class="notification">5</span>
                  <p class="d-lg-none d-md-block">
                    Some Actions
                  </p>
                </a> -->
								<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
									<p style="padding: 1em;" >No notification</p>
                  <!-- <a class="dropdown-item" href="#">Mike John responded to your email</a>
                  <a class="dropdown-item" href="#">You have 5 new tasks</a>
                  <a class="dropdown-item" href="#">You're now friend with Andrew</a>
                  <a class="dropdown-item" href="#">Another Notification</a>
                  <a class="dropdown-item" href="#">Another One</a> -->
                </div>
              </li>
              <!-- your navbar here -->
			  
			  			<li class="nav-item dropdown">
                <a class="nav-link" href="javascript:;" id="navbarDropdownProfile" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <i class="material-icons">person</i>
                  <p class="d-lg-none d-md-block">
                    Account
                  </p>
                </a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownProfile">
                  <a class="dropdown-item" href="../edit-profile.html">Edit Profile</a>
									<a class="display:block; dropdown-item" href="../about.html">About</a>
									<div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="javascript:;" onclick="signOutFunction()" id="btn-logout">Log out</a>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </nav>
      <!-- End Navbar -->

			<!-- Modal Start -->

      <!-- Add Lesson Modal -->
      <div class="row">
        <div class="modal fade" id="addLessonModal" tabindex="-1" role="dialog" aria-labelledby="addLessonModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="addLessonModalLabel">Add Lesson</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group">
                      <span class="" style="font-size: smaller; font-weight: 300; color: gray;">Date</span> 
                      <div class="input-group" data-placement="bottom" data-align="top" data-autoclose="true" style="margin-top: 0.3rem;">
                        <input id="datepicker" class="form-control" type="text" data-compulsory="true" oninput="this.className = 'form-control'" style="cursor:pointer;" readonly>
                        <!-- <span class="d-flex align-items-center input-group-addon">
                          <i class="fas fa-calendar-alt fa-fw" id="datepicker_btn"></i>
                        </span>  -->
                      </div>

                    </div>
                  </div>

                  <div class="col-md-3">
                    <div class="form-group"  >
                      <span class="" style="font-size: smaller; font-weight: 300; color: gray;">Start Time</span> 
                      <div class="input-group clockpicker" data-placement="bottom" data-align="top" data-autoclose="true" style="margin-top: 0.3rem;">
                        <input id="addLessonStart" type="text" class="form-control" data-compulsory="true" oninput="this.className = 'form-control'" style="cursor:pointer;" readonly>
                        <!-- <span class="d-flex align-items-center input-group-addon" >
                          <span class="material-icons">
                            more_time
                          </span>
                        </span> -->
                      </div>  
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="form-group">
                      <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">End Time</span> 
                      <div class="input-group clockpicker" data-placement="bottom" data-align="top" data-autoclose="true" style="margin-top: 0.3rem;">
                        <input id="addLessonEnd" type="text" class="form-control" data-compulsory="true" oninput="this.className = 'form-control'" style="cursor:pointer;" readonly>
                        <!-- <span class="d-flex align-items-center input-group-addon">
                          <span class="material-icons">
                            more_time
                          </span>
                        </span> -->
                      </div>  
                    </div>
                  </div>
                </div>

                <div class="form-group" >
                  <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Lesson Description</span> 
                  <textarea class="form-control" maxlength="255" rows="3" id="addLessonDesc" placeholder="Write something ..."></textarea>
                </div>


                <div class="form-group" >
                  <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Feedback</span> 
                  <textarea class="form-control" maxlength="255" rows="3" id="addLessonFeedback" placeholder="Write something ..."></textarea>
                </div>


                <div class="form-group" >
                  <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Lesson Performance</span> 
                  <input id="addLessonRate" type="text" class="rating" data-theme="krajee-fas" data-min=0 data-max=5 data-step=1 data-size="lg" required title="">                
                </div>

                <div class="clearfix"></div>

              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnAddLessonModalUpdate" disabled>Add</button>
              </div>
            </div>
          </div>
        </div>
      
      </div>

      <!-- Edit Lesson Modal -->
      <div class="row">
        <div class="modal fade" id="editLessonModal" tabindex="-1" role="dialog" aria-labelledby="editLessonModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="editLessonModalLabel">Lesson Details</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <div class="row">
                  <div id="editLessonId" value=""></div>
                  <div class="col-md-6">
                    <div class="form-group">
                      <span class="" style="font-size: smaller; font-weight: 300; color: gray;">Date</span> 
                      <div class="input-group" data-placement="bottom" data-align="top" data-autoclose="true" style="margin-top: 0.3rem;">
                        <input id="editLessonDatepicker" class="form-control" type="text" data-compulsory="true" oninput="this.className = 'form-control'" readonly>
                      </div>
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="form-group"  >
                      <span class="" style="font-size: smaller; font-weight: 300; color: gray;">Start Time</span> 
                      <div class="input-group clockpicker" data-placement="bottom" data-align="top" data-autoclose="true" style="margin-top: 0.3rem;">
                        <input id="editLessonStart" type="text" class="form-control" data-compulsory="true" oninput="this.className = 'form-control'"readonly>
                      </div>  
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="form-group">
                      <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">End Time</span> 
                      <div class="input-group clockpicker" data-placement="bottom" data-align="top" data-autoclose="true" style="margin-top: 0.3rem;">
                        <input id="editLessonEnd" type="text" class="form-control" data-compulsory="true" oninput="this.className = 'form-control'" readonly>
                      </div>  
                    </div>
                  </div>
                </div>
                <div class="form-group" >
                  <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Lesson Description</span> 
                  <textarea class="form-control" maxlength="255" rows="3" id="editLessonDesc" placeholder="Write something ..." readonly></textarea>
                </div>
                <div class="form-group" >
                  <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Feedback</span> 
                  <textarea class="form-control" maxlength="255" rows="3" id="editLessonFeedback" placeholder="Write something ..." readonly></textarea>
                </div>
                <div class="form-group" >
                  <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Class Performance</span> 
                  <input id="editLessonRate" type="text" class="rating" data-theme="krajee-fas" data-min=0 data-max=5 data-step=1 data-size="lg" required title="" readonly>                
                </div>
                <div class="clearfix"></div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <!-- <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnEditLessonModalUpdate">Update</button> -->
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Remove Lesson modal -->
      <div class="row">
        <div class="modal fade" id="delLessonModal" tabindex="-1" role="dialog" aria-labelledby="delLessonModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="delLessonLabel">Delete This Lesson</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnDelLessonModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="delLessonModalBody">
                <div id="deleteLessonId" value=""></div>
                Are you sure you want to continue?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnDelLessonModalClose2">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnDelLessonModalUpdate">Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- List / Load Admin's Students Modal -->
      <div class="row">
        <div class="modal fade" id="addStudentModal" tabindex="-1" role="dialog" aria-labelledby="addStudentModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered modal-lg" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="addStudentModalLabel">Add Student</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <div class="row">
                  <div class="col-md-12" id="loadAdminStudentTop">
                          
                    <div class="container" id="add-student-modal-container">
                      <!-- Student header -->
                      <div class="row lesson-header">
                        <div class="col-md-3">
                          <p>Student Name</p>
                        </div>
                        <div class="col-md-3">
                          <p>Gender</p>
                        </div>
                        <div class="col-md-3">
                          <p>Guardian Name</p>
                        </div>
                        <div class="col-md-3">
                          <p>Action</p> 
                        </div>
                      </div>

                      <!-- Student List Start -->
                      
                    </div>
        
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-12 align-content-center">
                    <button type="button" class="btn btn-outline-primary btn-sm btn-round" id="btnAddAdminStudentModalLoadMore" >Load More</button>
                  </div>
                </div>

              </div>
              <div class="modal-footer">
                <!-- <button type="button" class="btn btn-success" data-dismiss="modal" id="" >Add New Teacher</button> -->
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <!-- <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnAddStudentModalUpdate" >Add</button> -->
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Edit Student Modal  -->
      <div class="row">
        <div class="modal fade" id="editStudentModal" tabindex="-1" role="dialog" aria-labelledby="editStudentModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="editStudentLabel">View Student</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnEditStudentModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="editStudentModalBody">
                <div id="editStudentId" value=""></div>
                <div id="editStudentEnrollmentStatus" value=""></div>
                <div class="row">
                  <div class="col-md-4">
                    <div class="form-group" >
                      <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Student Name</span> 
                      <input id="stuName" type="text" class="form-control" readonly>                
                    </div>
                  </div>

                  <div class="col-md-4">
                    <div class="form-group" >
                      <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Student Phone</span> 
                      <input id="stuPhone" type="text" class="form-control" readonly>                
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="form-group" >
                      <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Student Email</span> 
                      <input id="stuEmail" type="text" class="form-control" readonly>                
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-4">
                    <div class="form-group" >
                      <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Student Gender</span> 
                      <div class="form-check form-check-radio">
                        <label class="form-check-label">
                          <input class="form-check-input" type="radio" name="stuGenderRadio" id="stuGenderMale" value="option1" disabled>
                            Male
                          <span class="circle">
                            <span class="check"></span>
                          </span>
                        </label>
                      </div>
                      <div class="form-check form-check-radio">
                        <label class="form-check-label">
                          <input class="form-check-input" type="radio" name="stuGenderRadio" id="stuGenderFemale" value="option2" disabled>
                            Female
                          <span class="circle">
                            <span class="check"></span>
                          </span>
                        </label>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-4">
                    <div class="form-group" >
                      <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Guardian Name</span> 
                      <input id="gurName" type="text" class="form-control" readonly>                
                    </div>
                  </div>

                  <div class="col-md-4">
                    <div class="form-group" >
                      <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Guardian Phone</span> 
                      <input id="gurPhone" type="text" class="form-control" readonly>                
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="form-group" >
                      <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Guardian Email</span> 
                      <input id="gurEmail" type="text" class="form-control" readonly>                
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-12">
                    <div class="form-group" >
                      <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Address</span> 
                      <textarea class="form-control" id="gurAddr" rows="2" readonly></textarea>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-12">
                    <div class="form-group" >
                      <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Feedback / Comment</span> 
                      <textarea class="form-control" id="stuFeedback" rows="4"></textarea>
                    </div>
                  </div>
                </div>


              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnEditStudentModalClose2">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnEditStudentModalUpdate">Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Delete Student modal -->
      <div class="row">
        <div class="modal fade" id="delStudentModal" tabindex="-1" role="dialog" aria-labelledby="delStudentModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="delStudentLabel">Removing This Student</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnDelStudentModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="delStudentModalBody">
                <div id="deleteStudentClassId" value=""></div>
                <div id="deleteStudentName" value=""></div>
                <div id="deleteStudentId" value=""></div>
                <div id="deleteGuardianId" value=""></div>
                Are you sure you want to continue?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnDelStudentModalClose2">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnDelStudentModalUpdate">Delete</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- List Admins's Teacher modal -->
      <div class="row">
        <div class="modal fade" id="myTeacherModal" tabindex="-1" role="dialog" aria-labelledby="myTeacherModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered modal-lg" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="myTeacherModalLabel">My Teachers</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnMyTeacherModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="myTeacherModalBody">
                <div class="row">
                  <div class="col-md-12" id="studentTop">
                          
                    <div class="container" id="add-tutor-modal-container">
                      <!-- Tutor header -->
                      <div class="row lesson-header text-center">
                        <div class="col-md-2">
                        </div>
                        <div class="col-md-3">
                          <p>Tutor Name</p>
                        </div>
                        <div class="col-md-3">
                          <p>Phone</p>
                        </div>
                        <div class="col-md-2">
                          <p>Age</p>
                        </div>
                        <div class="col-md-2">
                          <p>Action</p> 
                        </div>
                      </div>

                      <!-- Tutor List Start -->

                      <!-- <div class="row tutor-wrapper text-center">
                        <div class="col-md-2">
                          <div style="height: 50px; width: 50px; display: inline-block; position: relative; overflow: hidden; border-radius: 50%;">
                            <img id="viewTutorImgUrl" style="height: 100%;width: 100%; object-fit: cover;" src="../../assets/img/test.jpg"/>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <p class="tutor-item">Alric Liew</p>
                        </div>
                        <div class="col-md-3">
                          <p class="tutor-item">Phone</p>
                        </div>
                        <div class="col-md-2">
                          <p class="tutor-item">12</p>
                        </div>

                        <div class="col-md-2">
                          <button type="button" class="btn btn-primary btn-sm" data-dismiss="modal" id="btnSelectTutor">Select</button>
                        </div>
                      </div> -->

                    </div>

  
                    <div class="row align-content-center">
                      <button type="button" class="btn btn-success" id="btnAddTeacherModalLoadMore" >Load More</button>
                    </div>
                  </div>
                </div>

              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary"  data-dismiss="modal" id="btnMyTeacherModalClose2">Close</button>
                <!-- <a type="button" class="btn btn-success" data-dismiss="modal" data-toggle="modal" data-target="#addTeacherModal" id="btnAddTeacherModal">Add New Teacher</a> -->
                <!-- <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnMyTeacherModalUpdate">Add</button> -->
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Add Teacher Modal -->
      <div class="row">
        <div class="modal fade" id="addTeacherModal" tabindex="-1" role="dialog" aria-labelledby="addTeacherModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="addTeacherModalLabel">Add Teacher</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <div class="form-group">
                  <label class="bmd-label-floating">Phone*</label>
                  <input class="form-control" id="addTeacherModalEmail" placeholder="" type="tel"></input>
                </div>

                <div class="form-group">
                  <label class="bmd-label-floating">Name*</label>
                  <input class="form-control" id="addTeacherModalName" placeholder=""></input>
                </div>

                <!-- <h5 >Gender</h5> -->
                <!-- <form> -->
                  <div class="form-group">
                    <span class="" style="font-size: smaller; font-weight: 300; color: gray; padding-right: 2rem;">Gender</span> 
                    <div class="form-check form-check-radio form-check-inline">
                      <label class="form-check-label">
                        <input class="form-check-input" type="radio" name="exampleRadios" id="addTeacherModalRadio-male" value="option1" >
                        Male
                        <span class="circle">
                          <span class="check"></span>
                        </span>
                      </label>
                    </div>
                    <div class="form-check form-check-radio form-check-inline">
                      <label class="form-check-label">
                        <input class="form-check-input" type="radio" name="exampleRadios" id="addTeacherModalRadio-female" value="option2">
                        Female
                        <span class="circle">
                          <span class="check"></span>
                        </span>
                      </label>
                    </div>
                  </div>
       
                <!-- </form> -->

                <!-- <h5 >Email</h5> -->
                <div class="form-group">
                  <label class="bmd-label-floating">Email</label>
                  <input class="form-control" id="addTeacherModalEmail" placeholder=""></input>
                </div>
                
                <!-- <h5 >Address</h5> -->
                <div class="form-group">
                  <label class="bmd-label-floating">Address</label>
                  <textarea class="form-control" id="addTeacherModalAddress" rows="4"></textarea>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnAddTeacherModalUpdate" >Add</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Save Data modal -->
      <div class="row">
        <div class="modal fade" id="saveModal" tabindex="-1" role="dialog" aria-labelledby="saveModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="saveLabel">Save</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnSaveModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="saveModalBody">
                Are you sure you want to continue?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnSaveModalClose2">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnSaveModalUpdate">Save</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Activation modal -->
      <div class="row">
        <div class="modal fade" id="activationModal" tabindex="-1" role="dialog" aria-labelledby="activationModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="activationModalLabel">New message</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnActivationModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="activationModalBody">
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnActivationModalClose2">Not Now</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnActivationModalUpdate">Join Us</button>
              </div>
            </div>
          </div>
        </div>
      </div>
			
      <!-- Sign-out modal -->
      <div class="row">
        <div class="modal fade" id="signOutModal" tabindex="-1" role="dialog" aria-labelledby="signOutModalLabel" aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="signOutLabel">Logging Out</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnSignOutModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="signOutModalBody">
                Are you sure you want to continue?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnSignOutModalClose2">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnSignOutModalUpdate">Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="container" style="padding-right: 0; padding-left: 0;">
          <!-- Back button -->
          <div class="row" id="desciption-row" >
            <div class="col-md-12 d-flex flex-row">
              <a href="./" class="btn btn-outline-primary btn-round" id="btnBack"><i class="material-icons" style="color: #2e74b6; margin-right: 0.5em; padding-bottom: 0.2em;">west</i> Back</a>
            <!-- <a href="" class="btn btn-primary btn-round" id="btnSave" data-toggle="modal" data-target="#saveModal"><i class="material-icons" style="color: #ffffff; margin-right: 0.5em; padding-bottom: 0.2em;">save</i> Save</a> -->            

            </div>
          </div>
          
          <div class="container overflow-hidden">
            <div class="row">
              <div class="col-md-12">
                <div class="row" >
                  <div class="col-12 col-lg-12 ml-auto mr-auto mb-4">
                    <div class="d-flex flex-wrap multitabs-form__progress">
                      <button class="multitabs-form__progress-btn js-active" type="button" title="Lessons">Lessons</button>
                      <button class="multitabs-form__progress-btn" type="button" title="General Info">General</button>
                      <button class="multitabs-form__progress-btn" type="button" title="Time Slot">Time Slot</button>
                      <button class="multitabs-form__progress-btn" type="button" title="Students">Students</button>
                      <button class="multitabs-form__progress-btn" type="button" title="Teacher">Teacher</button>
                      <button class="multitabs-form__progress-btn" type="button" title="Fee">Fee</button>
                      <!-- <button class="multitabs-form__progress-btn" type="button" title="Advanced Settings">Advanced <span class='card-class-status-label'>Admin</span></button> -->
                      
                    </div>
                  </div>
                </div>

              <!--multitabs-form-->
              <div class="multitabs-form">
                <!--form panels-->
                <div class="row">
                  <div class="col-12">
                    <form class="multitabs-form__form">
                      <!--Lessons form panel-->        
                      <div class="multitabs-form__panel shadow p-4 rounded bg-white js-active" data-animation="scaleIn">
                        <h4 class="multitabs-form__title">Lessons 
                          <!-- <a class="btn btn-sm btn-outline-primary btn-round" id="btnAddLesson" data-toggle="modal" data-target="#addLessonModal" data-button-text="Add" data-title="Add New Lesson"><i class="material-icons" style="color: #2e74b6; padding-bottom: 0.2em;">add</i></a>  -->
                          <a class="btn btn-sm btn-outline-primary btn-round" onclick="latestLessonDoc=null; removeElementsByClass('row lesson-wrapper'); LoadLessonInfo();"><i class="material-icons" style="color: #2e74b6; padding-bottom: 0.2em;">refresh</i></a>
                        </h4>
                        <div class="multitabs-form__content">

                          <div class="col-md-12" id="lessonTop" style="padding: 0; margin-top: 1rem;">
                            <!-- <div class="container" style="padding: 0rem 0rem 0rem 0rem; ">
                              <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin: auto 1rem 0 auto;">Class Details</span> 
                              <a class="btn btn-sm btn-outline-primary btn-round" id="btnAddLesson" data-toggle="modal" data-target="#addLessonModal" data-button-text="Add" data-title="Add New Lesson"><i class="material-icons" style="color: #2e74b6; padding-bottom: 0.2em;">add</i></a>
                            </div> -->
                            <!-- <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Class Details</span>  -->

                            <div class="container" id="lesson-container">
                              <!-- Lesson header -->
                              <div class="row lesson-header">
                                <div class="col-md-12" >
                                  <div class="row">
                                    <div class="col-md-4">
                                      <div class="row">
                                        <div class="col-4 ">
                                          <p>Date</p> 
                                        </div>
                                        <div class="col-4">
                                          <p>Start Time</p> 
                                        </div>
                                        <div class="col-4">
                                          <p>End Time</p> 
                                        </div>
                                      </div>
                                    </div>
                                    <div class="col-md-4">
                                      <p>Class Notes</p> 
                                    </div>
                                    <div class="col-md-4">
                                      <div class="row" style="padding:0; margin: 0;">
                                        <div class="col-8" style="padding:0; margin: 0;">
                                          <p>Teacher's Feedback</p> 
                                        </div>
                                        <div class="col-4" style="padding-right:0; margin-right: 0;">
                                          <p>Score</p> 
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>

                                <!-- <div class="col-1">
                                  <p>Action</p> 
                                </div> -->
                              </div>

                              <!-- Add new lesson here .... -->
                              <!-- Lesson List Start -->
                              <!-- <div class="row lesson-wrapper">
                                <div class="col-md-11" >
                                  <div class="row">
                                    <div class="col-md-4 lesson-active" data-toggle="modal" data-target="#editLessonModal">
                                      <div class="row">
                                        <div class="col-4" >
                                            <p class="lesson-item">12/6/2022</p>
                                        </div>
                                        <div class="col-4">
                                            <p class="lesson-item">11:12</p>
                                        </div>
                                        <div class="col-4">
                                            <p class="lesson-item">11:12</p>
                                        </div>
                                      </div>
                                    </div>
                                    <div class="col-md-4 lesson-active" data-toggle="modal" data-target="#editLessonModal">
                                        <p class="lesson-item">Announcement Text Here a a a a a a a a Announcement Text Here Announcement Text Here Announcement Text Here Announcement Text Here Announcement Text Here Announcement Text Here Announcement Text Here Announcement Text Here</p>
                                    </div>
                                    <div class="col-md-4 lesson-active" data-toggle="modal" data-target="#editLessonModal">
                                      <div class="row" style="padding:0; margin: 0;">
                                        <div class="col-md-8" style="padding:0;">
                                          <p class="lesson-item">Feedback Text Here a a a a a aa  a a a adsa a adsa as ada as da a sadas asda  </p>
                                        </div>
                                        <div class="col-md-4" style="padding-right:0;">
                                          <span class="d-flex flex-wrap align-content-center" style="margin-top: 1rem;">5<i class="material-icons">star</i></span> 
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
  
                                <div class="col-md-1">
                                  <a href="#" class="btn btn-sm btn-outline-danger btn-round" id="btnRemoveTimeSlot" data-toggle="modal" data-target="#delLessonModal" data-id="lessonId" style="margin-top: 1rem;"><i class="material-icons" style="color: red;">remove</i></a>
                                </div>
                              </div> -->
                            </div>
                          </div>
                          <div class="row">
                            <div class="col-md-12" >
                              <a class="btn btn-sm btn-outline-primary btn-round" id="btnLessonLoadMore">Load More <i class="material-icons" style="color: #2e74b6; padding-bottom: 0.2em;">expand_more</i></a> 
                            </div>
                          </div>

                        </div>
                      </div>
                      <!--General form panel-->
                      <div class="multitabs-form__panel shadow p-4 rounded bg-white" data-animation="scaleIn">
                        <h4 class="multitabs-form__title">General Info</h4>
                        <div class="multitabs-form__content">
                          <div class="col-md-12">
                            <!-- Announcement -->
                            <div class="form-group" style="margin-top: 1.5rem;" >
                              <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Class Announcement</span> 
                              <textarea class="form-control" maxlength="511" rows="3" id="inClassAnnouncement" data-compulsory="false" placeholder="Write something ..." readonly></textarea>
                            </div>

                            <div class="form-group" style="margin-top: 2rem;">
                              <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Class Name</span> 
                              <input type="text" class="form-control" id="inClassName" data-compulsory="true" oninput="this.className = 'form-control'" readonly>
                            </div>
                            
                            <div class="form-group" style="margin-top: 1.5rem;" >
                              <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Class Description</span> 
                              <textarea class="form-control" maxlength="255" rows="3" id="inClassDesc" data-compulsory="false" readonly></textarea>
                            </div>
            
                            <div class="row" style="margin-top: 0.5rem; display: none;" >
                              <div class="col-md-6">
                                  <!-- Education Level -->
                                <div class="form-group">
                                  <span class="" style="font-size: smaller; font-weight: 300; color: gray;">Education Level*</span> 
                                  <select class="form-control" name="tutor_course[]" id="level_drop" data-compulsory="true" oninput="this.className = 'form-control'">
                                    <option value="">Select education level</option>
                                  </select>
                                </div>
                              </div>
                              <div class="col-md-6">
                                <!-- Subjects -->
                                <div class="form-group">
                                  <span class="" style="font-size: smaller; font-weight: 300; color: gray;" >Subject*</span>
                                  <select class="form-control" name="tutor_course[]" id="subject_drop" data-compulsory="true" oninput="this.className = 'form-control'">
                                    <option value="">Select subject</option>
                                  </select>
                                </div>
                              </div>
                            </div>
            
                            <!-- Online Only  -->
                            <div class="form-check" style="margin-top: 1.0rem;">
                              <label class="form-check-label">
                                <input class="form-check-input" type="checkbox" value="" id="onlineonly_check" data-compulsory="false" onclick="return false;">
                                <span class="form-check-sign">
                                  <span class="check"></span>
                                </span>
                                Online Only?
                              </label>
                            </div>
            
                            <div class="form-group" style="margin-top: 2rem;">
                              <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Venue</span> 
                              <textarea class="form-control" maxlength="255" rows="3"  id="inVenue" data-compulsory="false" readonly></textarea>
                            </div>
            
                            <div class="row" style="margin-top: 0.5rem; display: none;">
                              <div class="col-md-6">
                                  <!-- State -->
                                <div class="form-group">
                                  <span class="" style="font-size: smaller; font-weight: 300; color: gray;">State</span> 
                                  <select class="form-control" name="tutor_course[]" id="state_drop" data-compulsory="false">
                                    <option value="">Select state</option>
                      
                                  </select>
                                </div>
                              </div>
                              <div class="col-md-6">
                                <!-- Area -->
                                <div class="form-group">
                                  <span class="" style="font-size: smaller; font-weight: 300; color: gray;" >Area</span>
                                  <select class="form-control" name="tutor_course[]" id="area_drop" data-compulsory="false">
                                    <option value="">Select area</option>
                                  </select>
                                </div>
                              </div>
                            </div>           
  
                          </div>

                        </div>
                      </div>
                      <!--Time Slot form panel-->
                      <div class="multitabs-form__panel shadow p-4 rounded bg-white" data-animation="scaleIn">
                        <h4 class="multitabs-form__title">Timeslot</h4>
                        <div class="multitabs-form__content">
                          <div class="col-md-12" id="timeSlotTop">
                          
                            <div class="container" id="timeSlot-container">
                              <div class="row" style="padding: 0rem 3rem 0rem 0rem; border: solid #2e74b6; border-width: thin; margin-top: 1rem;" id="timeSlot-1">
                                
                                <div class="col-md-4">
                                  <div class="form-group">
                                    <span class="" style="font-size: smaller; font-weight: 300; color: gray;">Day of Week</span> 
                                    <select class="form-control" name="tutor_course[]" id="inDayOfWeek1" data-compulsory="true" oninput="this.className = 'form-control'" style="cursor: not-allowed; pointer-events: none;" readonly>
                                      <option value="">Select Day Of Week</option>
                                      <option value="mon">Monday</option>
                                      <option value="tue">Tuesday</option>
                                      <option value="wed">Wednesday</option>
                                      <option value="thu">Thursday</option>
                                      <option value="fri">Friday</option>
                                      <option value="sat">Saturday</option>
                                      <option value="sun">Sunday</option>
                                    </select>
                                  </div>

                                  <!-- <div class="form-group">
                                    <span class="" style="font-size: smaller; font-weight: 300; color: gray;margin-bottom: 0;">Day of Week*</span> 
                                    <input type="text" class="form-control" id="DayOfWeek1">
                                  </div> -->
                                </div>
                                <div class="col-md-4">
                                  <div class="form-group"  >
                                    <span class="" style="font-size: smaller; font-weight: 300; color: gray;">Start Time*</span> 
                                    <div class="input-group clockpicker" data-placement="bottom" data-align="top" data-autoclose="true" style="margin-top: 0.3rem;">
                                      <input id="inStartTime1" type="text" class="form-control" value="" data-compulsory="true" oninput="this.className = 'form-control'" style="cursor: not-allowed; pointer-events: none;" readonly>
                                      <span class="d-flex align-items-center input-group-addon">
                                        <span class="material-icons">
                                          more_time
                                        </span>
                                      </span>
                                    </div>  
                                  </div>
                                </div>
                                <div class="col-md-4">
                                  <div class="form-group">
                                    <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">End Time*</span> 
                                    <div class="input-group clockpicker" data-placement="bottom" data-align="top" data-autoclose="true" style="margin-top: 0.3rem;">
                                      <input id="inEndTime1" type="text" class="form-control" value="" data-compulsory="true" oninput="this.className = 'form-control'" style="cursor: not-allowed; pointer-events: none;" readonly>
                                      <span class="d-flex align-items-center input-group-addon">
                                        <span class="material-icons">
                                          more_time
                                        </span>
                                      </span>
                                    </div>  
                                  </div>
                                </div>
                                <!-- <div class="col-md-1 d-flex align-items-center">
                                  <a href="#" class="btn btn-sm btn-outline-danger btn-round" id="btnRemoveTimeSlot"><i class="material-icons" style="color: red;">remove</i></a>
                                </div> -->
                              </div>

                            </div>

                            <!-- <div class="col-lg-4 col-md-4 col-sm-4">
                              <a class="btn btn-sm btn-outline-primary btn-round" id="btnAddTimeSlot"><i class="material-icons" style="color: #2e74b6; padding-bottom: 0.2em;">add</i></a>
                            </div> -->
                          </div>

                          <div class="button-row d-flex mt-4">
                            <!-- <button class="btn btn-primary js-btn-prev" type="button" title="Prev">Prev</button> -->
                            <!-- <button class="btn btn-primary ml-auto js-btn-next" type="button" title="Next">Next</button> -->
                          </div>
                        </div>
                      </div>
                      <!--Students form panel-->
                      <div class="multitabs-form__panel shadow p-4 rounded bg-white" data-animation="scaleIn">
                        <h4 class="multitabs-form__title">Students 
                          <!-- <a class="btn btn-sm btn-outline-primary btn-round" id="btnAddStudent" data-toggle="modal" data-target="#addStudentModal" data-button-text="Add" data-title="Add New Student"><i class="material-icons" style="color: #2e74b6; padding-bottom: 0.2em;">add</i></a>  -->
                          <a class="btn btn-sm btn-outline-primary btn-round" onclick="latestStuDoc=null; removeElementsByClass('row student-wrapper'); loadAllStudents();"><i class="material-icons" style="color: #2e74b6; padding-bottom: 0.2em;">refresh</i></a>
                        </h4>
                        <div class="multitabs-form__content">
                          <div class="col-md-12" id="studentTop">
                          
                            <div class="container" id="students-container">
                              <!-- Student header -->
                              <div class="row lesson-header">
                                <div class="col-md-12" >
                                  <div class="row" >
                                    <div class="col-md-4">
                                      <p>Student Name</p>
                                    </div>
                                    <div class="col-3">
                                      <p>Gender</p>
                                    </div>
                                    <!-- <div class="col-md-3">
                                      <p>Guardian Name</p>
                                    </div>
                                    <div class="col-md-2">
                                      <p>Guardian Phone</p>
                                    </div> -->
                                    <div class="col-3">
                                      <p>Status</p>
                                    </div>
                                    <!-- <div class="col-md-2">
                                      <p>Date Joined</p>
                                    </div> -->
                                  </div>
                                </div>
                                <!-- <div class="col-md-1">
                                  <p>Action</p> 
                                </div> -->
                              </div>

                            </div>
                          </div>

                          <div class="row">
                            <div class="col-md-12" >
                              <a class="btn btn-sm btn-outline-primary btn-round" id="btnStudentLoadMore">Load More <i class="material-icons" style="color: #2e74b6; padding-bottom: 0.2em;">expand_more</i></a> 
                            </div>
                          </div>

                        </div>
                      </div>
                      <!--Teacher form panel-->
                      <div class="multitabs-form__panel shadow p-4 rounded bg-white" data-animation="scaleIn">
                        <h4 class="multitabs-form__title">Teacher</h4>
                        <div class="multitabs-form__content">
                          <!-- Teacher 1  -->
                          <div class="row" style="margin-top: 1.0rem;">
                            <div class="col-md-1">
                              <div style="height: 50px; width: 50px; display: inline-block; position: relative; overflow: hidden; border-radius: 50%; margin-top: 1.5rem;">
                                <img id="inTutor1ImgUrl" style="height: 100%;width: 100%; object-fit: cover;" src="../../assets/img/empty-photo.png"/>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="form-group">
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Teacher 1's Name*</span> 
                                <input type="text" class="form-control" style="background-color: #f5f5f5;" disabled  id="inTutor1Name" data-tutor1id="bobo">
                              </div>
                            </div>
                            <div class="col-md-5">
                              <div class="form-group">
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Teacher 1's Phone*</span> 
                                <input type="text" class="form-control" style="background-color: #f5f5f5;" disabled  id="inTutor1Phone">
                              </div>
                            </div>
                            <!-- <div class="col-md-2 d-flex align-items-center">
                              <a class="btn btn-sm btn-outline-primary btn-round" id="btnAddTeacher1" data-toggle="" data-target="#myTeacherModal" data-num='1' href="javascript:;" style="pointer-events:none; background-color: #f5f5f5;"><i class="material-icons" style="color: #2e74b6;">add</i></a>
                            </div> -->
                          </div>
                          <!-- Teacher 2  -->
                          <div class="row" style="margin-top: 1.0rem;">
                            <div class="col-md-1">
                              <div style="height: 50px; width: 50px; display: inline-block; position: relative; overflow: hidden; border-radius: 50%; margin-top: 1.5rem;">
                                <img id="inTutor2ImgUrl" style="height: 100%;width: 100%; object-fit: cover;" src="../../assets/img/empty-photo.png"/>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="form-group">
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Teacher 2's Name</span> 
          
                                <input type="text" class="form-control" style="background-color: #f5f5f5;" disabled id="inTutor2Name" data-tutor2id="bobo2">
                              </div>
                            </div>
                            <div class="col-md-5">
                              <div class="form-group" >
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Teacher 2's Phone</span> 
                                <input type="text" class="form-control" style="background-color: #f5f5f5;" disabled id="inTutor2Phone">
                              </div>
                            </div>
                            <!-- <div class="col-md-2 d-flex align-items-center">
                              <a class="btn btn-sm btn-outline-primary btn-round" id="btnAddTeacher2" data-toggle="" data-target="#myTeacherModal" data-num='2' href="javascript:;" style="pointer-events:none; background-color: #f5f5f5;"><i class="material-icons" style="color: #2e74b6;">add</i></a>
                            </div> -->
                          </div>
                          <div class="button-row d-flex mt-4">
                            <!-- <button class="btn btn-primary js-btn-prev" type="button" title="Prev">Prev</button> -->
                            <!-- <button class="btn btn-primary ml-auto js-btn-next" type="button" title="Next">Next</button> -->
                          </div>
                        </div>
                      </div>
                      <!--Fee form panel-->
                      <div class="multitabs-form__panel shadow p-4 rounded bg-white" data-animation="scaleIn">
                        <h4 class="multitabs-form__title">Fee</h4>
                        <div class="multitabs-form__content">
    
                          <div class="form-group" style="margin-top: 2rem;">
                            <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Fee (RM)</span> 
                            <input type="number" step=".01" pattern="^\d*(\.\d{0,2})?$" class="form-control" id="inFee" data-compulsory="true" oninput="this.className = 'form-control'" readonly>
                          </div>

                          <div style="margin-top: 1.0rem;"></div>
                          <span class="" style="font-size: smaller; font-weight: 300; color: gray; padding-right: 2rem;" >Fee Type</span> 
                          <div class="form-group" >
                            <div class="form-check form-check-radio form-check-inline">
                              <label class="form-check-label">
                                <input class="form-check-input" type="radio" name="exampleRadios" id="feeTypePerMonthRadio" value="option1" data-compulsory="false"  onclick="return false;">
                                Per Month
                                <span class="circle">
                                  <span class="check"></span>
                                </span>
                              </label>
                            </div>
                            <div class="form-check form-check-radio form-check-inline">
                              <label class="form-check-label">
                                <input class="form-check-input" type="radio" name="exampleRadios" id="feeTypePerHourRadio" value="option2" data-compulsory="false" onclick="return false;">
                                Per Hour
                                <span class="circle">
                                  <span class="check"></span>
                                </span>
                              </label>
                            </div>
                          </div>
                          
                          <div class="button-row d-flex mt-4">
                            <!-- <button class="btn btn-primary js-btn-prev" type="button" title="Prev">Prev</button> -->
                            <!-- <button class="btn btn-primary ml-auto js-btn-next" type="button" title="Next">Next</button> -->
                          </div>
                        </div>
                      </div>
                      <!--Advanced form panel-->
                      <div class="multitabs-form__panel shadow p-4 rounded bg-white" data-animation="scaleIn">
                        <h4 class="multitabs-form__title">Advanced Settings</h4>
                        <div class="multitabs-form__content">
                          <!-- Invite Links -->
                          <div class="form-group" style="margin-top: 0rem;">
                            <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Student Registration Link</span> 
                            <div class="input-group">
                              <span class="d-flex align-items-center input-group-addon" style="margin-right: 0.5em; cursor: pointer;" onclick="copyText('inAutoJoinLink')">
                                <span class="material-icons">
                                  content_copy
                                </span>
                              </span>
                              <input type="text" value='' class="form-control" style="background-color: #f5f5f5; pointer-events: none;" id="inAutoJoinLink">
                              <!-- <textarea class="form-control" rows="2" id="inAutoJoinLink" style="margin-right: 0.5em; cursor: pointer;" onclick="copyText('inAutoJoinLink')"></textarea> -->
                            </div>
                          </div>

                          <!-- Status -->
                          <span class="" style="font-size: smaller; font-weight: 300; color: gray; padding-right: 2rem;">Class Status</span> 
                          <div class="form-group">
                            <div class="form-check form-check-radio form-check-inline">
                              <label class="form-check-label">
                                <input class="form-check-input" type="radio" name="classStatus" id="classStatusRadioActive" value="optionActive" data-compulsory="false" checked>
                                Active
                                <span class="circle">
                                  <span class="check"></span>
                                </span>
                              </label>
                            </div>
                            <div class="form-check form-check-radio form-check-inline">
                              <label class="form-check-label">
                                <input class="form-check-input" type="radio" name="classStatus" id="classStatusRadioInactive" value="optionInactive" data-compulsory="false">
                                Inactive
                                <span class="circle">
                                  <span class="check"></span>
                                </span>
                              </label>
                            </div>
                          </div>
        
                          <!-- Type -->
                          <span class="" style="font-size: smaller; font-weight: 300; color: gray; padding-right: 2rem; margin-top: 1.0rem;">Class Type</span> 
                          <div class="form-group" >
                            <div class="form-check form-check-radio form-check-inline">
                              <label class="form-check-label">
                                <input class="form-check-input" type="radio" name="classTypeRadios" id="classTypeRadioPrivate" value="option1" data-compulsory="false" checked>
                                Private
                                <span class="circle">
                                  <span class="check"></span>
                                </span>
                              </label>
                            </div>
                            <div class="form-check form-check-radio form-check-inline">
                              <label class="form-check-label">
                                <input class="form-check-input" type="radio" name="classTypeRadios" id="classTypeRadioPublic" value="option2" data-compulsory="false">
                                Public
                                <span class="circle">
                                  <span class="check"></span>
                                </span>
                              </label>
                            </div>
                          </div>
        
                        
                          <!-- Student Limit -->
                          <div class="form-group" style="margin-top: 0rem;">
                            <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Student Limit</span> 
                            <input type="number" class="form-control" value="20" style="background-color: #f5f5f5;" disabled id="inStudentLimit" data-compulsory="true" oninput="this.className = 'form-control'">
                          </div>
          
                          <!-- Spacer  -->
                          <div style="margin-top: 2rem;"></div>
          
                          <!-- Permission -->
                          <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Special Permissions</span> 
                          <div class="form-check" style="margin-top: 1.0rem;">
                            <label class="form-check-label">
                              <input class="form-check-input" type="checkbox" value="" id="t1AddEditStuEn" checked disabled>
                              <span class="form-check-sign">
                                <span class="check"></span>
                              </span>
                              Teacher 1 Add / Edit Student
                            </label>
                          </div>
                          <div class="form-check" style="margin-top: 1.0rem;">
                            <label class="form-check-label">
                              <input class="form-check-input" type="checkbox" value="" id="t1DelStuEn" checked disabled>
                              <span class="form-check-sign">
                                <span class="check"></span>
                              </span>
                              Teacher 1 Remove Student 
                            </label>
                          </div>
                          <div class="form-check" style="margin-top: 1.0rem;">
                            <label class="form-check-label">
                              <input class="form-check-input" type="checkbox" value="" id="t1AddEditLessonEn"checked disabled>
                              <span class="form-check-sign">
                                <span class="check"></span>
                              </span>
                              Teacher 1 Add / Edit Lesson Details 
                            </label>
                          </div>
                          <div class="form-check" style="margin-top: 1.0rem;">
                            <label class="form-check-label">
                              <input class="form-check-input" type="checkbox" value="" id="t1DelLessonEn"checked disabled>
                              <span class="form-check-sign">
                                <span class="check"></span>
                              </span>
                              Teacher 1 Remove Lesson Details
                            </label>
                          </div>
                          <div class="form-check" style="margin-top: 1.0rem;">
                            <label class="form-check-label">
                              <input class="form-check-input" type="checkbox" value="" id="t2AddEditStuEn" disabled>
                              <span class="form-check-sign">
                                <span class="check"></span>
                              </span>
                              Teacher 2 Add / Edit Student
                            </label>
                          </div>
                          <div class="form-check" style="margin-top: 1.0rem;">
                            <label class="form-check-label">
                              <input class="form-check-input" type="checkbox" value="" id="t2DelStuEn" disabled>
                              <span class="form-check-sign">
                                <span class="check"></span>
                              </span>
                              Teacher 2 Remove Student 
                            </label>
                          </div>
                          <div class="form-check" style="margin-top: 1.0rem;">
                            <label class="form-check-label">
                              <input class="form-check-input" type="checkbox" value="" id="t2AddEditLessonEn" disabled>
                              <span class="form-check-sign">
                                <span class="check"></span>
                              </span>
                              Teacher 2 Add / Edit Lesson Details 
                            </label>
                          </div>
                          <div class="form-check" style="margin-top: 1.0rem;">
                            <label class="form-check-label">
                              <input class="form-check-input" type="checkbox" value="" id="t2DelLessonEn" disabled>
                              <span class="form-check-sign">
                                <span class="check"></span>
                              </span>
                              Teacher 2 Remove Lesson Details
                            </label>
                          </div>
                          <div class="form-check" style="margin-top: 1.0rem;">
                            <label class="form-check-label">
                              <input class="form-check-input" type="checkbox" value="" id="stuAutoJoinEn" disabled>
                              <span class="form-check-sign">
                                <span class="check"></span>
                              </span>
                              Auto Enrolment through Invitation Link
                            </label>
                          </div>

                          <div class="button-row d-flex mt-4">
                            <!-- <button class="btn btn-primary js-btn-prev" type="button" title="Prev">Prev</button> -->
                            <!-- <button class="btn btn-success ml-auto js-btn-send" type="button" title="Send">Create Class</button> -->
                          </div>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
              </div>

              </div>
              <!-- <div class="col-md-1"></div> -->
            </div>

          </div>
        </div>

      <footer class="footer">
        <div class="container-fluid">
          <nav class="float-left">
          <ul>
            <!-- <li>
            <a href="https://golearn.com.my/join-us" target="_blank">
              Visit GoLearn Tutor
            </a>
            </li> -->
          </ul>
          </nav>
          <!-- <div class="copyright float-right">
            &copy;
            <script>
              document.write(new Date().getFullYear())
            </script> 
            , made with <i class="material-icons">favorite</i> by <a href="#" >GoLearn Team</a>
          </div> -->
          <!-- your footer here -->
        </div>
      </footer>
    </div>
	  
  </div>


  <div class="fixed-plugin">
    <div class="dropdown show-dropdown">
      <a href="javascript:;" data-toggle="dropdown">
        <i class="material-icons" style="font-size: 36px; padding: 0.2em; color: white;">apps</i>
      </a>
      <ul class="dropdown-menu">
		    <br>
		    <li class="button-container text-center">
          <p style="margin : 0; font-size: 0.7rem; font-weight: 600; text-transform: uppercase;" >CONTACT US</p>
          <button id="twitter" style="background-color: #128C7E;" class="btn btn-round btn-facebook" onclick="location.href = 'https://api.whatsapp.com/send?phone=601115131661&text=Hello!%20I%27m%20looking%20for%20a%20tutor.';"><i class="fa fa-whatsapp"></i> &middot; Reply in 1 hour</button>
        </li>
        <br>
        <li class="button-container text-center">
          <p style="margin : 0; font-size: 0.7rem; font-weight: 600; text-transform: uppercase;" >I want more subjects.</p>
          <a href="https://golearn.com.my/request-a-tutor/" target="_blank" class="btn btn-primary btn-block">Request A Tutor Now</a>
        </li>
        <li class="button-container text-center">
          <p style="margin : 0; font-size: 0.7rem; font-weight: 600; text-transform: uppercase;" >Check us out now.</p>
          <a href="https://golearn.com.my/" target="_blank" class="btn btn-warning btn-block">
            Visit GoLearn
          </a>
        </li>
        <li class="button-container text-center">
          <p style="margin : 0; font-size: 0.7rem; font-weight: 600; text-transform: uppercase;" >CONTACT US</p>
			    <button id="facebook" class="btn btn-round btn-facebook" onclick="location.href = 'https://www.facebook.com/FindTutorInMalaysia/';"><i class="fa fa-facebook-f"></i> &middot; facebook</button>
          <button id="twitter"  class="btn btn-round btn-twitter" onclick="location.href = 'https://twitter.com/golearnmalaysia';"><i class="fa fa-twitter"></i> &middot; twitter</button>
          <br>
          <br>
        </li>
      </ul>
    </div>
  </div>
  
  <script src="../../assets/js/core/jquery.min.js"></script>
  <script src="../../assets/js/core/popper.min.js"></script>
  <script src="../../assets/js/core/bootstrap-material-design.min.js"></script>
  <script src="../../assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
  <!-- Plugin for the momentJs  -->
  <script src="../../assets/js/plugins/moment.min.js"></script>
  <!--  Plugin for Sweet Alert -->
  <script src="../../assets/js/plugins/sweetalert2.js"></script>
  <!-- Forms Validations Plugin -->
  <script src="../../assets/js/plugins/jquery.validate.min.js"></script>
  <!--  Notifications Plugin    -->
  <script src="../../assets/js/plugins/bootstrap-notify.js"></script>
  <!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="../../assets/js/material-dashboard.js?v=2.1.2" type="text/javascript"></script>
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.min.js" integrity="sha384-lpyLfhYuitXl2zRZ5Bn2fqnhNAKOAaM/0Kr9laMspuaMiZfGmfwRNFh8HlMy49eQ"     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8" crossorigin="anonymous"></script>
  <!-- Common constants -->
  <script src="../../assets/js/common.js" type="text/javascript"></script>
  <!-- General Info -->
  <script src="../../assets/js/const.js" type="text/javascript"></script>
  <!-- Core Tutor Js -->
  <script src="../../assets/js/tutor-core.js" type="text/javascript"></script>
  <!-- Datepicker -->
  <script src="../../assets/js/mc-calendar.min.js" type="text/javascript"></script>
  <!-- ClockPicker -->
  <script type="text/javascript" src="../../assets/js/bootstrap-clockpicker.min.js"></script>
  <script src="../../assets/js/star-rating.js" type="text/javascript"></script>
  <script src="../../assets/js/star-rating-theme.js" type="text/javascript"></script>


  <script>
    // Global Variables
    var userId;
    var current_name, current_email, current_phone, current_imgUri, current_nric,
      current_address1, current_address2, current_addressPostCode, current_addressState, current_address;

    var latestLessonDoc = null;// Store last document - Used for Lesson Load More btn
    var latestStuDoc = null;// Store last document - Used for Student Load More btn
    var latestAdminStuDoc = null;// Store last document - Used for Admin's Student Load More btn in Add Student Modal
    var latestAdminTutorDoc = null;// Store last document - Used for Admin's Tutor Load More btn in Add Teacher Modal
    let tutorBtnNum; // used to differentiate btn Teacher 1 / 2

		var db = firebase.firestore();
		db.settings({ timestampsInSnapshots: true });


    
    // Check the current CLASS in session Storage - Valid only if user come from class.html
    var currentClassObj = null;
    getClassObject()

    function getClassObject(){
      // Check if there are valid class data in session storage.
      if (JSON.parse(sessionStorage.getItem(SESSION_STORAGE_CLIENT_CLASS_CURRENT_DOC_KEY)) == null || 
        JSON.parse(sessionStorage.getItem(SESSION_STORAGE_CLIENT_CLASS_CURRENT_DOC_KEY)).id == null || 
        JSON.parse(sessionStorage.getItem(SESSION_STORAGE_CLIENT_CLASS_CURRENT_DOC_KEY)).id == '' ){
        // Return to class.html if invalid class obj
        func.showNotification('top','center', 'danger', 'error_outline', "Error: No class selected." );
        window.location.href='./';

      }else{
        // Set the fields
        currentClassObj = JSON.parse(sessionStorage.getItem(SESSION_STORAGE_CLIENT_CLASS_CURRENT_DOC_KEY));
        updatePageContent(currentClassObj);
      }
    }
    function updatePageContent(currentClassObj){

      //------ add-class.html specific -------------//
      // Navbar
      document.getElementById("titleClassName").textContent = currentClassObj[CLASS_NAME];

      // Lesson Panel
      document.getElementById("inClassAnnouncement").value = currentClassObj[CLASS_ANNOUNCEMENT];

      // General Panel
      document.getElementById("inClassName").value = currentClassObj[CLASS_NAME];
      document.getElementById("inClassDesc").value = currentClassObj[CLASS_DESC];
      document.getElementById("onlineonly_check").checked = currentClassObj[ONLINE_KEY];
      if (currentClassObj[ONLINE_KEY]){
        document.getElementById("state_drop").disabled=true;
        document.getElementById("area_drop").disabled=true;
        document.getElementById("state_drop").style.backgroundColor = "#f5f5f5" ;
        document.getElementById("area_drop").style.backgroundColor="#f5f5f5" ;
      } else {
        document.getElementById("state_drop").disabled=false;
        document.getElementById("area_drop").disabled=false;
        document.getElementById("state_drop").style.backgroundColor = "#fff" ;
        document.getElementById("area_drop").style.backgroundColor="#fff" ;
      }

      document.getElementById("inVenue").value = currentClassObj[CLASS_VENUE];

      // Time Slot Panel
      //    1st Slot
      let subject_drop = document.getElementById("inDayOfWeek1");
      $('#inDayOfWeek1').find('option[value='+currentClassObj[CLASS_TIMESLOT_DAY_OF_WEEK_ARR][0]+']').attr('selected','selected');
      document.getElementById("inStartTime1").value = currentClassObj[CLASS_TIMESLOT_START_ARR][0];
      document.getElementById("inEndTime1").value = currentClassObj[CLASS_TIMESLOT_END_ARR][0];
      // console.log(CLASS_TIMESLOT_DAY_OF_WEEK_ARR)
      // console.log(CLASS_TIMESLOT_DAY_OF_WEEK_ARR.length)
      if (currentClassObj[CLASS_TIMESLOT_DAY_OF_WEEK_ARR].length > 1){
        for (let i = 1; i<currentClassObj[CLASS_TIMESLOT_DAY_OF_WEEK_ARR].length; i++){
        addTimeSlot(currentClassObj[CLASS_TIMESLOT_DAY_OF_WEEK_ARR][i], currentClassObj[CLASS_TIMESLOT_START_ARR][i], currentClassObj[CLASS_TIMESLOT_END_ARR][i]); 
        }
      }

      // Tutor Panel
      document.getElementById("inTutor1ImgUrl").src = currentClassObj[CLASS_TUTOR_IMG_URL_ARR][0];
      document.getElementById("inTutor1Name").value = currentClassObj[CLASS_TUTOR_NAME_ARR][0];
      document.getElementById("inTutor1Phone").value = currentClassObj[CLASS_TUTOR_PHONE_ARR][0];
      document.getElementById("inTutor1Name").setAttribute("data-tutor1Id", currentClassObj[CLASS_TUTOR_ID_ARR][0]);
      tutor1Id = currentClassObj[CLASS_TUTOR_ID_ARR][0];
      tutor1Name = currentClassObj[CLASS_TUTOR_NAME_ARR][0];
      tutor1Phone = currentClassObj[CLASS_TUTOR_PHONE_ARR][0];

      if (currentClassObj[CLASS_TUTOR_ID_ARR][1] == null || currentClassObj[CLASS_TUTOR_ID_ARR][1] == ''){
        document.getElementById("inTutor2ImgUrl").src = '../../assets/img/empty-photo.png';
        document.getElementById("inTutor2Name").value = '';
        document.getElementById("inTutor2Phone").value = '';
        document.getElementById("inTutor2Name").setAttribute("data-tutor2Id", '');   
      }else{
        document.getElementById("inTutor2ImgUrl").src = currentClassObj[CLASS_TUTOR_IMG_URL_ARR][1];
        document.getElementById("inTutor2Name").value = currentClassObj[CLASS_TUTOR_NAME_ARR][1];
        document.getElementById("inTutor2Phone").value = currentClassObj[CLASS_TUTOR_PHONE_ARR][1];
        document.getElementById("inTutor2Name").setAttribute("data-tutor2Id", currentClassObj[CLASS_TUTOR_ID_ARR][1]);
      }

      // Fee Panel
      document.getElementById("inFee").value = currentClassObj[FEES_KEY];
      document.getElementById("feeTypePerMonthRadio").checked = currentClassObj[FEES_TYPE_KEY] === FEES_TYPE_PER_MONTH_KEY ;
      document.getElementById("feeTypePerHourRadio").checked = currentClassObj[FEES_TYPE_KEY] === FEES_TYPE_PER_HOUR_KEY ;

      // Admin Panel
      let uriAdminId = encodeURIComponent(currentClassObj[CLASS_ADMIN_ID]);
      let uriClassId = encodeURIComponent(currentClassObj[CLASS_ID]);
      document.getElementById("inAutoJoinLink").value = 'http://192.168.43.47:8080/app/online-registration.html?aid='+uriAdminId+'&cid='+uriClassId;
      document.getElementById("classStatusRadioActive").checked = currentClassObj[CLASS_STATUS] === CLASS_STATUS_ACTIVE ;
      document.getElementById("classStatusRadioInactive").checked = currentClassObj[CLASS_STATUS] === CLASS_STATUS_INACTIVE ;
      document.getElementById("classTypeRadioPrivate").checked = currentClassObj[CLASS_TYPE] === CLASS_TYPE_PRIVATE ;
      document.getElementById("classTypeRadioPublic").checked = currentClassObj[CLASS_TYPE] === CLASS_TYPE_PUBLIC;
      document.getElementById("t1AddEditStuEn").checked = currentClassObj[CLASS_TUTOR1_ADD_EDIT_STUDENT_ENABLE];
      document.getElementById("t1DelStuEn").checked = currentClassObj[CLASS_TUTOR1_REMOVE_STUDENT_ENABLE];
      document.getElementById("t1AddEditLessonEn").checked = currentClassObj[CLASS_TUTOR1_ADD_EDIT_LESSON_ENABLE];
      document.getElementById("t1DelLessonEn").checked = currentClassObj[CLASS_TUTOR1_REMOVE_LESSON_ENABLE];
      document.getElementById("t2AddEditStuEn").checked = currentClassObj[CLASS_TUTOR2_ADD_EDIT_STUDENT_ENABLE];
      document.getElementById("t2DelStuEn").checked = currentClassObj[CLASS_TUTOR2_REMOVE_STUDENT_ENABLE];
      document.getElementById("t2AddEditLessonEn").checked = currentClassObj[CLASS_TUTOR2_ADD_EDIT_LESSON_ENABLE];
      document.getElementById("t2DelLessonEn").checked = currentClassObj[CLASS_TUTOR2_REMOVE_LESSON_ENABLE];
      document.getElementById("stuAutoJoinEn").checked = currentClassObj[CLASS_STUDENT_AUTO_JOIN_ENABLE];

    }

    //---------- Load all lessons details ----------//
    LoadLessonInfo();
    // Lesson Load More Button - Init
    const lessonLoadmore = document.querySelector('#btnLessonLoadMore');
    lessonLoadmore.style.visibility='hidden';
    const lessonLoadMoreHandleClick = () =>{
      LoadLessonInfo();
    }
    lessonLoadmore.addEventListener('click', lessonLoadMoreHandleClick );

    //---------- Load all students details ----------//
    loadAllStudents();
    // Lesson Load More Button - Init
    const stuLoadmore = document.querySelector('#btnStudentLoadMore');
    stuLoadmore.style.visibility='hidden';
    const stuLoadMoreHandleClick = () =>{
      loadAllStudents();
    }
    stuLoadmore.addEventListener('click', stuLoadMoreHandleClick );

		firebase.auth().onAuthStateChanged(function(user){
      
			if(!user){
        // Return to login if user does not exist.
				window.location.href = "login.html"
			}else{
        // if the displayName is null, it means user register using Phone
        if (firebase.auth().currentUser.displayName == null ){
            userId = firebase.auth().currentUser.phoneNumber;
        }else
            userId = firebase.auth().currentUser.email.replace("[^a-zA-Z0-9]", "_").toLowerCase();

        loadUserInfo(userId);

			}
		});


    //---------- Init All Admin's Student details ----------//
    // Lesson Load More Button - Init
    const stuAdminLoadmore = document.querySelector('#btnAddAdminStudentModalLoadMore');
    stuAdminLoadmore.style.visibility='hidden';

    const stuAdminLoadMoreHandleClick = () =>{
      loadAllAdminStudents();
    }
    stuAdminLoadmore.addEventListener('click', stuAdminLoadMoreHandleClick );

    //---------- Init All Admin's Teacher details ----------//
    // Lesson Load More Button - Init
    const tutorAdminLoadmore = document.querySelector('#btnAddTeacherModalLoadMore');
    tutorAdminLoadmore.style.visibility='hidden';

    const tutorAdminLoadMoreHandleClick = () =>{
      loadAllAdminTeachers(tutorBtnNum)
    }
    tutorAdminLoadmore.addEventListener('click', tutorAdminLoadMoreHandleClick );

    // // Tutor Specific
    // function loadUserInfo(userId){
    //   // Tutor Id must be a phone with +60, no spacing or other chars
    //   var docRef = db.collection("User").doc(userId);

    //   // docRef.get().then((doc) => {
    //   docRef.onSnapshot((doc) => {

    //     if (doc.exists) {
    //       // console.log("Document data:", doc.data());

    //       current_name = (doc.data().name == null || doc.data().name == "")? "New Tutor" : doc.data().name;
    //       // current_email, 
    //       current_phone = doc.data().phone;
    //       current_age = (doc.data().age == null || doc.data().age == "")? "18" : doc.data().age; 
    //       current_gender= (doc.data().gender == 0)? "Male" : "Female"; 
    //       current_imgUri = (doc.data().imgUrl == null || doc.data().imgUrl == "")? "../assets/img/hello.gif" : doc.data().imgUrl;
    //       current_accountStatus = doc.data().accountStatus; 
    //       currentYearsExperience = doc.data().yearsExperience; // number
    //       currentTutoringExperience = doc.data().tutoringExperience;
    //       currentTutoringApproach = doc.data().tutoringApproach;
    //       currentQualification= doc.data().qualification;
         
    //       // Store data to sessionStorage
    //       var tutorDataObj = {
    //         [NAME_KEY] : doc.data().name,
    //         [EMAIL_KEY] : doc.data().email,
    //         [PHONE_KEY] : doc.data().phone,
    //         [AGE_KEY] : doc.data().age,
    //         [GENDER_KEY] : doc.data().gender,
    //         [ADDRESS_1_KEY] :doc.data().address1,
    //         [ADDRESS_2_KEY] :doc.data().address2,
    //         [ADDRESS_POSTCODE_KEY] :doc.data().addressPostCode,
    //         [ADDRESS_STATE_KEY] :doc.data().addressState,
    //         [IMAGE_KEY] : doc.data().imgUrl,
    //         // [NRIC_KEY] : doc.data().name,
    //         [RATING_KEY] : doc.data().rating,
    //         [RATING_TIMES_KEY] : doc.data().ratingTimes,
    //         [RATING_FINAL_KEY] : doc.data().ratingFinal,
    //         [PROFILE_STATUS_KEY] : doc.data().profileStatus,
    //         // [CHECK_HOMETUTOR_KEY] : doc.data().name,
    //         // [CHECK_PRIVATETUTOR_KEY] : doc.data().name,
    //         // [CHECK_GROUPTUTOR_KEY] : doc.data().name,
    //         // [CHECK_ONLINETUTOR_KEY] : doc.data().name,
    //         [YEARS_EXPERIENCE_KEY] :doc.data().yearsExperience,
    //         [TUTORING_EXPERIENCE_KEY] :doc.data().tutoringExperience,
    //         [TUTORING_APPROACH_KEY] : doc.data().tutoringApproach,
    //         [QUALIFICATION_KEY] : doc.data().qualification,
    //         [PREFERED_AREA_LIST_KEY] : doc.data().preferedAreaList,
    //         [PREFERED_SUBJECT_LIST_KEY] : doc.data().preferedSubjectList,
    //         [AGENT_KEY] : doc.data().agent,
    //         [ACCOUNT_STATUS_KEY] : doc.data().accountStatus,
            
    //         [CHECK_HOME_TUTOR_TO_STUDENT_KEY] : doc.data().modeHomeTutorToStudent,
    //         [CHECK_HOME_STUDENT_TO_TUTOR_KEY] : doc.data().modeHomeStudentToTutor,
    //         [CHECK_GROUP_KEY] : doc.data().modeGroup,
    //         [CHECK_ONLINE_KEY] : doc.data().modeOnline,
    //         [CHECK_ONLINE_GROUP_KEY] : doc.data().modeOnlineGroup,
    //         [CHECK_TEACHING_LANGUAGE_ENGLISH_KEY] : doc.data().lanEng,
    //         [CHECK_TEACHING_LANGUAGE_BM_KEY] : doc.data().lanBm,
    //         [CHECK_TEACHING_LANGUAGE_BC_KEY] : doc.data().lanBc,
    //         [CHECK_TEACHING_LANGUAGE_BT_KEY] : doc.data().lanBt,
    //         [CHECK_TEACHING_LANGUAGE_OTHER_KEY] : doc.data().lanOther,
    //         [TUTOR_TIME_SLOT_MON_8AM_KEY] : doc.data().tMon8am,
    //         [TUTOR_TIME_SLOT_MON_12PM_KEY] : doc.data().tMon12pm,
    //         [TUTOR_TIME_SLOT_MON_3PM_KEY] : doc.data().tMon3pm,
    //         [TUTOR_TIME_SLOT_MON_6PM_KEY] : doc.data().tMon6pm,
    //         [TUTOR_TIME_SLOT_TUE_8AM_KEY] : doc.data().tTue8am,
    //         [TUTOR_TIME_SLOT_TUE_12PM_KEY] : doc.data().tTue12pm,
    //         [TUTOR_TIME_SLOT_TUE_3PM_KEY] : doc.data().tTue3pm,
    //         [TUTOR_TIME_SLOT_TUE_6PM_KEY] : doc.data().tTue6pm,
    //         [TUTOR_TIME_SLOT_WED_8AM_KEY] : doc.data().tWed8am,
    //         [TUTOR_TIME_SLOT_WED_12PM_KEY] : doc.data().tWed12pm,
    //         [TUTOR_TIME_SLOT_WED_3PM_KEY] : doc.data().tWed3pm,
    //         [TUTOR_TIME_SLOT_WED_6PM_KEY] : doc.data().tWed6pm,
    //         [TUTOR_TIME_SLOT_THU_8AM_KEY] : doc.data().tThu8am,
    //         [TUTOR_TIME_SLOT_THU_12PM_KEY] : doc.data().tThu12pm,
    //         [TUTOR_TIME_SLOT_THU_3PM_KEY] : doc.data().tThu3pm,
    //         [TUTOR_TIME_SLOT_THU_6PM_KEY] : doc.data().tThu6pm,
    //         [TUTOR_TIME_SLOT_FRI_8AM_KEY] : doc.data().tFri8am,
    //         [TUTOR_TIME_SLOT_FRI_12PM_KEY] : doc.data().tFri12pm,
    //         [TUTOR_TIME_SLOT_FRI_3PM_KEY] : doc.data().tFri3pm,
    //         [TUTOR_TIME_SLOT_FRI_6PM_KEY] : doc.data().tFri6pm,
    //         [TUTOR_TIME_SLOT_SAT_8AM_KEY] : doc.data().tSat8am,
    //         [TUTOR_TIME_SLOT_SAT_12PM_KEY] : doc.data().tSat12pm,
    //         [TUTOR_TIME_SLOT_SAT_3PM_KEY] : doc.data().tSat3pm,
    //         [TUTOR_TIME_SLOT_SAT_6PM_KEY] : doc.data().tSat6pm,
    //         [TUTOR_TIME_SLOT_SUN_8AM_KEY] : doc.data().tSun8am,
    //         [TUTOR_TIME_SLOT_SUN_12PM_KEY] : doc.data().tSun12pm,
    //         [TUTOR_TIME_SLOT_SUN_3PM_KEY] : doc.data().tSun3pm,
    //         [TUTOR_TIME_SLOT_SUN_6PM_KEY] : doc.data().tSun6pm,
    //         // Create a placeholder for aWebUrl. This param can only initiated by admin
    //         // manually through https://golearn.com.my/admin/admin-portal.html
    //         [ADMIN_WEB_URL_KEY] : doc.data().aWebUrl,
    //         [ADMIN_PREMIUM_SUBJECT_LIMIT_KEY] : doc.data().aPremiumSubjectLimit,
    //         [ADMIN_PREMIUM_CONNECT_LIMIT_KEY] : doc.data().aPremiumConnectLimit,
    //         [ADMIN_TOTAL_SUBJECT_LIMIT_KEY] : doc.data().aTotalSubjectLimit,
    //         [ADMIN_TOTAL_CONNECT_LIMIT_KEY] : doc.data().aTotalConnectLimit,
    //         [ADMIN_PREFFERED_AREA_LIMIT_KEY] : doc.data().aPreferredAreaLimit,
    //         [ADMIN_PREFERRED_SUBJECT_LIMIT_KEY] : doc.data().aPreferredSubjectLimit
    //       }

    //       // Set tutorInfoObj as sessionStorage
    //       sessionStorage.setItem("tutorInfoObj", JSON.stringify(tutorDataObj));

    //       // Set the nav user name and public profile link
    //       document.getElementById("user").textContent = doc.data().name;

    //       if (doc.data().aWebUrl == null || doc.data().aWebUrl == ""){
    //         document.getElementById("navPublicProfile").href = "#"  ;
    //         document.getElementById("navPublicProfile").setAttribute("style", "background: #d6d6d6; pointer-events: none; cursor: default;")  
    //       } else{
    //         document.getElementById("navPublicProfile").href = "https://golearn.com.my/tutor/"+doc.data().aWebUrl;
    //         document.getElementById("navPublicProfile").target = "_blank";
    //       }
          
    //       if (current_accountStatus == DEACTIVATED_ACCOUNT_STATUS_KEY){
    //         document.getElementById("btnActivateAccount").setAttribute("style", "visibility: visible;" );
    //         document.getElementById("btnActivateAccount").textContent = "Activate My Account Now";
    //         document.getElementById("btnActivateAccount").href = "https://golearn.com.my/join-us/";
    //         document.getElementById("btnActivateAccount").target = "_blank";
    //       }else if (current_accountStatus == SUSPENDED_ACCOUNT_STATUS_KEY){
    //         document.getElementById("btnActivateAccount").setAttribute("style", "visibility: visible;" );
    //         document.getElementById("btnActivateAccount").textContent = "Account Suspended. Fix Now";
    //         document.getElementById("btnActivateAccount").href = "https://golearn.com.my/contact-us/";
    //         document.getElementById("btnActivateAccount").target = "_blank";
    //       }else {
    //         let activationNavItem = document.querySelector('#activationNavItem');
    //         let activationNavItemIsExist = document.querySelector('#activationNavItem') !== null;
    //         // Remove NavItem if exist
    //         if (activationNavItemIsExist){
    //           activationNavItem.parentNode.removeChild(activationNavItem);
    //         }else{
    //           // Do nothing
    //         }
    //       }

    //     } else {
    //         // Do nothing
    //     }
    //   });

    // };

    // User Specific
    function loadUserInfo(userId){
      // Tutor Id must be a phone with +60, no spacing or other chars
      var docRef = db.collection("Users").doc(userId);
      
      // docRef.get().then((doc) => {
      docRef.onSnapshot((doc) => {
        if (doc.exists) {
          // console.log("Document data:", doc.data());
          current_name = (doc.data().name == null || doc.data().name == "")? "New User" : doc.data().name;
          current_email = (doc.data().email == null || doc.data().email == "")? "" : doc.data().email;
          current_phone = (doc.data().phone == null || doc.data().phone == "")? "" : doc.data().phone; 
          current_imgUri = (doc.data().imgUrl == null || doc.data().imgUrl == "")? "../assets/img/empty-photo.png" : doc.data().imgUrl;
          current_address1= (doc.data().address1 == null || doc.data().address1 == "")? '' : doc.data().address1 + ', ';
          current_address2= (doc.data().address2 == null || doc.data().address2 == "")? '' : doc.data().address2 + ', '; 
          current_addressPostCode= (doc.data().addressPostCode == null || doc.data().addressPostCode == "")? '' : doc.data().addressPostCode + ', ';
          current_addressState= (doc.data().addressState == null || doc.data().addressState == "")? '' : doc.data().addressState;
          current_address = current_address1 + current_address2 + current_addressPostCode + current_addressState;

          // Store data to sessionStorage
          // var tutorDataObj = {
          //   [NAME_KEY] : doc.data().name,
          //   [EMAIL_KEY] : doc.data().email,
          //   [PHONE_KEY] : doc.data().phone,
          //   [ADDRESS_1_KEY] :doc.data().address1,
          //   [ADDRESS_2_KEY] :doc.data().address2,
          //   [ADDRESS_POSTCODE_KEY] :doc.data().addressPostCode,
          //   [ADDRESS_STATE_KEY] :doc.data().addressState,
          //   [IMAGE_KEY] : doc.data().imgUrl,
          //   [PROFILE_STATUS_KEY] : doc.data().profileStatus,
          // }

          // Set tutorInfoObj as sessionStorage
          // sessionStorage.setItem("tutorInfoObj", JSON.stringify(tutorDataObj));

          // Set the nav user name and public profile link
          document.getElementById("user").textContent = doc.data().name;
        } 
        else {
          console.log("No user! Redirecting to login");
          window.location = "login.html"
          
        }
      });
    };


    // Sign out
    function signOutFunction(){
      $('#signOutModal').modal('show');
      $("#signOutModal").appendTo("body");
    }
  
    // Update Class
    function UpdateClass(classId){
      var docRef = db.collection("Class")
          .doc("v1")
          .collection("Class")
          .doc(classId);

        // var button = $(event.relatedTarget) // Button that triggered the modal
        // KEY = button.data('key') // Extract info from data-* attributes
        // DATETIME = button.data('datetime') // Extract info from data-* attributes

        // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
        // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
      let idInput1 = $('#inTutor1Name')
      let tutor1_id = idInput1.data("tutor1id");
      let idInput2 = $('#inTutor2Name')
      let tutor2_id = idInput2.data('tutor2id')

        // Notice that I use .add(..), instead of .set(..). This is because the docRef do not specify the docId.
      var docRefWithMerge = docRef.set({
      // var docRefWithMerge = {
        [CLASS_ID]: docRef.id,
        [CLASS_NAME]: document.getElementById("inClassName").value,
        [CLASS_DESC]: document.getElementById("inClassDesc").value,
        // [CATEGORY_KEY]: category,
        // [CATEGORY_ID_KEY]: categoryId,
        // [SUBJECT_KEY]: subject,
        // [SUBJECT_ID_KEY]: subjectId,
        [ONLINE_KEY]: document.getElementById("onlineonly_check").checked,
        [CLASS_STUDENT_LIMIT]: document.getElementById("inStudentLimit").value,
        [CLASS_ANNOUNCEMENT]: document.getElementById("inClassAnnouncement").value,
        [CLASS_URL]: "UNUSED",
        [CLASS_TYPE]: (document.getElementById("classTypeRadioPrivate").checked)? CLASS_TYPE_PRIVATE : CLASS_TYPE_PUBLIC,
        [CLASS_STATUS]: (document.getElementById("classStatusRadioActive").checked)? CLASS_STATUS_ACTIVE : CLASS_STATUS_INACTIVE,
        [CLASS_VENUE]: document.getElementById("inVenue").value,
        // [STATE_KEY]: gStateName,
        // [STATE_ID_KEY]: gState,
        // [AREA_KEY]: gAreaName,
        // [AREA_ID_KEY]: gArea,

        // Time slot
        [CLASS_TIMESLOT_DAY_OF_WEEK_ARR]: dayOfWeekArr,
        [CLASS_TIMESLOT_START_ARR]: startTimeArr,
        [CLASS_TIMESLOT_END_ARR]: endTimeArr,
        // IDs
        [CLASS_ADMIN_ID]: userId,
        [CLASS_TUTOR_ID_ARR]: [tutor1_id, tutor2_id],
        [CLASS_TUTOR_NAME_ARR]: [document.getElementById("inTutor1Name").value, document.getElementById("inTutor2Name").value],
        [CLASS_TUTOR_PHONE_ARR]: [document.getElementById("inTutor1Phone").value, document.getElementById("inTutor2Phone").value],
        [CLASS_STUDENT_ID_ARR]: [],
        [CLASS_VIEWER_ID_ARR]:[],
        // Fee type
        [FEES_KEY]: parseFloat(document.getElementById("inFee").value),
        [FEES_PER_MONTH_KEY]: (document.getElementById("feeTypePerMonthRadio").checked)? parseFloat(document.getElementById("inFee").value) : parseFloat(document.getElementById("inFee").value * 2 * 4),
        [FEES_TYPE_KEY]: (document.getElementById("feeTypePerMonthRadio").checked)? FEES_TYPE_PER_MONTH_KEY : FEES_TYPE_PER_HOUR_KEY,
        // Special Permission
        [CLASS_TUTOR1_ADD_EDIT_STUDENT_ENABLE]: (document.getElementById("t1AddEditStuEn").checked)? true : false,
        [CLASS_TUTOR1_REMOVE_STUDENT_ENABLE]: (document.getElementById("t1DelStuEn").checked)? true : false,
        [CLASS_TUTOR1_ADD_EDIT_LESSON_ENABLE]: (document.getElementById("t1AddEditLessonEn").checked)? true : false,
        [CLASS_TUTOR1_REMOVE_LESSON_ENABLE]: (document.getElementById("t1DelLessonEn").checked)? true : false,
        [CLASS_TUTOR2_ADD_EDIT_STUDENT_ENABLE]: (document.getElementById("t2AddEditStuEn").checked)? true : false,
        [CLASS_TUTOR2_REMOVE_STUDENT_ENABLE]: (document.getElementById("t2DelStuEn").checked)? true : false,
        [CLASS_TUTOR2_ADD_EDIT_LESSON_ENABLE]: (document.getElementById("t2AddEditLessonEn").checked)? true : false,
        [CLASS_TUTOR2_REMOVE_LESSON_ENABLE]: (document.getElementById("t2DelLessonEn").checked)? true : false,
        [CLASS_STUDENT_AUTO_JOIN_ENABLE]: (document.getElementById("stuAutoJoinEn").checked)? true : false,

        // [DATE_CREATED_KEY]: new Date(),
        // [DATE_CLOSED_KEY]: "",
        [STATUS_KEY]: true,

      }
      , { merge: true })
      .then(() => {
        window.location.href='./class.html'
      });

      // console.log("Saving...")
      // console.log(docRefWithMerge)
    }

    // Add Time Slot
    function addTimeSlot(dayOfWeekVal, startTime, endTime){
      var x = document.getElementById("timeSlot-container").childElementCount;

      let dayOfWeek_form_label = document.createElement('span');
      dayOfWeek_form_label.className = "";
      dayOfWeek_form_label.textContent = "Day of Week";
      dayOfWeek_form_label.setAttribute("style", "font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;");

      // let blogsHtml_dayOfWeek = '';
      // blogsHtml_dayOfWeek += "<option value=''>Select Day Of Week</option><option value='mon'>Monday</option><option value='tue'>Tuesday</option><option value='wed'>Wednesday</option><option value='thu'>Thursday</option><option value='fri'>Friday</option><option value='sat'>Saturday</option><option value='sun'>Sunday</option>";
      let dayOfWeek_form_input = document.createElement('select');
      // dayOfWeek_form_input.innerHTML = blogsHtml_dayOfWeek;
      dayOfWeek_form_input.className = "form-control";
      dayOfWeek_form_input.selected = dayOfWeekVal;
      dayOfWeek_form_input.setAttribute("data-compulsory", "true");
      dayOfWeek_form_input.setAttribute("oninput", "this.className = 'form-control'");
      dayOfWeek_form_input.setAttribute("id", "DayOfWeek" + (x+1));
      dayOfWeek_form_input.setAttribute("style", "cursor: not-allowed; pointer-events: none;");
      dayOfWeek_form_input.setAttribute("readonly", true);
      
      let myDayOfWeekId = MyDayOfWeekId; 
      let myDayOfWeek = MyDayOfWeek; 
      // First items
      let el = document.createElement("option");
      el.textContent = 'Select Day Of Week';
      el.value = '';
      dayOfWeek_form_input.appendChild(el);
      //Create Mon - Sun options
      for (var i = 0; i < myDayOfWeekId.length; i++) {
        let el = document.createElement("option");
        el.textContent = myDayOfWeek[i];
        el.value = myDayOfWeekId[i];
        // Set default selection
        if (dayOfWeekVal === myDayOfWeekId[i]){
          el.selected =  true;
        }

        dayOfWeek_form_input.appendChild(el);
      }

      let dayOfWeek_form_div = document.createElement('div');
      dayOfWeek_form_div.className = "form-group bmd-form-group";
      dayOfWeek_form_div.appendChild(dayOfWeek_form_label)
      dayOfWeek_form_div.appendChild(dayOfWeek_form_input)
      let dayOfWeek_div = document.createElement('div');
      dayOfWeek_div.className = "col-md-4";
      dayOfWeek_div.appendChild(dayOfWeek_form_div)

      // Start Time
      let startTime_form_label = document.createElement('span');
      startTime_form_label.className = "";
      startTime_form_label.textContent = "Start Time";
      startTime_form_label.setAttribute("style", "font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;");

      let startTime_form_input = document.createElement('input');
      startTime_form_input.type = "text";
      startTime_form_input.className = "form-control";
      startTime_form_input.value = startTime;
      startTime_form_input.setAttribute("id", "StartTime" + (x+1));
      startTime_form_input.setAttribute("style", "cursor: not-allowed; pointer-events: none;");
      startTime_form_input.setAttribute("readonly", true);
      startTime_form_input.setAttribute("data-compulsory", "true");
      startTime_form_input.setAttribute("oninput", "this.className = 'form-control'");

      let blogsHtml_startTimeIcon = '';
      blogsHtml_startTimeIcon += "<span class='material-icons'>more_time</span>";
      let startTime_span = document.createElement('span');
      startTime_span.innerHTML = blogsHtml_startTimeIcon;
      startTime_span.className = "d-flex align-items-center input-group-addon"

      let startTime_form_input_div = document.createElement('div');
      startTime_form_input_div.type = "text";
      startTime_form_input_div.className = "input-group clockpicker";
      startTime_form_input_div.setAttribute("data-placement", "bottom");
      startTime_form_input_div.setAttribute("data-align", "top");
      startTime_form_input_div.setAttribute("data-autoclose", "true");
      startTime_form_input_div.setAttribute("style", "margin-top: 0.3rem;");
      startTime_form_input_div.appendChild(startTime_form_input)
      startTime_form_input_div.appendChild(startTime_span)

      let startTime_form_div = document.createElement('div');
      startTime_form_div.className = "form-group bmd-form-group";
      startTime_form_div.appendChild(startTime_form_label)
      startTime_form_div.appendChild(startTime_form_input_div)
      let startTime_div = document.createElement('div');
      startTime_div.className = "col-md-4";
      startTime_div.appendChild(startTime_form_div)

      let endTime_form_label = document.createElement('span');
      endTime_form_label.className = "";
      endTime_form_label.textContent = "End Time";
      endTime_form_label.setAttribute("style", "font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;");

      // <div class="input-group clockpicker" data-placement="right" data-align="top" data-autoclose="true" style="margin-top: 0.3rem;">
      //   <input type="text" class="form-control" value="13:30" id="">
      // </div>

      let endTime_form_input = document.createElement('input');
      endTime_form_input.type = "text";
      endTime_form_input.className = "form-control";
      endTime_form_input.value = endTime;
      endTime_form_input.setAttribute("id", "EndTime" + (x+1));
      endTime_form_input.setAttribute("style", "cursor: not-allowed; pointer-events: none");
      endTime_form_input.setAttribute("readonly", true);
      endTime_form_input.setAttribute("data-compulsory", "true");
      endTime_form_input.setAttribute("oninput", "this.className = 'form-control'");

      let blogsHtml_endTimeIcon = '';
      blogsHtml_endTimeIcon += "<span class='material-icons'>more_time</span>";
      let endTime_span = document.createElement('span');
      endTime_span.innerHTML = blogsHtml_endTimeIcon;
      endTime_span.className = "d-flex align-items-center input-group-addon"

      let endTime_form_input_div = document.createElement('div');
      endTime_form_input_div.type = "text";
      endTime_form_input_div.className = "input-group clockpicker";
      endTime_form_input_div.setAttribute("data-placement", "bottom");
      endTime_form_input_div.setAttribute("data-align", "top");
      endTime_form_input_div.setAttribute("data-autoclose", "true");
      endTime_form_input_div.setAttribute("style", "margin-top: 0.3rem;");
      endTime_form_input_div.appendChild(endTime_form_input)
      endTime_form_input_div.appendChild(endTime_span)

      let endTime_form_div = document.createElement('div');
      endTime_form_div.className = "form-group bmd-form-group";
      endTime_form_div.appendChild(endTime_form_label)
      endTime_form_div.appendChild(endTime_form_input_div)
      let endTime_div = document.createElement('div');
      endTime_div.className = "col-md-4";
      endTime_div.appendChild(endTime_form_div)
      
      let blogsHtml_btn = '';
      blogsHtml_btn += "<i class='material-icons' style='color: red;'>remove</i>";
      let btnRemove_a = document.createElement('a');
      btnRemove_a.innerHTML = blogsHtml_btn;
      btnRemove_a.className = "btn btn-sm btn-outline-danger btn-round"
      btnRemove_a.setAttribute("id", "btnRemoveTimeSlot" + (x+1))
      btnRemove_a.setAttribute("onclick", "removeTimeSlot("+(x+1)+")")
      let btnRemove_div = document.createElement('div');
      btnRemove_div.className = "col-md-1  d-flex align-items-center";
      btnRemove_div.appendChild(btnRemove_a)

      let timeSlotTop_div = document.createElement('div');
      timeSlotTop_div.setAttribute("id", "timeSlot-"+(x+1));
      timeSlotTop_div.setAttribute("style", "padding: 0rem 3rem 0rem 0rem; border: solid #2e74b6; border-width: thin; margin-top: 1rem;");
      timeSlotTop_div.className = "row"
      timeSlotTop_div.appendChild(dayOfWeek_div)
      timeSlotTop_div.appendChild(startTime_div)
      timeSlotTop_div.appendChild(endTime_div)
      // timeSlotTop_div.appendChild(btnRemove_div)

      const timeSlot_container = document.getElementById("timeSlot-container");
      timeSlot_container.appendChild(timeSlotTop_div);
      
    }
    
    // Get Time Slot Data
    function getAllTimeSlots() {
      dayOfWeekArr = [];
      startTimeArr = [];
      endTimeArr = [];
      // This function deals with validation of the form fields with data-compulsory = 'true'
      var x, y, i, valid = true;
      x = document.getElementById("timeSlotTop");
      console.log(x)
      // y = x[activePanelNum].getElementsByTagName("input") && x[activePanelNum].querySelectorAll('[type="text"]');
      y =x.querySelectorAll('[data-compulsory="true"]');

      // A loop that checks every input field in the current tab:
      for (i = 0; i < y.length; i++) {

        if (i % 3 === 0){
          dayOfWeekArr.push(y[i].value)
        }
        if (i % 3 === 1){
          startTimeArr.push(y[i].value)
        }
        if (i % 3 === 2){
          endTimeArr.push(y[i].value)
        }
   
        
        // If a field is empty...
        if (y[i].value == "") {
          // add an "invalid" class to the field:
          // y[i].className += " invalid";
          // and set the current valid status to false:
          valid = false;
        }
      }

      // console.log(dayOfWeekArr)
      // console.log(startTimeArr)
      // console.log(endTimeArr)
      return valid; // return the valid status
    }


    // Remove Time Slot
    function removeTimeSlot(id){
      $( "#timeSlot-"+id ).remove();
    }
  
    // Add a new lesson item
    function addLesson(type='NEW', doc, lessonId){
      // Type:
      // 'NEW' - Add a new lesson
      // 'LOAD' - Load data from doc. 

      let date_item_p = document.createElement('p');
      date_item_p.className = "lesson-item";
      if (type == 'NEW'){
        date_item_p.textContent = document.getElementById("datepicker").value;
      }else if (type == 'LOAD'){
        date_item_p.textContent = doc.data().lesDate.toDate().toLocaleDateString("en-GB");
      }
      let date_item_div = document.createElement('div');
      date_item_div.className = "col-4";
      date_item_div.appendChild(date_item_p);

      let start_item_p = document.createElement('p');
      start_item_p.className = "lesson-item";
      if (type == 'NEW'){
        start_item_p.textContent = document.getElementById("addLessonStart").value
      }else if (type == 'LOAD'){
        start_item_p.textContent = doc.data().lesStart;
      }
      let start_item_div = document.createElement('div');
      start_item_div.className = "col-4";
      start_item_div.appendChild(start_item_p);
      let end_item_p = document.createElement('p');
      end_item_p.className = "lesson-item";
      if (type == 'NEW'){
        end_item_p.textContent = document.getElementById("addLessonEnd").value
      }else if (type == 'LOAD'){
        end_item_p.textContent = doc.data().lesEnd;
      }
      let end_item_div = document.createElement('div');
      end_item_div.className = "col-4";
      end_item_div.appendChild(end_item_p);

      let time_div = document.createElement('div');
      time_div.className = "row"
      time_div.appendChild(date_item_div);
      time_div.appendChild(start_item_div);
      time_div.appendChild(end_item_div);

      let time_top_div = document.createElement('div');
      time_top_div.className = "col-md-4 lesson-active"
      // time_top_div.setAttribute('data-toggle', 'modal');
      // time_top_div.setAttribute('data-target', '#editLessonModal');
      time_top_div.appendChild(time_div);

      let desc_p = document.createElement('p');
      desc_p.className = "lesson-item";
      if (type == 'NEW'){
        desc_p.textContent =  document.getElementById("addLessonDesc").value
      }else if (type == 'LOAD'){
        desc_p.textContent = doc.data().lesDesc;
      }
      let desc_top_div = document.createElement('div');
      desc_top_div.className = "col-md-4 lesson-active"
      // desc_top_div.setAttribute('data-toggle', 'modal');
      // desc_top_div.setAttribute('data-target', '#editLessonModal');
      desc_top_div.appendChild(desc_p);


      let feedback_item_p = document.createElement('p');
      feedback_item_p.className = "lesson-item";
      if (type == 'NEW'){
        feedback_item_p.textContent = document.getElementById("addLessonFeedback").value;
      }else if (type == 'LOAD'){
        feedback_item_p.textContent = doc.data().lesFeedback;
      }
      let feedback_item_div = document.createElement('div');
      feedback_item_div.className = "col-md-8"; 
      // feedback_item_div.setAttribute('style', 'padding:0;');
      feedback_item_div.appendChild(feedback_item_p);

      let score_html = ''
      if (type == 'NEW'){
        score_html +=  document.getElementById("addLessonRate").value+"<i class='material-icons'>star</i>";
      }else if (type == 'LOAD'){
        score_html += doc.data().lesRate +"<i class='material-icons'>star</i>";
      }
      let score_span = document.createElement('span');
      score_span.className = "d-flex flex-wrap align-content-center";
      score_span.setAttribute('style', "margin-top: 1rem; margin-bottom: 1rem;");
      score_span.innerHTML= score_html;
      let score_item_div = document.createElement('div');
      score_item_div.className = "col-md-4";
      // score_item_div.setAttribute('style', 'padding-right:0; margin-right: 0;');
      score_item_div.appendChild(score_span);
      let feedback_score_div = document.createElement('div');
      feedback_score_div.className = "row"
      // feedback_score_div.setAttribute('style', 'padding:0; margin: 0;');
      feedback_score_div.appendChild(feedback_item_div);
      feedback_score_div.appendChild(score_item_div);

      let feedback_score_top_div = document.createElement('div');
      feedback_score_top_div.className = "col-md-4 lesson-active"
      // feedback_score_top_div.setAttribute('data-toggle', 'modal');
      // feedback_score_top_div.setAttribute('data-target', '#editLessonModal');
      feedback_score_top_div.appendChild(feedback_score_div);

      let edit_wrapper = document.createElement('div');        
      edit_wrapper.className = "row"
      edit_wrapper.appendChild(time_top_div);
      edit_wrapper.appendChild(desc_top_div);
      edit_wrapper.appendChild(feedback_score_top_div);
      let edit_wrapper_top = document.createElement('div');        
      edit_wrapper_top.className = "col-md-12"
      edit_wrapper_top.setAttribute('data-toggle', 'modal');
      edit_wrapper_top.setAttribute('data-target', '#editLessonModal');
      if (type == 'NEW'){
        edit_wrapper_top.setAttribute('data-id', lessonId);
        edit_wrapper_top.setAttribute('data-date', document.getElementById("datepicker").value);
        edit_wrapper_top.setAttribute('data-start', document.getElementById("addLessonStart").value);
        edit_wrapper_top.setAttribute('data-end', document.getElementById("addLessonEnd").value);
        edit_wrapper_top.setAttribute('data-desc', document.getElementById("addLessonDesc").value);
        edit_wrapper_top.setAttribute('data-feedback', document.getElementById("addLessonFeedback").value);
        edit_wrapper_top.setAttribute('data-rate', document.getElementById("addLessonRate").value);
      }else if (type == 'LOAD'){
        edit_wrapper_top.setAttribute('data-id', doc.data().id);
        edit_wrapper_top.setAttribute('data-date', doc.data().lesDate.toDate().toLocaleDateString("en-GB"));
        edit_wrapper_top.setAttribute('data-start', doc.data().lesStart);
        edit_wrapper_top.setAttribute('data-end', doc.data().lesEnd);
        edit_wrapper_top.setAttribute('data-desc', doc.data().lesDesc);
        edit_wrapper_top.setAttribute('data-feedback', doc.data().lesFeedback);
        edit_wrapper_top.setAttribute('data-rate', doc.data().lesRate);
      }
      
      edit_wrapper_top.appendChild(edit_wrapper);

      // Button
      let btn_html = '';
      btn_html += "<i class='material-icons' style='color: red;''>remove</i>";
      let btn_a = document.createElement('a');
      btn_a.className = "btn btn-sm btn-outline-danger btn-round";
      btn_a.setAttribute('id', "btnRemoveTimeSlot");
      btn_a.setAttribute('href', "#");
      btn_a.setAttribute('style', "margin-top: 1rem;");
      btn_a.setAttribute('data-toggle', 'modal');
      btn_a.setAttribute('data-target', '#delLessonModal');
      btn_a.setAttribute('data-id', doc.data().id);
      btn_a.setAttribute('data-lessondate', doc.data().lesDate.toDate().toLocaleDateString("en-GB"));
      
      btn_a.innerHTML= btn_html;

      let btn_top_div = document.createElement('div');
      btn_top_div.className = "col-md-1"
      // btn_top_div.appendChild(btn_a);

      let wrapper_div = document.createElement('div');
      wrapper_div.className = "row lesson-wrapper";
      // wrapper_div.appendChild(time_top_div);
      // wrapper_div.appendChild(desc_top_div);
      wrapper_div.appendChild(edit_wrapper_top);
      wrapper_div.appendChild(btn_top_div);

      const lesson_container = document.getElementById("lesson-container");
      lesson_container.appendChild(wrapper_div);
      // lesson_container.insertBefore(wrapper_div, lesson_container.children[1])

    }

    // Load Lesson Details
    function LoadLessonInfo(){
      let today = new Date();

      let docRef = db.collection("Class")
          .doc("v1")
          .collection("Lesson")
          .where("classId", "==", currentClassObj[CLASS_ID])
          .where("status", "==", true)
          .orderBy('lesDate', 'desc')
          .startAfter(latestLessonDoc || today)
          .limit(10);

      docRef
      .get()
      .then((querySnapshot) => {
        // console.log('Total Lessons Found: '+querySnapshot.docs.length)
        querySnapshot.forEach((doc) => {
          // console.log(doc.data());
          addLesson(type='LOAD', doc, '');

        });

        latestLessonDoc = querySnapshot.docs[querySnapshot.docs.length - 1];
        // console.log(querySnapshot.docs.length)
        // Handle Lesson Load more btn
        if (querySnapshot.empty){
          lessonLoadmore.removeEventListener('click', lessonLoadMoreHandleClick );
        }
        if (querySnapshot.docs.length == 10){
          lessonLoadmore.style.visibility='visible';
        }else{
          lessonLoadmore.style.visibility='hidden';
        }

 
      }).catch((error) => {
          console.log("Error getting document:", error);
      });

    }


    // Add New Lesson
    function UploadToDBLesson(){
      var docRef = db.collection("Class")
          .doc("v1")
          .collection("Lesson")
          .doc();

      // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
      let myDate = document.getElementById("datepicker").value;
      myDate = myDate.split("/");
      let newDate = new Date( myDate[2], myDate[1] - 1, myDate[0]);
      // console.log(newDate)
      let myTimestamp = firebase.firestore.Timestamp.fromDate(newDate);
      // console.log(myTimestamp)
      let data = {
        [LESSON_ID]: docRef.id,
        [LESSON_CLASS_ID]: currentClassObj[CLASS_ID],
        [LESSON_ADMIN]: tutorId,
        [LESSON_STATUS]: true,
        [LESSON_DATE_ADD]: new Date(),
        [LESSON_DATE_EDIT]: new Date(),
        [LESSON_DATE_DEL]: '',
        [LESSON_DATE]: newDate,
        [LESSON_MONTH_TYPE]: parseInt(""+myDate[2]+myDate[1]),
        [LESSON_START]: document.getElementById("addLessonStart").value,
        [LESSON_END]: document.getElementById("addLessonEnd").value,
        [LESSON_DESC]: document.getElementById("addLessonDesc").value,
        [LESSON_FEEDBACK]: document.getElementById("addLessonFeedback").value,
        [LESSON_RATE]: parseInt(document.getElementById("addLessonRate").value),
        
      }  

      var docRefWithMerge = docRef.set(data , { merge: true })
      .then(() => {
        func.showNotification('top','center', 'success', 'check_circle', "Successfully added new lesson!" );
        
        // Reset the paginnation cursor, remove all lesson-wrapper & reload the lessons
        latestLessonDoc = null;
        removeElementsByClass('row lesson-wrapper');
        LoadLessonInfo();

      }).catch((error) => {
          console.log("Error getting document:", error);
        // return '';
        
      });

    }

    // Update Lesson
    function UploadChangesToDBLesson(){
      let lessonId = document.getElementById("editLessonId").getAttribute('value');

      if(lessonId === null || lessonId ===''){
        alert('Error: Update changes failed. Please try again.')
      }else{
        
        let docRef = db.collection("Class")
          .doc("v1")
          .collection("Lesson")
          .doc(lessonId);

        // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
        let myDate = document.getElementById("editLessonDatepicker").value;
        myDate = myDate.split("/");
        let newDate = new Date( myDate[2], myDate[1] - 1, myDate[0]);
        // console.log(newDate)
        let myTimestamp = firebase.firestore.Timestamp.fromDate(newDate);
        // console.log(myTimestamp)
        let data = {
          // [LESSON_ID]: lessonId,
          // [LESSON_CLASS_ID]: currentClassObj[CLASS_ID],
          [LESSON_ADMIN]: tutorId,
          // [LESSON_STATUS]: true,
          // [LESSON_DATE_ADD]: new Date(),
          [LESSON_DATE_EDIT]: new Date(),
          // [LESSON_DATE_DEL]: '',
          [LESSON_DATE]: newDate,
          [LESSON_MONTH_TYPE]: parseInt(""+myDate[2]+myDate[1]),
          [LESSON_START]: document.getElementById("editLessonStart").value,
          [LESSON_END]: document.getElementById("editLessonEnd").value,
          [LESSON_DESC]: document.getElementById("editLessonDesc").value,
          [LESSON_FEEDBACK]: document.getElementById("editLessonFeedback").value,
          [LESSON_RATE]: parseInt(document.getElementById("editLessonRate").value),
          
        }  

        var docRefWithMerge = docRef.set(data , { merge: true })
        .then(() => {
          func.showNotification('top','center', 'success', 'check_circle', "Successfully updated lesson info!" );

          // Reset the paginnation cursor, remove all lesson-wrapper & reload the lessons
          latestLessonDoc = null;
          removeElementsByClass('row lesson-wrapper');
          LoadLessonInfo();
          
        }).catch((error) => {
          console.log("Error getting document:", error);
        });

      }
    }


    // Update Lesson
    function RemoveLesson(){
      let lessonId = document.getElementById("deleteLessonId").getAttribute('value');

      if(lessonId === null || lessonId ===''){
        alert('Error: Update changes failed. Please try again.')
      }else{
        
        let docRef = db.collection("Class")
          .doc("v1")
          .collection("Lesson")
          .doc(lessonId);

        let data = {
          // [LESSON_ID]: lessonId,
          // [LESSON_CLASS_ID]: currentClassObj[CLASS_ID],
          // [LESSON_ADMIN]: tutorId,
          [LESSON_STATUS]: false,
          // [LESSON_DATE_ADD]: new Date(),
          // [LESSON_DATE_EDIT]: new Date(),
          [LESSON_DATE_DEL]: new Date(),
          // [LESSON_DATE]: newDate,
          // [LESSON_MONTH_TYPE]: parseInt(""+myDate[2]+myDate[1]),
          // [LESSON_START]: document.getElementById("editLessonStart").value,
          // [LESSON_END]: document.getElementById("editLessonEnd").value,
          // [LESSON_DESC]: document.getElementById("editLessonDesc").value,
          // [LESSON_FEEDBACK]: document.getElementById("editLessonFeedback").value,
          // [LESSON_RATE]: parseInt(document.getElementById("editLessonRate").value),
          
        }  

        var docRefWithMerge = docRef.set(data , { merge: true })
        .then(() => {
          func.showNotification('top','center', 'success', 'check_circle', "Lesson has been removed." );
          // Reset the paginnation cursor, remove all lesson-wrapper & reload the lessons
          latestLessonDoc = null;
          removeElementsByClass('row lesson-wrapper');
          LoadLessonInfo();
          
        }).catch((error) => {
          console.log("Error getting document:", error);
        });

      }
    }

    // Load All Students of the class in Class_Student Module. 
    var allClassStuDoc = []; // Hold all students doc in Class_Student Module
    function loadAllStudents(){
      allClassStuDoc = []; // Reinit the array
      // Class_Student Module
      let docRef = db.collection("Class")
          .doc("v1")
          .collection("Class_Student")
          .where("classId", "==", currentClassObj[CLASS_ID])
          .where("status", "==", true)
          .orderBy('stuName', 'asc')
          .startAfter(latestStuDoc)
          .limit(10);

      docRef
      .get()
      .then((querySnapshot) => {
        // console.log('Total Students Found: '+querySnapshot.docs.length)
        querySnapshot.forEach((doc) => {
          allClassStuDoc.push(doc.data());
          // console.log(doc.data().stuName);
          renderAllStudents(doc);
        });
 
        latestStuDoc = querySnapshot.docs[querySnapshot.docs.length - 1];
        // console.log("allClassStuDoc")
        // console.log(allClassStuDoc)
        // Handle Lesson Load more btn
        if (querySnapshot.empty){
          stuLoadmore.removeEventListener('click', stuLoadMoreHandleClick );
        }

        if (querySnapshot.docs.length == 10){
          stuLoadmore.style.visibility='visible';
        }else{
          stuLoadmore.style.visibility='hidden';
        }

      }).catch((error) => {
          console.log("Error getting document:", error);
      });


    }

    // Render all students View 
    function renderAllStudents(doc){
 
      let stuName_p = document.createElement('p');
      stuName_p.className = "student-item";
      stuName_p.textContent = doc.data()[CLASS_STUDENT_STU_NAME];
      let stuName_div = document.createElement('div');
      stuName_div.className = "col-md-4";
      stuName_div.appendChild(stuName_p);

      let stuGender_p = document.createElement('p');
      stuGender_p.className = "student-item";
      stuGender_p.textContent = (doc.data()[CLASS_STUDENT_STU_GENDER] === 0) ? 'Male' : 'Female';
      let stuGender_div = document.createElement('div');
      stuGender_div.className = "col-3";
      stuGender_div.appendChild(stuGender_p);

      let gurName_p = document.createElement('p');
      gurName_p.className = "student-item";
      gurName_p.textContent = doc.data()[CLASS_STUDENT_GUR_NAME];
      let gurName_div = document.createElement('div');
      gurName_div.className = "col-md-3";
      gurName_div.appendChild(gurName_p);

      let gurPhone_p = document.createElement('p');
      gurPhone_p.className = "student-item";
      gurPhone_p.textContent = doc.data()[CLASS_STUDENT_GUR_PHONE];
      let gurPhone_div = document.createElement('div');
      gurPhone_div.className = "col-md-2";
      gurPhone_div.appendChild(gurPhone_p);

      let status_p = document.createElement('p');
      if (doc.data()[CLASS_STUDENT_ENROLLMENT_STATUS] === CLASS_STUDENT_ENROLLMENT_STATUS_PENDING){
        status_p.textContent = 'Pending';
        status_p.className = "student-item card-student-status-label pending";
      }else if (doc.data()[CLASS_STUDENT_ENROLLMENT_STATUS] === CLASS_STUDENT_ENROLLMENT_STATUS_ACTIVE){
        status_p.textContent = 'Active';
        status_p.className = "student-item card-student-status-label active";
      }
      let status_div = document.createElement('div');
      status_div.className = "col-3";
      status_div.setAttribute('style','margin-bottom: 0.5rem;')
      status_div.appendChild(status_p);

      let dateJoined_p = document.createElement('p');
      dateJoined_p.className = "student-item";
      dateJoined_p.textContent = doc.data()[CLASS_STUDENT_DATE_ADD].toDate().toLocaleDateString("en-GB");
      let dateJoined_div = document.createElement('div');
      dateJoined_div.className = "col-md-2";
      dateJoined_div.appendChild(dateJoined_p);

      let blogsHtml_btn = '';
      blogsHtml_btn += "<i class='material-icons' style='color: red;''>remove</i>";
      let del_btn = document.createElement('a');
      del_btn.className = "btn btn-sm btn-outline-danger btn-round";
      del_btn.innerHTML = blogsHtml_btn;
      del_btn.setAttribute('type','button')
      del_btn.setAttribute('data-toggle','modal');
      del_btn.setAttribute('data-target','#delStudentModal');
      del_btn.setAttribute('data-id', doc.data()[CLASS_STUDENT_ID]);
      del_btn.setAttribute('data-stuname', doc.data()[CLASS_STUDENT_STU_NAME]);
      del_btn.setAttribute('data-stuid', doc.data()[CLASS_STUDENT_STU_ID]);
      del_btn.setAttribute('data-gurid', doc.data()[CLASS_STUDENT_GUR_ID]);
      del_btn.setAttribute('href','#');
      let del_div = document.createElement('div');
      del_div.className = "col-md-1";
      del_div.appendChild(del_btn);

      // top of student details
      let stuDetail_div = document.createElement('div');
      stuDetail_div.className = 'row';
      stuDetail_div.appendChild(stuName_div);
      stuDetail_div.appendChild(stuGender_div);
      // stuDetail_div.appendChild(gurName_div);
      // stuDetail_div.appendChild(gurPhone_div);
      stuDetail_div.appendChild(status_div);
      // stuDetail_div.appendChild(dateJoined_div);
      let stuDetailTop_div = document.createElement('div');
      stuDetailTop_div.className = 'col-md-12 lesson-active';
      // stuDetailTop_div.setAttribute('data-toggle', 'modal');
      // stuDetailTop_div.setAttribute('data-target', '#editStudentModal');
      stuDetailTop_div.setAttribute('data-id', doc.data()[CLASS_STUDENT_ID]);
      stuDetailTop_div.setAttribute('data-stuname', doc.data()[CLASS_STUDENT_STU_NAME]);
      stuDetailTop_div.setAttribute('data-enrollmentstatus', doc.data()[CLASS_STUDENT_ENROLLMENT_STATUS]);
      stuDetailTop_div.appendChild(stuDetail_div);

      let stuTop_div = document.createElement('div');
      stuTop_div.className = 'row student-wrapper';
      stuTop_div.appendChild(stuDetailTop_div);
      // stuTop_div.appendChild(del_div);

      const students_container = document.getElementById("students-container");
      students_container.appendChild(stuTop_div)

      // students_container.insertBefore(stuTop_div, students_container.children[1])
    }


    // Add the student admin/tutor selected in Add Student Modal to Class_Student module
    function AddNewStudentsToDB(id){
      // id is the docId of a student in Student Module
      let selectedStuModuleDoc = null;

      allStuModuleDoc.forEach((doc) => {
        console.log(doc);
        if (id === doc.id){
          selectedStuModuleDoc = doc;
        }

      });

      var docRef = db.collection("Class")
          .doc("v1")
          .collection("Class_Student")
          .doc();

      let data = {
        [CLASS_STUDENT_ID]: docRef.id,
        [CLASS_STUDENT_CLASS_ID]: currentClassObj[CLASS_ID],
        [CLASS_STUDENT_ADMIN_ID]: currentClassObj[CLASS_ADMIN_ID],
        [CLASS_STUDENT_STATUS]: true,
        [CLASS_STUDENT_DATE_ADD]: new Date(),
        [CLASS_STUDENT_DATE_EDIT]: '',
        [CLASS_STUDENT_DATE_DEL]: '',
        [CLASS_STUDENT_ENROLLMENT_STATUS]: CLASS_STUDENT_ENROLLMENT_STATUS_ACTIVE,
        [CLASS_STUDENT_FEEDBACK]: '',
        // Student Module
        [CLASS_STUDENT_DEPENDENT_ID]: selectedStuModuleDoc.depId,
        [CLASS_STUDENT_STU_ID]: selectedStuModuleDoc[STU_CHILD_ID],
        [CLASS_STUDENT_STU_NAME]: selectedStuModuleDoc.childName,
        [CLASS_STUDENT_STU_PHONE]: selectedStuModuleDoc.childPhone,
        [CLASS_STUDENT_STU_GENDER]: selectedStuModuleDoc.childGender,
        [CLASS_STUDENT_STU_EMAIL]: selectedStuModuleDoc.childEmail,
        [CLASS_STUDENT_GUR_ID]: selectedStuModuleDoc[STU_GUR_ID],
        [CLASS_STUDENT_GUR_NAME]: selectedStuModuleDoc.gurName,
        [CLASS_STUDENT_GUR_PHONE]: selectedStuModuleDoc.gurPhone,
        [CLASS_STUDENT_GUR_EMAIL]: selectedStuModuleDoc.gurEmail,
        [CLASS_STUDENT_GUR_ADDR]: selectedStuModuleDoc.gurAddr,

      }  

      console.log('Class_Student Sub Module Data:')
      console.log(data)
      var docRefWithMerge = docRef.set(data , { merge: true })
      .then(() => {
        func.showNotification('top','center', 'success', 'check_circle', "Successfully added a new student: " + selectedStuModuleDoc.childName );
        // Add studentId and gurId from Student Module to class's viewerId array in Class Module
        addStudentIdToClassDB(selectedStuModuleDoc[STU_GUR_ID], selectedStuModuleDoc[STU_CHILD_ID]);

        
        // window.location.reload(true); 
        // Reset the paginnation cursor, remove all student-wrapper & reload the lessons
        latestStuDoc = null;
        removeElementsByClass('row student-wrapper');
        loadAllStudents();

      }).catch((error) => {
        console.log("Error getting document:", error);
        // return '';
      });

    }

    // Add new studentId & parentID as viewer to Class DB
    function addStudentIdToClassDB(guardianId, childId) {
      
      let docRef = db.collection("Class")
          .doc("v1")
          .collection("Class")
          .doc(currentClassObj[CLASS_ID]);


      // Update the Teacher panel
      let viewerArray = currentClassObj[CLASS_VIEWER_ID_ARR];
      viewerArray.push(guardianId);
      viewerArray.push(childId);
      let stuArray = currentClassObj[CLASS_STUDENT_ID_ARR];
      stuArray.push(childId);

      let data = {
        // [CLASS_ID]: docRef.id,
        // [CLASS_NAME]: document.getElementById("inClassName").value,
        // [CLASS_DESC]: document.getElementById("inClassDesc").value,
        // [CATEGORY_KEY]: category,
        // [CATEGORY_ID_KEY]: categoryId,
        // [SUBJECT_KEY]: subject,
        // [SUBJECT_ID_KEY]: subjectId,
        // [ONLINE_KEY]: document.getElementById("onlineonly_check").checked,
        // [CLASS_STUDENT_LIMIT]: document.getElementById("inStudentLimit").value,
        // [CLASS_ANNOUNCEMENT]: document.getElementById("inClassAnnouncement").value,
        // [CLASS_URL]: "UNUSED",
        // [CLASS_TYPE]: (document.getElementById("classTypeRadioPrivate").checked)? CLASS_TYPE_PRIVATE : CLASS_TYPE_PUBLIC,
        // [CLASS_STATUS]: (document.getElementById("classStatusRadioActive").checked)? CLASS_STATUS_ACTIVE : CLASS_STATUS_INACTIVE,
        // [CLASS_VENUE]: document.getElementById("inVenue").value,
        // [STATE_KEY]: gStateName,
        // [STATE_ID_KEY]: gState,
        // [AREA_KEY]: gAreaName,
        // [AREA_ID_KEY]: gArea,

        // Time slot
        // [CLASS_TIMESLOT_DAY_OF_WEEK_ARR]: dayOfWeekArr,
        // [CLASS_TIMESLOT_START_ARR]: startTimeArr,
        // [CLASS_TIMESLOT_END_ARR]: endTimeArr,
        // IDs
        // [CLASS_ADMIN_ID]: tutorId,
        // [CLASS_TUTOR_ID_ARR]: [tutor1_id, tutor2_id],
        // [CLASS_TUTOR_NAME_ARR]: [tutor1_name, tutor2_name],
        // [CLASS_TUTOR_PHONE_ARR]: [tutor1_phone, tutor2_phone],
        [CLASS_STUDENT_ID_ARR]: stuArray,
        [CLASS_VIEWER_ID_ARR]: viewerArray,
        // Fee type
        // [FEES_KEY]: parseFloat(document.getElementById("inFee").value),
        // [FEES_PER_MONTH_KEY]: (document.getElementById("feeTypePerMonthRadio").checked)? parseFloat(document.getElementById("inFee").value) : parseFloat(document.getElementById("inFee").value * 2 * 4),
        // [FEES_TYPE_KEY]: (document.getElementById("feeTypePerMonthRadio").checked)? FEES_TYPE_PER_MONTH_KEY : FEES_TYPE_PER_HOUR_KEY,
        // Special Permission
        // [CLASS_TUTOR1_ADD_EDIT_STUDENT_ENABLE]: (document.getElementById("t1AddEditStuEn").checked)? true : false,
        // [CLASS_TUTOR1_REMOVE_STUDENT_ENABLE]: (document.getElementById("t1DelStuEn").checked)? true : false,
        // [CLASS_TUTOR1_ADD_EDIT_LESSON_ENABLE]: (document.getElementById("t1AddEditLessonEn").checked)? true : false,
        // [CLASS_TUTOR1_REMOVE_LESSON_ENABLE]: (document.getElementById("t1DelLessonEn").checked)? true : false,
        // [CLASS_TUTOR2_ADD_EDIT_STUDENT_ENABLE]: (document.getElementById("t2AddEditStuEn").checked)? true : false,
        // [CLASS_TUTOR2_REMOVE_STUDENT_ENABLE]: (document.getElementById("t2DelStuEn").checked)? true : false,
        // [CLASS_TUTOR2_ADD_EDIT_LESSON_ENABLE]: (document.getElementById("t2AddEditLessonEn").checked)? true : false,
        // [CLASS_TUTOR2_REMOVE_LESSON_ENABLE]: (document.getElementById("t2DelLessonEn").checked)? true : false,
        // [CLASS_STUDENT_AUTO_JOIN_ENABLE]: (document.getElementById("stuAutoJoinEn").checked)? true : false,

        // [DATE_CREATED_KEY]: new Date(),
        // [DATE_CLOSED_KEY]: "",
        // [STATUS_KEY]: true,
      }
      console.log('StudentID Array Data');
      console.log(data);
      // docRef.set( data, { merge: true })
      // .then(() => {
      //   func.showNotification('top','center', 'success', 'check_circle', "New tutor added.");
      // });

    }

    // Remove a studentId & parentID as viewer from Class DB
    function delStudentIdToClassDB(guardianId, studentId) {
      
      let docRef = db.collection("Class")
          .doc("v1")
          .collection("Class")
          .doc(currentClassObj[CLASS_ID]);


      // Removed the student and gurdian Id
      let viewerArray = currentClassObj[CLASS_VIEWER_ID_ARR];
      viewerArray = viewerArray.filter(e => e !== guardianId);
      viewerArray = viewerArray.filter(e => e !== studentId);

      let stuArray = currentClassObj[CLASS_STUDENT_ID_ARR];
      stuArray = viewerArray.filter(e => e !== studentId);


      let data = {
        // [CLASS_ID]: docRef.id,
        // [CLASS_NAME]: document.getElementById("inClassName").value,
        // [CLASS_DESC]: document.getElementById("inClassDesc").value,
        // [CATEGORY_KEY]: category,
        // [CATEGORY_ID_KEY]: categoryId,
        // [SUBJECT_KEY]: subject,
        // [SUBJECT_ID_KEY]: subjectId,
        // [ONLINE_KEY]: document.getElementById("onlineonly_check").checked,
        // [CLASS_STUDENT_LIMIT]: document.getElementById("inStudentLimit").value,
        // [CLASS_ANNOUNCEMENT]: document.getElementById("inClassAnnouncement").value,
        // [CLASS_URL]: "UNUSED",
        // [CLASS_TYPE]: (document.getElementById("classTypeRadioPrivate").checked)? CLASS_TYPE_PRIVATE : CLASS_TYPE_PUBLIC,
        // [CLASS_STATUS]: (document.getElementById("classStatusRadioActive").checked)? CLASS_STATUS_ACTIVE : CLASS_STATUS_INACTIVE,
        // [CLASS_VENUE]: document.getElementById("inVenue").value,
        // [STATE_KEY]: gStateName,
        // [STATE_ID_KEY]: gState,
        // [AREA_KEY]: gAreaName,
        // [AREA_ID_KEY]: gArea,

        // Time slot
        // [CLASS_TIMESLOT_DAY_OF_WEEK_ARR]: dayOfWeekArr,
        // [CLASS_TIMESLOT_START_ARR]: startTimeArr,
        // [CLASS_TIMESLOT_END_ARR]: endTimeArr,
        // IDs
        // [CLASS_ADMIN_ID]: tutorId,
        // [CLASS_TUTOR_ID_ARR]: [tutor1_id, tutor2_id],
        // [CLASS_TUTOR_NAME_ARR]: [tutor1_name, tutor2_name],
        // [CLASS_TUTOR_PHONE_ARR]: [tutor1_phone, tutor2_phone],
        [CLASS_STUDENT_ID_ARR]: stuArray,
        [CLASS_VIEWER_ID_ARR]: viewerArray,
        // Fee type
        // [FEES_KEY]: parseFloat(document.getElementById("inFee").value),
        // [FEES_PER_MONTH_KEY]: (document.getElementById("feeTypePerMonthRadio").checked)? parseFloat(document.getElementById("inFee").value) : parseFloat(document.getElementById("inFee").value * 2 * 4),
        // [FEES_TYPE_KEY]: (document.getElementById("feeTypePerMonthRadio").checked)? FEES_TYPE_PER_MONTH_KEY : FEES_TYPE_PER_HOUR_KEY,
        // Special Permission
        // [CLASS_TUTOR1_ADD_EDIT_STUDENT_ENABLE]: (document.getElementById("t1AddEditStuEn").checked)? true : false,
        // [CLASS_TUTOR1_REMOVE_STUDENT_ENABLE]: (document.getElementById("t1DelStuEn").checked)? true : false,
        // [CLASS_TUTOR1_ADD_EDIT_LESSON_ENABLE]: (document.getElementById("t1AddEditLessonEn").checked)? true : false,
        // [CLASS_TUTOR1_REMOVE_LESSON_ENABLE]: (document.getElementById("t1DelLessonEn").checked)? true : false,
        // [CLASS_TUTOR2_ADD_EDIT_STUDENT_ENABLE]: (document.getElementById("t2AddEditStuEn").checked)? true : false,
        // [CLASS_TUTOR2_REMOVE_STUDENT_ENABLE]: (document.getElementById("t2DelStuEn").checked)? true : false,
        // [CLASS_TUTOR2_ADD_EDIT_LESSON_ENABLE]: (document.getElementById("t2AddEditLessonEn").checked)? true : false,
        // [CLASS_TUTOR2_REMOVE_LESSON_ENABLE]: (document.getElementById("t2DelLessonEn").checked)? true : false,
        // [CLASS_STUDENT_AUTO_JOIN_ENABLE]: (document.getElementById("stuAutoJoinEn").checked)? true : false,

        // [DATE_CREATED_KEY]: new Date(),
        // [DATE_CLOSED_KEY]: "",
        // [STATUS_KEY]: true,
      }

      // console.log('StudentID Array Data');
      // console.log(data);
      docRef.set( data, { merge: true })
      .then(() => {
        // func.showNotification('top','center', 'success', 'check_circle', "Tutor Removed.");
      });

    }



    // Remove a student from class
    function removeStudent(studentClassId, studentName, studentId, guardianId){
      // studentClassId is the id of student in Student_Class Module
      var docRef = db.collection("Class")
          .doc("v1")
          .collection("Class_Student")
          .doc(studentClassId);

      let data = {
        // [CLASS_STUDENT_ID]: docRef.id,
        // [CLASS_STUDENT_CLASS_ID]: currentClassObj[CLASS_ID],
        // [CLASS_STUDENT_ADMIN_ID]: currentClassObj[CLASS_ADMIN_ID],
        [CLASS_STUDENT_STATUS]: false,
        // [CLASS_STUDENT_DATE_ADD]: new Date(),
        // [CLASS_STUDENT_DATE_EDIT]: '',
        [CLASS_STUDENT_DATE_DEL]: new Date(),
        // [CLASS_STUDENT_ENROLLMENT_STATUS]: CLASS_STUDENT_ENROLLMENT_STATUS_ACTIVE,
        // [CLASS_STUDENT_FEEDBACK]: '',
        // Student Module
        // [CLASS_STUDENT_DEPENDENT_ID]: selectedStuModuleDoc.depId,
        // [CLASS_STUDENT_STU_NAME]: selectedStuModuleDoc.childName,
        // [CLASS_STUDENT_STU_PHONE]: selectedStuModuleDoc.childPhone,
        // [CLASS_STUDENT_STU_GENDER]: selectedStuModuleDoc.childGender,
        // [CLASS_STUDENT_STU_EMAIL]: selectedStuModuleDoc.childEmail,
        // [CLASS_STUDENT_GUR_NAME]: selectedStuModuleDoc.gurName,
        // [CLASS_STUDENT_GUR_PHONE]: selectedStuModuleDoc.gurPhone,
        // [CLASS_STUDENT_GUR_EMAIL]: selectedStuModuleDoc.gurEmail,
        // [CLASS_STUDENT_GUR_ADDR]: selectedStuModuleDoc.gurAddr,

      }  

      // console.log('Delete Student Class_Student Sub Module: '+ studentId)
      // console.log(data)
      
      var docRefWithMerge = docRef.set(data , { merge: true })
      .then(() => {
        func.showNotification('top','center', 'success', 'check_circle', studentName + " has been removed." );
        // Remove studentId and gurId from class's viewerId & studentId array in Class Module
        delStudentIdToClassDB(guardianId, studentId);


        // Reset the paginnation cursor, remove all student-wrapper & reload the lessons
        latestStuDoc = null;
        removeElementsByClass('row student-wrapper');
        loadAllStudents();

      }).catch((error) => {
        console.log("Error getting document:", error);
      });

    }
    
    // Load All Admin's Students that owned by class admin. 
    var allStuModuleDoc = []; // Reset all students doc
    function loadAllAdminStudents(){

      allStuModuleDoc = []; // Init All Students Doc array
      // STUDENT Module
      let docRef = db.collection("Class")
          .doc("v1")
          .collection("Student")
          .where("adminId", "==", currentClassObj[CLASS_ADMIN_ID])
          .where("status", "==", true)
          .orderBy('childName', 'asc')
          .startAfter(latestAdminStuDoc)
          .limit(10);

      docRef
      .get()
      .then((querySnapshot) => {
        querySnapshot.forEach((doc) => {
          
          allStuModuleDoc.push(doc.data());
          // console.log(doc.data());

          let stuClassDepIdModArray = []; // temp arrays for student dep id
          if (doc.data()[STU_DEPENDENT_ID] == ''){
            // OIf the students in Student Module have no depId, render.
            renderAllAdminStudents(doc);
          }
          else{
            // Check if the students in Student Module exist in Class_Student Module. If yes, skip, else render.
            // allClassStuDoc is obtain from the loadAllStudents func.
            allClassStuDoc.forEach((doc) => {
              stuClassDepIdModArray.push(doc[CLASS_STUDENT_DEPENDENT_ID]);
            });

            if (stuClassDepIdModArray.includes(doc.data()[STU_DEPENDENT_ID]) ){
              // Do not render
            }else {
              renderAllAdminStudents(doc);
            }
          }
          
        });
        
        console.log("allStuModuleDoc")
        console.log(allStuModuleDoc)

        latestAdminStuDoc = querySnapshot.docs[querySnapshot.docs.length - 1];
        // console.log(querySnapshot.docs.length)
        // Handle Lesson Load more btn
        if (querySnapshot.empty){
          stuAdminLoadmore.removeEventListener('click', stuAdminLoadMoreHandleClick );
        }

        if (querySnapshot.docs.length == 10){
          stuAdminLoadmore.style.visibility='visible';
        }else{
          stuAdminLoadmore.style.visibility='hidden';
        }
 
      }).catch((error) => {
          console.log("Error getting document:", error);
      });


    }

    // Render all admin's students in Add Student Modal
    function renderAllAdminStudents(doc){
  
      let stuName_p = document.createElement('p');
      stuName_p.className = "student-item";
      stuName_p.textContent = doc.data().childName;
      let stuName_div = document.createElement('div');
      stuName_div.className = "col-md-3";
      stuName_div.appendChild(stuName_p);

      let stuGender_p = document.createElement('p');
      stuGender_p.className = "student-item";
      stuGender_p.textContent = (doc.data().childGender === 0) ? 'Male' : 'Female';
      let stuGender_div = document.createElement('div');
      stuGender_div.className = "col-md-3";
      stuGender_div.appendChild(stuGender_p);

      let gurName_p = document.createElement('p');
      gurName_p.className = "student-item";
      gurName_p.textContent = doc.data().gurName;
      let gurName_div = document.createElement('div');
      gurName_div.className = "col-md-3";
      gurName_div.appendChild(gurName_p);

      let sel_btn = document.createElement('button');
      sel_btn.className = "btn btn-primary btn-sm";
      sel_btn.textContent = 'Select';
      sel_btn.setAttribute('data-dismiss','modal');
      sel_btn.setAttribute('type','button')
      sel_btn.setAttribute('onclick',"AddNewStudentsToDB('"+doc.data().id+"')");
      let sel_div = document.createElement('div');
      sel_div.className = "col-md-3";
      sel_div.appendChild(sel_btn);

      let stuDetail_div = document.createElement('div');
      stuDetail_div.className = 'row student-wrapper';
      stuDetail_div.appendChild(stuName_div);
      stuDetail_div.appendChild(stuGender_div);
      stuDetail_div.appendChild(gurName_div);
      stuDetail_div.appendChild(sel_div);

      const add_student_modal_container = document.getElementById("add-student-modal-container");
      add_student_modal_container.appendChild(stuDetail_div)
      // add_student_modal_container.insertBefore(stuDetail_div, add_student_modal_container.children[1])
    }

    // Edit the student in class and update to Class_Student module
    function updateStudent(studentId, studentFeedback, studenEnrollmentStatus){

      var docRef = db.collection("Class")
          .doc("v1")
          .collection("Class_Student")
          .doc(studentId);
      let data = {};

      // If the enrollment status is still pending, approve the student
      if (STUDENT_ENROLLMENT_STATUS === CLASS_STUDENT_ENROLLMENT_STATUS_PENDING){
        data = {
          [CLASS_STUDENT_ENROLLMENT_STATUS]: CLASS_STUDENT_ENROLLMENT_STATUS_ACTIVE,
          [CLASS_STUDENT_FEEDBACK]: studentFeedback,
        } 
      }else if (STUDENT_ENROLLMENT_STATUS === CLASS_STUDENT_ENROLLMENT_STATUS_ACTIVE){
        data = {
          [CLASS_STUDENT_FEEDBACK]: studentFeedback,
        } 
      }else{
        data = {
          [CLASS_STUDENT_FEEDBACK]: studentFeedback,
        } 
      }

      // console.log('Class_Student UPDATE Data:')
      // console.log(data)
      // console.log(studentId)
      var docRefWithMerge = docRef.set(data , { merge: true })
      .then(() => {
        func.showNotification('top','center', 'success', 'check_circle', "Successfully updated student info!" );
        // Reset the paginnation cursor, remove all student-wrapper & reload the lessons
        latestStuDoc = null;
        removeElementsByClass('row student-wrapper');
        loadAllStudents();
      }).catch((error) => {
          console.log("Error getting document:", error);
      });

    }


    // Load All Teachers that owned by class admin. 
    var allTutorModuleDoc = []; // Reset all Tutors doc
    function loadAllAdminTeachers(tutorBtnNum){

      allTutorModuleDoc = []; // Init All Tutors Doc array
      // STUDENT Module
      let docRef = db.collection("Class")
          .doc("v1")
          .collection("Tutor")
          .where(TUTOR_ADMIN_ID, "==", tutorId)
          .where(TUTOR_STATUS_ADMIN, "==", true)
          .orderBy(TUTOR_TUTOR_NAME, 'asc')
          .startAfter(latestAdminTutorDoc)
          .limit(10);

      docRef
      .get()
      .then((querySnapshot) => {
        querySnapshot.forEach((doc) => {
          console.log(doc.data().id);
          allTutorModuleDoc.push(doc.data());
          renderAllAdminTeachers(doc, tutorBtnNum);
        });

        latestAdminTutorDoc = querySnapshot.docs[querySnapshot.docs.length - 1];
        console.log(querySnapshot.docs.length)
        // Handle Lesson Load more btn
        if (querySnapshot.empty){
          tutorAdminLoadmore.removeEventListener('click', tutorAdminLoadMoreHandleClick );
        }

        if (querySnapshot.docs.length == 10){
          tutorAdminLoadmore.style.visibility='visible';
        }else{
          tutorAdminLoadmore.style.visibility='hidden';
        }

 
      }).catch((error) => {
          console.log("Error getting document:", error);
      });


    }

    // Render all teachers view in Add Teachers Modal
    function renderAllAdminTeachers(doc, tutorBtnNum){
      //  <div class="row tutor-wrapper text-center">
      //   <div class="col-md-2">
      //     <div style="height: 50px; width: 50px; display: inline-block; position: relative; overflow: hidden; border-radius: 50%;">
      //       <img style="height: 100%;width: 100%; object-fit: cover;" src="../../assets/img/test.jpg"/>
      //     </div>
      //   </div>
      //   <div class="col-md-3">
      //     <p class='tutor-item'>Alric Liew</p>
      //   </div>
      //   <div class="col-md-3">
      //     <p class='tutor-item'>Phone</p>
      //   </div>
      //   <div class="col-md-2">
      //     <p class='tutor-item'>12</p>
      //   </div>

      //   <div class="col-md-2">
      //     <button type="button" class="btn btn-primary btn-sm" data-dismiss="modal" id="btnSelectTutor">Select</button>
      //   </div>
      // </div>

      let img = document.createElement('img');
      img.setAttribute('style', 'height: 100%; width: 100%; object-fit: cover;');
      img.src = doc.data()[TUTOR_TUTOR_IMG_URL];
      let img_div = document.createElement('div');
      img_div.setAttribute('style', 'height: 50px; width: 50px; display: inline-block; position: relative; overflow: hidden; border-radius: 50%;');
      img_div.appendChild(img);
      let imgTop_div = document.createElement('div');
      imgTop_div.className = "col-md-2";
      imgTop_div.appendChild(img_div);


      let tutorName_p = document.createElement('p');
      tutorName_p.className = "tutor-item";
      tutorName_p.textContent = doc.data()[TUTOR_TUTOR_NAME];
      let tutorName_div = document.createElement('div');
      tutorName_div.className = "col-md-3";
      tutorName_div.appendChild(tutorName_p);

      let tutorPhone_p = document.createElement('p');
      tutorPhone_p.className = "tutor-item";
      tutorPhone_p.textContent = doc.data()[TUTOR_TUTOR_PHONE];
      let tutorPhone_div = document.createElement('div');
      tutorPhone_div.className = "col-md-3";
      tutorPhone_div.appendChild(tutorPhone_p);

      let tutorAge_p = document.createElement('p');
      tutorAge_p.className = "tutor-item";
      tutorAge_p.textContent = doc.data()[TUTOR_TUTOR_AGE];
      let tutorAge_div = document.createElement('div');
      tutorAge_div.className = "col-md-2";
      tutorAge_div.appendChild(tutorAge_p);

      let sel_btn = document.createElement('button');
      sel_btn.className = "btn btn-primary btn-sm";
      sel_btn.textContent = 'Select';
      sel_btn.setAttribute('data-dismiss','modal');
      sel_btn.setAttribute('type','button')
      sel_btn.setAttribute('onclick',"AddNewTutorToDB("+ tutorBtnNum+", '"+ doc.data()[TUTOR_TUTOR_ID]+"', '"+doc.data()[TUTOR_TUTOR_NAME]+"', '"+doc.data()[TUTOR_TUTOR_PHONE]+"')");
      let sel_div = document.createElement('div');
      sel_div.className = "col-md-2";
      sel_div.appendChild(sel_btn);

      let tutorDetail_div = document.createElement('div');
      tutorDetail_div.className = 'row tutor-wrapper text-center';
      tutorDetail_div.appendChild(imgTop_div);
      tutorDetail_div.appendChild(tutorName_div);
      tutorDetail_div.appendChild(tutorPhone_div);
      tutorDetail_div.appendChild(tutorAge_div);
      tutorDetail_div.appendChild(sel_div);

      const add_tutor_modal_container = document.getElementById("add-tutor-modal-container");
      add_tutor_modal_container.appendChild(tutorDetail_div);

      // add_tutor_modal_container.insertBefore(tutorDetail_div, add_tutor_modal_container.children[1])
    }
    
    // Add Tutor to Class (Subset of Add to Class function)
    function AddNewTutorToDB(tutorNum, tutorId, tutorName, tutorPhone){
      // tutorNum refer to Teacher 1 / 2 since we share the similar modal
      // console.log(tutorNum)
      // console.log(tutorId)
      // console.log(tutorName)
      // console.log(tutorPhone)

      
      let docRef = db.collection("Class")
          .doc("v1")
          .collection("Class")
          .doc(currentClassObj[CLASS_ID]);

      // First, get the original value first
      let idInput1 = $('#inTutor1Name')
      let tutor1_id = idInput1.data("tutor1id");
      let tutor1_name = document.getElementById("inTutor1Name").value
      let tutor1_phone = document.getElementById("inTutor1Phone").value

      let idInput2 = $('#inTutor2Name')
      let tutor2_id = idInput2.data('tutor2id')
      let tutor2_name = document.getElementById("inTutor2Name").value
      let tutor2_phone = document.getElementById("inTutor2Phone").value
      
      // Update the Teacher panel
      if (tutorNum == 1){
        tutor1_id = tutorId;
        tutor1_name = tutorName;
        tutor1_phone = tutorPhone;
        document.getElementById('inTutor1Name').setAttribute("data-tutor1id", tutorId);
        document.getElementById("inTutor1Name").value = tutorName;
        document.getElementById("inTutor1Phone").value = tutorPhone;
      }else if (tutorNum == 2){
        tutor2_id = tutorId;
        tutor2_name = tutorName;
        tutor2_phone = tutorPhone; 
        document.getElementById('inTutor2Name').setAttribute("data-tutor2id", tutorId);
        document.getElementById("inTutor2Name").value = tutorName;
        document.getElementById("inTutor2Phone").value = tutorPhone;
      }else{

      }

      let data = {
        // [CLASS_ID]: docRef.id,
        // [CLASS_NAME]: document.getElementById("inClassName").value,
        // [CLASS_DESC]: document.getElementById("inClassDesc").value,
        // [CATEGORY_KEY]: category,
        // [CATEGORY_ID_KEY]: categoryId,
        // [SUBJECT_KEY]: subject,
        // [SUBJECT_ID_KEY]: subjectId,
        // [ONLINE_KEY]: document.getElementById("onlineonly_check").checked,
        // [CLASS_STUDENT_LIMIT]: document.getElementById("inStudentLimit").value,
        // [CLASS_ANNOUNCEMENT]: document.getElementById("inClassAnnouncement").value,
        // [CLASS_URL]: "UNUSED",
        // [CLASS_TYPE]: (document.getElementById("classTypeRadioPrivate").checked)? CLASS_TYPE_PRIVATE : CLASS_TYPE_PUBLIC,
        // [CLASS_STATUS]: (document.getElementById("classStatusRadioActive").checked)? CLASS_STATUS_ACTIVE : CLASS_STATUS_INACTIVE,
        // [CLASS_VENUE]: document.getElementById("inVenue").value,
        // [STATE_KEY]: gStateName,
        // [STATE_ID_KEY]: gState,
        // [AREA_KEY]: gAreaName,
        // [AREA_ID_KEY]: gArea,

        // Time slot
        // [CLASS_TIMESLOT_DAY_OF_WEEK_ARR]: dayOfWeekArr,
        // [CLASS_TIMESLOT_START_ARR]: startTimeArr,
        // [CLASS_TIMESLOT_END_ARR]: endTimeArr,
        // IDs
        // [CLASS_ADMIN_ID]: tutorId,
        [CLASS_TUTOR_ID_ARR]: [tutor1_id, tutor2_id],
        [CLASS_TUTOR_NAME_ARR]: [tutor1_name, tutor2_name],
        [CLASS_TUTOR_PHONE_ARR]: [tutor1_phone, tutor2_phone],
        // [CLASS_STUDENT_ID_ARR]: [],
        // [CLASS_VIEWER_ID_ARR]:[],
        // Fee type
        // [FEES_KEY]: parseFloat(document.getElementById("inFee").value),
        // [FEES_PER_MONTH_KEY]: (document.getElementById("feeTypePerMonthRadio").checked)? parseFloat(document.getElementById("inFee").value) : parseFloat(document.getElementById("inFee").value * 2 * 4),
        // [FEES_TYPE_KEY]: (document.getElementById("feeTypePerMonthRadio").checked)? FEES_TYPE_PER_MONTH_KEY : FEES_TYPE_PER_HOUR_KEY,
        // Special Permission
        // [CLASS_TUTOR1_ADD_EDIT_STUDENT_ENABLE]: (document.getElementById("t1AddEditStuEn").checked)? true : false,
        // [CLASS_TUTOR1_REMOVE_STUDENT_ENABLE]: (document.getElementById("t1DelStuEn").checked)? true : false,
        // [CLASS_TUTOR1_ADD_EDIT_LESSON_ENABLE]: (document.getElementById("t1AddEditLessonEn").checked)? true : false,
        // [CLASS_TUTOR1_REMOVE_LESSON_ENABLE]: (document.getElementById("t1DelLessonEn").checked)? true : false,
        // [CLASS_TUTOR2_ADD_EDIT_STUDENT_ENABLE]: (document.getElementById("t2AddEditStuEn").checked)? true : false,
        // [CLASS_TUTOR2_REMOVE_STUDENT_ENABLE]: (document.getElementById("t2DelStuEn").checked)? true : false,
        // [CLASS_TUTOR2_ADD_EDIT_LESSON_ENABLE]: (document.getElementById("t2AddEditLessonEn").checked)? true : false,
        // [CLASS_TUTOR2_REMOVE_LESSON_ENABLE]: (document.getElementById("t2DelLessonEn").checked)? true : false,
        // [CLASS_STUDENT_AUTO_JOIN_ENABLE]: (document.getElementById("stuAutoJoinEn").checked)? true : false,

        // [DATE_CREATED_KEY]: new Date(),
        // [DATE_CLOSED_KEY]: "",
        // [STATUS_KEY]: true,
      }
      console.log('Tutors Data');
      console.log(data);
      docRef.set( data, { merge: true })
      .then(() => {
        func.showNotification('top','center', 'success', 'check_circle', "New tutor added.");
      });

    }

    // Remove Elements by Class Name
    function removeElemenentByClassName(elem){
      $( "."+elem).remove();
    }
    
    function removeElementsByClass(className){
      const elements = document.getElementsByClassName(className);
      while(elements.length > 0){
          elements[0].parentNode.removeChild(elements[0]);
      }
    }

    // Validate date n time fields in Add Class Modal. 
    function ValidateFields(parentId){
      // This function deals with validation of the form fields with data-compulsory = 'true'
      var x, y, i, valid = true;
      x = document.getElementById(parentId);
      y =x.querySelectorAll('[data-compulsory="true"]');

      // A loop that checks every input field in the current tab:
      for (i = 0; i < y.length; i++) {
        // console.log(y[i].value)
        // If a field is empty...
        if (y[i].value == "") {
          // add an "invalid" class to the field:
          y[i].className += " invalid";
          // and set the current valid status to false:
          valid = false;
        }
      }
      return valid; // return the valid status
    }

    // Copy a text based on element ID
    function copyText(targetElemId){
      /* Get the text field */
      let copyText = document.getElementById(targetElemId);
      console.log(copyText)
      console.log(copyText.select())
      /* Select the text field */
      copyText.focus();
      copyText.select();
      copyText.setSelectionRange(0, 99999); /* For mobile devices */

      /* Copy the text inside the text field */
      navigator.clipboard.writeText(copyText.value);

      /* Alert the copied text */
      // alert("Copied the text: " + copyText.value);
    }

  </script>

  <!-- Script -->
  <script>
    
    // Global var
    var gState ='';
    var gArea ='';
    var gLevel ='';
    var gSubject ='';
    var gOnlineOnly = false;

    var gStateName='';
    var gAreaName ='';
    var gLevelName = '';
    var gSubjectName = '';

    var categoryId= '';
    var category= ''; 
    var subjectId= ''; 
    var subject= ''; 
    var online = false;

    // Teacher 1 & 2
    var tutor1Id = '';
    var tutor2Id = '';
    var tutor1Name = '';
    var tutor2Name = '';
    var tutor1Phone = '';
    var tutor2Phone = '';

    // Time Slot
    var dayOfWeekArr = [];
    var startTimeArr = [];
    var endTimeArr = [];

    // Edit Lesson Modal
    // Extract info from data-* attributes
    var ID = ""; 
    var DATE = ""; 
    var START = ""; 
    var END = ""; 
    var DESC = ""; 
    var FEEDBACK = ""; 
    var RATE = ""; 
    // Class_Student Submodule
    var STUDENT_CLASS_ID = '';
    var STUDENT_ID = '';
    var STUDENT_NAME = '';
    var GUARDIAN_ID = '';

    var STUDENT_ENROLLMENT_STATUS = '';
    var CURRENT_LESSON_ID = '';
    var CURRENT_LESSON_DATE = '';
    $( document ).ready(function() {
      
      // Init variable
      // categoryId = currentClassObj[CATEGORY_ID_KEY];
      // category = currentClassObj[CATEGORY_KEY];
      // subjectId = currentClassObj[SUBJECT_ID_KEY];
      // subject = currentClassObj[SUBJECT_KEY];
      online = currentClassObj[ONLINE_KEY];
      // gState = currentClassObj[STATE_ID_KEY];
      // gStateName = currentClassObj[STATE_KEY];
      // gArea = currentClassObj[AREA_ID_KEY];
      // gAreaName = currentClassObj[AREA_KEY];


      // // ------Education Level Dropdown End------- //
      // // Populate Education Level
      // var level_select = document.getElementById("level_drop"); 
      // var level = Category; 
      // var catId = CategoryId; 
      // for (var i = 0; i < level.length; i++) {
      //   var opt = level[i];
      //   var el = document.createElement("option");
      //   el.setAttribute("value", catId[i]);
      //   el.textContent = opt;
      //   el.value = catId[i];
      //   // Update Level
      //   if (catId[i] === currentClassObj[CATEGORY_ID_KEY]) {
      //     el.selected = true;
      //   }
      //   level_select.appendChild(el);

      // }

      // // Update Subjects
      // // Clear the area option first, except the first one. 50 is a just a huge number
      // var subject_drop = document.getElementById("subject_drop"); 
      //   for(i=1; i <= 50; i++){
      //     subject_drop.remove(1);
      //   } 
      // // Load default selected subject and respective subject lists
      // var subjectInfo = selectSubjectListBasedOnLevelId(currentClassObj[CATEGORY_ID_KEY]);// Get the subject info
      // var optionsName = subjectInfo[0];
      // var optionId = subjectInfo[1];
      // // console.log("Subjects: "+ options); 

      // for (var i = 0; i < optionsName.length; i++) {
      //   var el = document.createElement("option");
      //   // el.setAttribute("value", "volvocar");
      //   el.textContent = optionsName[i];
      //   el.value = optionId[i];
      //   // Default selection based on existing class
      //   if (optionId[i] === currentClassObj[SUBJECT_ID_KEY]) {
      //     el.selected = true;
      //   }
      //   subject_drop.appendChild(el);
      // }

      // Populate Subject based on selected education level
      $('#level_drop').on('change', function(){
        // Initialization
        // Reasign subject after the level change. It suppose to be defaulted to "Select subject"
        subjectId = ''; 
        subject = '';

        // Get the text of the selected item
        let LevelId_selected = $(this).val(); // Value of the selected item
        let LevelTxt = $(this).find("option:selected").text(); 
        categoryId = LevelId_selected;
        category = LevelTxt;

        // Clear the area option first, except the first one. 100 is a just a huge number
        var subject_drop = document.getElementById("subject_drop");
        for(i=1; i <= 100; i++){
          subject_drop.remove(1);
        } 

        if  (!(categoryId == "" || categoryId == null )){
          let subjectInfo = selectSubjectListBasedOnLevelId(LevelId_selected);// Get the subject info
          let options = subjectInfo[0];
          let optionIds = subjectInfo[1];

          for (let i = 0; i < options.length; i++) {
            let opt = options[i];
            let optId = optionIds[i];
            let el = document.createElement("option");
            el.textContent = opt;
            el.value = optId;
            subject_drop.appendChild(el);
          }
        }
      });


      // ------Subject Dropdown Start------- //
      $('#subject_drop').on('change', function(){
        // Get the val and text of the selected item
        subjectId = $(this).val() 
        subject = $(this).find("option:selected").text(); 
      });
      // ------Subject Dropdown End------- //

      $('#onlineonly_check').on('change', function(){
        // Get the checkbox
        var onlineonly_check = document.getElementById("onlineonly_check");
        gOnlineOnly = onlineonly_check.checked;
        // If the checkbox is checked, display the output text
        if (onlineonly_check.checked == true){
            document.getElementById("state_drop").disabled=true;
            document.getElementById("area_drop").disabled=true;
            document.getElementById("state_drop").style.backgroundColor = "#f5f5f5" ;
            document.getElementById("area_drop").style.backgroundColor="#f5f5f5" ;
        } else {
            document.getElementById("state_drop").disabled=false;
            document.getElementById("area_drop").disabled=false;
            document.getElementById("state_drop").style.backgroundColor = "#fff" ;
            document.getElementById("area_drop").style.backgroundColor="#fff" ;
        }
        // checkSelection(onlineonly_check.checked);
       });

      // // ------State Dropdown start------- //
      // let state_select = document.getElementById("state_drop"); 
      // let state = MYAllState; 
      // let stateId = MYAllStateId; 
      // for (let i = 0; i < state.length; i++) {
      //     let el = document.createElement("option");
      //     el.textContent = state[i];
      //     el.value = stateId[i];
          
      //     // Update State
      //     if (state[i] === currentClassObj[STATE_KEY]) {
      //       el.selected = true;
      //     }
      //     state_select.appendChild(el);
      // }   

      // // Update Area
      // // Clear the area option first, except the first one. 100 is just a huge number
      // let select_area = document.getElementById("area_drop"); 
      // for(i=1; i <= 100; i++){
      //     select_area.remove(1);
      // }  
      // if (!(currentClassObj[STATE_KEY] == null || currentClassObj[STATE_KEY] =='')){
      //   // let options = selectCityBasedOnState (currentClassObj[STATE_KEY]);
      //   let cityInfo = selectCityListBasedOnStateId(currentClassObj[STATE_ID_KEY]);
      //   let cityName = cityInfo[0];
      //   let cityId = cityInfo[1];
      //   for (let i = 0; i < cityName.length; i++) {
      //       let el = document.createElement("option");
      //       el.textContent = cityName[i];
      //       el.value = cityId[i];
      //       // Default selection based on existing class
      //       if (cityName[i] === currentClassObj[AREA_KEY]) {
      //         el.selected = true;
      //       }
      //       select_area.appendChild(el);
      //   }
      // }

      // Populate Area based on selected State
      $('#state_drop').on('change', function(){
        // Initialization
        // Reasign area after the statre change. It suppose to be defaulted to "Select area"
        gArea = ''; 
        gAreaName = ''; 

        // Get the val and txt of the selected state
        let StateId = $(this).val();
        let StateName = $(this).find("option:selected").text(); 
        gState = StateId;
        gStateName = StateName
        
        let select_area = document.getElementById("area_drop"); 
        // Clear the area option first, except the first one. 100 is just a magic number
        for(i=1; i <= 100; i++){
            select_area.remove(1);
        } 

        // Generate all cities based on stateId
        if  (!(StateId == "" || StateId == null )){
          let stateInfo = selectCityListBasedOnStateId (gState);
          for (let i = 0; i < stateInfo[0].length; i++) {
            let el = document.createElement("option");
            el.textContent = stateInfo[0][i];
            el.value = stateInfo[1][i];;
            select_area.appendChild(el);
          }
        }
      });

      // ------Area Dropdown Start------- //
      $('#area_drop').on('change', function(){
          gArea = $(this).val() 
          gAreaName = $(this).find("option:selected").text(); 
      });

      // Populate Time Slot 
      $('#btnAddTimeSlot').on('click', function(e) {

        e.preventDefault();

        // create empty timeslot placeholder
        addTimeSlot('','','');

        // Reinit the time picker 
        initTimePicker()
      });

      // Add / Edit Lesson Modal
      $('#addLessonModal').on('show.bs.modal', function (event) {
        // var button = $(event.relatedTarget) // Button that triggered the modal
        // KEY = button.data('key') // Extract info from data-* attributes
        // DATETIME = button.data('datetime') // Extract info from data-* attributes

        // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
        // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
        // var modal = $(this)
        // modal.find('.modal-title').text(DATETIME)
        // modal.find('.modal-body input').val(KEY);

      });

      // Add Lesson Modal: Add new lesson
      $('#btnAddLessonModalUpdate').on('click', function (event) {
        let validateField = ValidateFields('addLessonModal');
        if (validateField){
          let newLessonId = UploadToDBLesson();

          $('#addLessonModal').modal('hide');

          // if (newLessonId === null || newLessonId ===''){
          //   alert('Error: Add lesson failed. Please try again.')
          // }else{
          //   // addLesson('NEW', null, newLessonId);
          // }
          
         
        }else{
          // Do nothing
        }
      });

      // Add Lesson Modal: Clear fields
      $('#addLessonModal').on('hide.bs.modal', function (event) {
        document.getElementById('datepicker').value = '';
        document.getElementById('addLessonStart').value = '';
        document.getElementById('addLessonEnd').value = '';
        document.getElementById('addLessonDesc').value = '';
        document.getElementById('addLessonFeedback').value = '';
        $('#addLessonRate').rating('reset').val();
        $('#btnAddLessonModalUpdate').prop('disabled', true); 
      });

      $('#datepicker').on('change', function(){
        // console.log($(this).val().length)
        if( $(this).val().length === 0 || $('#addLessonStart').val().length === 0 || $('#addLessonEnd').val().length === 0) {
          $('#btnAddLessonModalUpdate').prop('disabled', true);
        }else{
          $('#btnAddLessonModalUpdate').prop('disabled', false);
        }
      });
      $('#addLessonStart').on('change', function(){
        if( $(this).val().length === 0 || $('#addLessonEnd').val().length === 0 || $('#datepicker').val().length === 0 ) {
          $('#btnAddLessonModalUpdate').prop('disabled', true);
        }else{
          $('#btnAddLessonModalUpdate').prop('disabled', false);
        }
      });
      $('#addLessonEnd').on('change', function(){
        if( $(this).val().length === 0 || $('#addLessonStart').val().length === 0 || $('#datepicker').val().length === 0) {
          $('#btnAddLessonModalUpdate').prop('disabled', true);
        }else{
          $('#btnAddLessonModalUpdate').prop('disabled', false);
        }
      });
      
      // Edit Lesson Modal: Update lesson
      $('#btnEditLessonModalUpdate').on('click', function (event) {
        let validateField = ValidateFields('editLessonModal');
        if (validateField){
          UploadChangesToDBLesson();
          // if (!(UploadChangesToDBLesson())){
          //   alert('Error: Edit lesson failed. Please try again.')
          // }else{
          //   // Do nothing
          // }
          $('#editLessonModal').modal('hide');
        }else{
          // Do nothing
        }
      });

      // Edit Lesson Modal: Assign values
      $('#editLessonModal').on('show.bs.modal', function (event) {
        let button = $(event.relatedTarget) // Button/Components that triggered the modal
        // Extract info from data-* attributes
        ID = button.data('id') 
        DATE = button.data('date')
        START = button.data('start') 
        END = button.data('end')
        DESC = button.data('desc') 
        FEEDBACK = button.data('feedback')
        RATE = button.data('rate') 
        // Load Desription 
        document.getElementById("editLessonId").setAttribute('value', ID);
        document.getElementById("editLessonDatepicker").value = DATE;
        document.getElementById("editLessonStart").value = START;
        document.getElementById("editLessonEnd").value = END;
        document.getElementById("editLessonDesc").value = DESC;
        document.getElementById("editLessonFeedback").value = FEEDBACK;
        document.getElementById("editLessonRate").value = RATE;
        $('#editLessonRate').rating('update', parseFloat(RATE));
      });
      
      // Edit Lesson Modal: Clear key and fields in modal when modal dismiss
      $('#editLessonModal').on('hide.bs.modal', function (event) {
        ID = "";
        DATE = "";
        START = "";
        END = "";
        DESC = "";
        FEEDBACK = "";
        RATE = "";

        $('#btnEditLessonModalUpdate').prop('disabled', true);

        // document.getElementById("modalClassAnnouncement").textContent = "";
      });

      $('#editLessonDatepicker').on('change', function(){
        // console.log($(this).val().length)
        if( $(this).val().length === 0 || $('#editLessonStart').val().length === 0 || $('#editLessonEnd').val().length === 0) {
          $('#btnEditLessonModalUpdate').prop('disabled', true);
        }else{
          $('#btnEditLessonModalUpdate').prop('disabled', false);
        }
      });
      $('#editLessonStart').on('change', function(){
        if( $(this).val().length === 0 || $('#editLessonEnd').val().length === 0 || $('#editLessonDatepicker').val().length === 0 ) {
          $('#btnEditLessonModalUpdate').prop('disabled', true);
        }else{
          $('#btnEditLessonModalUpdate').prop('disabled', false);
        }
      });
      $('#editLessonEnd').on('change', function(){
        if( $(this).val().length === 0 || $('#editLessonStart').val().length === 0 || $('#editLessonDatepicker').val().length === 0) {
          $('#btnEditLessonModalUpdate').prop('disabled', true);
        }else{
          $('#btnEditLessonModalUpdate').prop('disabled', false);
        }
      });
      
      $('#editLessonDesc').on('input', function(){
        $('#btnEditLessonModalUpdate').prop('disabled', false);
      });

      $('#editLessonFeedback').on('input', function(){
        $('#btnEditLessonModalUpdate').prop('disabled', false);
      });

      $('#editLessonRate').on('change', function(){
        $('#btnEditLessonModalUpdate').prop('disabled', false);
      })

      $('#editLessonRate').on('change', function(){
        // $('#addLessonModal').modal('hide');
      })

      // Show Remove Lesson Modal
      $('#delLessonModal').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget) // Button that triggered the modal
        CURRENT_LESSON_ID = button.data('id') // Extract info from data-* attributes
        CURRENT_LESSON_DATE = button.data('lessondate') // Extract info from data-* attributes

        // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
        // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
        var modal = $(this)
        modal.find('.modal-title').text('Deleting lesson on '+ CURRENT_LESSON_DATE)
        document.getElementById("deleteLessonId").setAttribute('value', CURRENT_LESSON_ID);

      });

      // Remove Lesson from class
      $('#btnDelLessonModalUpdate').on('click', function (event) {
        let lessonId =  document.getElementById("deleteLessonId").getAttribute('value');
        RemoveLesson();

      });

      // Remove Lesson Modal: Clear key and fields in modal when modal dismiss
      $('#delLessonModal').on('hide.bs.modal', function (event) {
        CURRENT_LESSON_ID = "";
        CURRENT_LESSON_DATE = "";
      });


      // Load all Admin Students
      $('#addStudentModal').on('show.bs.modal', function (event) {
        latestAdminStuDoc = null;
        loadAllAdminStudents();
      });

      // Remove all Admin Students when the Add Student Modal close
      $('#addStudentModal').on('hidden.bs.modal', function (event) {
        // NOTE: div:gt(4) - get the 5th div child in the parent node.
        $('#add-student-modal-container div:gt(4)').remove();

      });

     // Remove Student from class Modal show
     $('#delStudentModal').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget) // Button that triggered the modal
        STUDENT_CLASS_ID = button.data('id') // Extract info from data-* attributes
        STUDENT_ID = button.data('stuid') // Extract info from data-* attributes
        STUDENT_NAME = button.data('stuname') // Extract info from data-* attributes
        GUARDIAN_ID = button.data('gurid') // Extract info from data-* attributes

        // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
        // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
        var modal = $(this)
        modal.find('.modal-title').text('Deleting '+ STUDENT_NAME)
        document.getElementById("deleteStudentClassId").setAttribute('value', STUDENT_CLASS_ID);
        document.getElementById("deleteStudentName").setAttribute('value', STUDENT_NAME);
        document.getElementById("deleteStudentId").setAttribute('value', STUDENT_ID);
        document.getElementById("deleteGuardianId").setAttribute('value', GUARDIAN_ID);

      });

     // Remove Student from class
     $('#btnDelStudentModalUpdate').on('click', function (event) {
        let studentClassId =  document.getElementById("deleteStudentClassId").getAttribute('value');
        let studentName =  document.getElementById("deleteStudentName").getAttribute('value');
        let studentId =  document.getElementById("deleteStudentId").getAttribute('value');
        let guardianId =  document.getElementById("deleteGuardianId").getAttribute('value');
        console.log(studentClassId, studentName, studentId, guardianId );
        removeStudent(studentClassId, studentName, studentId, guardianId );

      });

     // Remove Student Modal: Clear key and fields in modal when modal dismiss
     $('#delStudentModal').on('hide.bs.modal', function (event) {
        STUDENT_ID = "";
        STUDENT_NAME = "";
      });



     // Edit Students
     $('#editStudentModal').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget) // Button that triggered the modal
        STUDENT_ID = button.data('id') // Extract info from data-* attributes
        STUDENT_NAME = button.data('stuname') // Extract info from data-* attributes
        STUDENT_ENROLLMENT_STATUS = button.data('enrollmentstatus')

        console.log(STUDENT_ID);
        console.log(STUDENT_NAME);
        console.log(STUDENT_ENROLLMENT_STATUS);
        console.log(allClassStuDoc);


        // Find the right students from allClassStuDoc based on the student id
        let selectedClassStuDoc = null;

        allClassStuDoc.forEach((doc) => {
          console.log(doc);
          if (STUDENT_ID === doc.id){
            selectedClassStuDoc = doc;
          }
        });

        document.getElementById("editStudentId").setAttribute('value', STUDENT_ID);
        document.getElementById("editStudentEnrollmentStatus").setAttribute('value', STUDENT_ENROLLMENT_STATUS);

        document.getElementById("stuName").value = selectedClassStuDoc.stuName;
        document.getElementById("stuPhone").value = selectedClassStuDoc.stuPhone;
        document.getElementById("stuEmail").value = selectedClassStuDoc.stuEmail; 
        document.getElementById("stuGenderMale").checked = selectedClassStuDoc.stuGender === 0 ? true : false;
        document.getElementById("stuGenderFemale").checked = selectedClassStuDoc.stuGender === 1 ? true : false;
        document.getElementById("gurName").value = selectedClassStuDoc.gurName;
        document.getElementById("gurPhone").value = selectedClassStuDoc.gurPhone;
        document.getElementById("gurEmail").value = selectedClassStuDoc.gurEmail;
        document.getElementById("gurAddr").value = selectedClassStuDoc.gurAddr;
        document.getElementById("stuFeedback").value = selectedClassStuDoc.feedback;

        // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
        // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
        var modal = $(this)
        
        if (STUDENT_ENROLLMENT_STATUS === CLASS_STUDENT_ENROLLMENT_STATUS_PENDING){
          modal.find('.modal-title').text('New Student: '+STUDENT_NAME)
          document.getElementById("btnEditStudentModalUpdate").setAttribute('class', 'btn btn-warning');
          document.getElementById("btnEditStudentModalUpdate").textContent = 'Approve New Student'
        }else if (STUDENT_ENROLLMENT_STATUS === CLASS_STUDENT_ENROLLMENT_STATUS_ACTIVE){
          modal.find('.modal-title').text(STUDENT_NAME)
          document.getElementById("btnEditStudentModalUpdate").setAttribute('class', 'btn btn-primary');
          document.getElementById("btnEditStudentModalUpdate").textContent = 'Update'
        }else{
          modal.find('.modal-title').text(STUDENT_NAME)
          document.getElementById("btnEditStudentModalUpdate").setAttribute('class', 'btn btn-primary');
          document.getElementById("btnEditStudentModalUpdate").textContent = 'Update'
        }


      });

      // Update Student's Feedback from class
      $('#btnEditStudentModalUpdate').on('click', function (event) {
        let studentId =  document.getElementById("editStudentId").getAttribute('value');
        let studentFeedback =  document.getElementById("stuFeedback").value;
        let studenEnrollmentStatus=  document.getElementById("editStudentEnrollmentStatus").value;

        // console.log()
        updateStudent(studentId, studentFeedback, studenEnrollmentStatus);

      });

      // Remove Student Modal: Clear key and fields in modal when modal dismiss
      $('#editStudentModal').on('hide.bs.modal', function (event) {
        STUDENT_ID = "";
        STUDENT_NAME = "";
      });


      // Load All Admin's Teachers
      $('#myTeacherModal').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget) // Button that triggered the modal
        tutorBtnNum = parseInt(button.data('num')); // Extract info from data-* attributes
        latestAdminTutorDoc = null;
        loadAllAdminTeachers(tutorBtnNum);
      });
      // Remove all Admin's Teachers when the List Teacher Modal close
      $('#myTeacherModal').on('hidden.bs.modal', function (event) {
        // NOTE: div:gt(5) - get the 6th div child in the parent node.
        $('#add-tutor-modal-container div:gt(5)').remove();
        tutorBtnNum = 0; 
      });


      // Update data
      $('#btnSaveModalUpdate').on('click', function (event) {
        getAllTimeSlots();
        UpdateClass(currentClassObj[CLASS_ID]);

      });

      $('#btnSignOutModalUpdate').on('click', function (e) {
      
        firebase.auth().signOut().then(() => {
            // Sign-out successful.
          }).catch((error) => {
            window.alert("Logging out failed");
            func.showNotification('top','center', 'danger', 'error_outline', "Logging out failed." );
          });
        // Do something
        $('#signOutModal').modal('hide');
      });

      $('#btnSignOutModalClose1').on('click', function (e) {
        $('#signOutModal').modal('hide');
      });
      $('#btnSignOutModalClose2').on('click', function (e) {
        $('#signOutModal').modal('hide');
      });
    
      // Activate Account
      $('#btnActivationModalUpdate').on('click', function (e) {
        if (current_accountStatus == DEACTIVATED_ACCOUNT_STATUS_KEY){
          window.location = "https://golearn.com.my/join-us/";
        }else if (current_accountStatus == SUSPENDED_ACCOUNT_STATUS_KEY){
          window.location = "https://golearn.com.my/contact-us/";
        }else {
          window.location = "https://golearn.com.my/pricing/";
        }
        // Do something
        $('#activationModal').modal('hide');
      });

      $('#btnActivationModalClose1').on('click', function (e) {
        $('#activationModal').modal('hide');
      });
      $('#btnActivationModalClose2').on('click', function (e) {
        $('#activationModal').modal('hide');
      });
    
    });

  </script>
  
 
  <!-- Multiform-specific script -->
  <script>
    //DOM elements
    const DOMstrings = {
      stepsBtnClass: 'multitabs-form__progress-btn',
      stepsBtns: document.querySelectorAll(`.multitabs-form__progress-btn`),
      stepsBar: document.querySelector('.multitabs-form__progress'),
      stepsForm: document.querySelector('.multitabs-form__form'),
      stepsFormTextareas: document.querySelectorAll('.multitabs-form__textarea'),
      stepFormPanelClass: 'multitabs-form__panel',
      stepFormPanels: document.querySelectorAll('.multitabs-form__panel'),
      stepPrevBtnClass: 'js-btn-prev',
      stepNextBtnClass: 'js-btn-next',
      stepSendBtnClass: 'js-btn-send' };


    //remove class from a set of items
    const removeClasses = (elemSet, className) => {

      elemSet.forEach(elem => {

        elem.classList.remove(className);

      });

    };

    //return exect parent node of the element
    const findParent = (elem, parentClass) => {

      let currentNode = elem;

      while (!currentNode.classList.contains(parentClass)) {
        currentNode = currentNode.parentNode;
      }

      return currentNode;

    };

    //get active button step number
    const getActiveStep = elem => {
      return Array.from(DOMstrings.stepsBtns).indexOf(elem);
    };

    //set all steps before clicked (and clicked too) to active
    const setActiveStep = activeStepNum => {

      //remove active state from all the state
      removeClasses(DOMstrings.stepsBtns, 'js-active');

      //set picked items to active
      DOMstrings.stepsBtns.forEach((elem, index) => {

        if (index == activeStepNum) {
          elem.classList.add('js-active');
        }

      });
    };

    //get active panel
    const getActivePanel = () => {

      let activePanel;

      DOMstrings.stepFormPanels.forEach(elem => {

        if (elem.classList.contains('js-active')) {

          activePanel = elem;

        }

      });

      return activePanel;

    };

    //open active panel (and close unactive panels)
    const setActivePanel = activePanelNum => {

      //remove active class from all the panels
      removeClasses(DOMstrings.stepFormPanels, 'js-active');

      //show active panel
      DOMstrings.stepFormPanels.forEach((elem, index) => {
        if (index === activePanelNum) {

          elem.classList.add('js-active');

          setFormHeight(elem);

        }
      });

    };

    //set form height equal to current panel height
    const formHeight = activePanel => {

      const activePanelHeight = activePanel.offsetHeight;

      DOMstrings.stepsForm.style.height = `${activePanelHeight}px`;

    };

    const setFormHeight = () => {
      const activePanel = getActivePanel();

      formHeight(activePanel);
    };

    //STEPS BAR CLICK FUNCTION
    DOMstrings.stepsBar.addEventListener('click', e => {

      //check if click target is a step button
      const eventTarget = e.target;

      if (!eventTarget.classList.contains(`${DOMstrings.stepsBtnClass}`)) {
        return;
      }

      

      //get active button step number
      const activeStep = getActiveStep(eventTarget);

      //set all steps before clicked (and clicked too) to active
      setActiveStep(activeStep);

      //open active panel
      setActivePanel(activeStep);
    });

    //PREV/NEXT BTNS CLICK
    DOMstrings.stepsForm.addEventListener('click', e => {
       
      const eventTarget = e.target;

      //check if we clicked on `PREV` or NEXT` buttons
      if (eventTarget.classList.contains(`${DOMstrings.stepSendBtnClass}`))
      {
        // Create Class btn is clicked
        // /Class/v1/Class/ZGeLtRmzIaOPuBkbhHTH
        var docRef = db.collection("Class")
          .doc("v1")
          .collection("Class")
          .doc();

        // Notice that I use .add(..), instead of .set(..). This is because the docRef do not specify the docId.
        
        // func.showNotification('top','center', 'success', 'check_circle', "Class created.");
      }
      else if (eventTarget.classList.contains(`${DOMstrings.stepPrevBtnClass}`) || eventTarget.classList.contains(`${DOMstrings.stepNextBtnClass}`))
      {
        // Proceed to move to next / prev page
      }else{
        // Do nothing and return 
        return;
        
      }

      //find active panel
      const activePanel = findParent(eventTarget, `${DOMstrings.stepFormPanelClass}`);

      let activePanelNum = Array.from(DOMstrings.stepFormPanels).indexOf(activePanel);
      getAllTimeSlots()
      //set active step and active panel onclick
      if (eventTarget.classList.contains(`${DOMstrings.stepPrevBtnClass}`)) {
        activePanelNum--;

        setActiveStep(activePanelNum);
        setActivePanel(activePanelNum);
      } else {

        if (!validateForm(activePanelNum)){
          
        }else{
          activePanelNum++;
          setActiveStep(activePanelNum);
          setActivePanel(activePanelNum);
        }
      }
      // setActiveStep(activePanelNum);
      // setActivePanel(activePanelNum);
    });

    //SETTING PROPER FORM HEIGHT ONLOAD
    window.addEventListener('load', setFormHeight, false);

    //SETTING PROPER FORM HEIGHT ONRESIZE
    window.addEventListener('resize', setFormHeight, false);

    //changing animation via animation select !!!YOU DON'T NEED THIS CODE (if you want to change animation type, just change form panels data-attr)

    const setAnimationType = newType => {
      DOMstrings.stepFormPanels.forEach(elem => {
        elem.dataset.animation = newType;
      });
    };

    //selector onchange - changing animation
    // const animationSelect = document.querySelector('.pick-animation__select');

    // animationSelect.addEventListener('change', () => {
    //   const newAnimationType = animationSelect.value;

    //   setAnimationType(newAnimationType);
    // });


    // <!--General form panel-->
    // <div class="multitabs-form__panel shadow p-4 rounded bg-white js-active" data-animation="scaleIn">
    //   <h4 class="multitabs-form__title">General Info</h4>
    //   <div class="multitabs-form__content">
    //     <div class="col-md-12">

    //       <div class="form-group" style="margin-top: 2rem;">
    //         <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Class Name*</span> 
    //         <input type="text" class="form-control" id="inClassName">
    //       </div>


    function validateForm(activePanelNum) {
      // This function deals with validation of the form fields with data-compulsory = 'true'
      var x, y, i, valid = true;
      x = document.getElementsByClassName("multitabs-form__panel");
      // y = x[activePanelNum].getElementsByTagName("input") && x[activePanelNum].querySelectorAll('[type="text"]');
      y =x[activePanelNum].querySelectorAll('[data-compulsory="true"]');

      // A loop that checks every input field in the current tab:
      for (i = 0; i < y.length; i++) {
        // console.log(y[i].value)
        // If a field is empty...
        if (y[i].value == "") {
          // add an "invalid" class to the field:
          y[i].className += " invalid";
          // and set the current valid status to false:
          valid = false;
        }
      }
      // If the valid status is true, mark the step as finished and valid:
      if (valid) {
        // document.getElementsByClassName("step")[activePanelNum].className += " finish";
      }
      return valid; // return the valid status
    }

    function getAllTimeSlots() {
      dayOfWeekArr = [];
      startTimeArr = [];
      endTimeArr = [];
      // This function deals with validation of the form fields with data-compulsory = 'true'
      var x, y, i, valid = true;
      x = document.getElementById("timeSlotTop");
      console.log(x)
      // y = x[activePanelNum].getElementsByTagName("input") && x[activePanelNum].querySelectorAll('[type="text"]');
      y =x.querySelectorAll('[data-compulsory="true"]');

      // A loop that checks every input field in the current tab:
      for (i = 0; i < y.length; i++) {

        if (i % 3 === 0){
          dayOfWeekArr.push(y[i].value)
        }
        if (i % 3 === 1){
          startTimeArr.push(y[i].value)
        }
        if (i % 3 === 2){
          endTimeArr.push(y[i].value)
        }
   
        
        // If a field is empty...
        if (y[i].value == "") {
          // add an "invalid" class to the field:
          // y[i].className += " invalid";
          // and set the current valid status to false:
          valid = false;
        }
      }

      // console.log(dayOfWeekArr)
      // console.log(startTimeArr)
      // console.log(endTimeArr)
      return valid; // return the valid status
    }


  </script>


  <!-- ClockPicker script 2 -->
  <script type="text/javascript">
    // $('.clockpicker').clockpicker()
    //   .find('input').change(function(){
    //     // TODO: time changed
    //     // console.log(this.value);
    //   });
    // $('#demo-input').clockpicker({
    //   autoclose: true
    // });

    // if (something) {
    //   // Manual operations (after clockpicker is initialized).
    //   $('#demo-input').clockpicker('show') // Or hide, remove ...
    //       .clockpicker('toggleView', 'minutes');
    // }

    // function initTimePicker(){
    //   $('.clockpicker').clockpicker()
    //   .find('input').change(function(){
    //     // TODO: time changed
    //     // console.log(this.value);
    //   });

    // }
    // Date picjer
    // Source: https://mcdatepicker.netlify.app/docs/
    const calendarTheme = {
      theme_color: '#2e74b6', //#19212b
      main_background: '#FBFBFB',
      active_text_color: 'rgba(62,85,110,0.85)',
      inactive_text_color: '#cfe6ff',
      picker_header: {
        active: '#8ea5bd'
      },
      weekday: {
        foreground: '#2e74b6' //rgba(35,68,97,0.8)
      },
      display: {
        foreground: '#8ea5bd'
      },
      date: {
        active: {
          picked: {
            background: '#2e74b6'
          }
        },
        marcked: {
          foreground: '#53a6fa'
        }
      },
      button: {
        danger: {
          foreground: '#af002a'
        },
        success: {
          foreground: '#2e74b6'
        }
      }
    };

    // const addLessonModalDatePicker = MCDatepicker.create({
    //   el: '#datepicker',
    //   bodyType: 'inline',
    //   dateFormat: 'dd/mm/yyyy', //dateFormat: 'dddd, dd mmmm yyyy', 
    //   selectedDate: new Date(),
    //   firstWeekday: 1,
    //   minDate: new Date(2020, 0, 1),

    //   theme: calendarTheme
    // });
    // const editLessonModalDatePicker = MCDatepicker.create({
    //   el: '#editLessonDatepicker',
    //   bodyType: 'inline',
    //   dateFormat: 'dd/mm/yyyy',
    //   selectedDate: new Date(),
    //   firstWeekday: 1,
    //   minDate: new Date(2020, 0, 1),
    //   theme: calendarTheme
    // });

    // const datepickerBTN = document.querySelector('#datepicker_btn');
    // datepickerBTN.onclick = () => {
    //   firstDatePicker.open();
    // };

    // Close the datepicker if we clicked on other components
    // document.querySelector('#addLessonModal').addEventListener('click', e => {
    //   const eventTarget = e.target;
    //   if (!(eventTarget.id == "datepicker"))// || eventTarget.id == "datepicker_btn"))
    //   {
    //     addLessonModalDatePicker.close();
    //   }
    //   else{
    //   }
    // });
    // Close the datepicker if we clicked on other components
    // document.querySelector('#editLessonModal').addEventListener('click', e => {
    //   const eventTarget = e.target;
    //   if (!(eventTarget.id == "editLessonDatepicker"))// || eventTarget.id == "datepicker_btn"))
    //   {
    //     editLessonModalDatePicker.close();
    //   }
    //   else{
    //   }
    // });

  </script>

</body>

</html>