<!doctype html>
<html lang="en">

<head>
  <!-- Meta -->
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>GoLearn School</title>
  <meta name=description content="GoLearn School&trade; is Malaysia #1 learning platform to manage tuition lessons for you and your children. Start now for Free!">
  <meta property=og:title content="GoLearn School">
  <meta property=og:site_name content="GoLearn School">
  <meta property=og:type content=website>
  <meta property=og:url content=https://app.golearn.com.my/client/dependant/ >
  <meta property=og:image content=https://app.golearn.com.my/assets/img/icon-apple-touch-180x180.png>
  <meta property=og:description content="GoLearn School&trade; is Malaysia #1 learning platform to manage tuition lessons for you and your children. Start now for Free!">
  <link rel=apple-touch-icon sizes=180x180 href=https://app.golearn.com.my/assets/img/icon-apple-touch-180x180.png>
  <link rel=icon type=image/png sizes=32x32 href=https://app.golearn.com.my/assets/img/icon-32x32.png>
  <link rel=icon type=image/png sizes=16x16 href=https://app.golearn.com.my/assets/img/icon-16x16.png>
  <!-- Fonts and icons -->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <script src="https://kit.fontawesome.com/2bdd669e92.js" crossorigin="anonymous"></script>
  <!-- Material Kit CSS -->
  <link href="../../assets/css/material-dashboard.css?v=2.1.2" rel="stylesheet"/>
  <!-- Tutor specific css -->
  <link href="../../assets/css/tutor.css" rel="stylesheet" />
  <link href="../../assets/css/tutor-portal.css" rel="stylesheet" />
  <!-- Firebase Init -->
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-storage.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-firestore.js"></script>
  <script src="../../assets/js/firebase.js"></script>
</head>

<body>

  <div class="wrapper ">
    <div class="sidebar" data-color="purple" data-background-color="white" data-image="../../assets/img/sidebar-3.jpg">
      <div class="logo">
        <a href="../" class="simple-text logo-mini" style="padding: 0.5rem">
			    <img src="../../assets/img/golearn-school-logo.svg" style="width: 200px; height: auto;" alt=""></img>
        </a>
      </div>
      <div class="sidebar-wrapper">
        <ul class="nav">
		  		<li class="nav-item">
            <a class="nav-link" href="../class/">
              <i class="fas fa-chalkboard fa-fw nav-icon"></i>
              <p>My Classes</p>
            </a>
          </li>
          <li class="nav-item active">
            <a class="nav-link" href="./">
              <i class="fas fa-user-graduate fa-fw nav-icon"></i>
              <p>My Dependants</p>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../payment/">
              <i class="fas fa-file-invoice-dollar fa-fw nav-icon"></i>
              <p>Payments</p>
            </a>
          </li>
		  		<li class="nav-item">
            <a class="nav-link" href="../request/">
              <i class="fas fa-briefcase fa-fw nav-icon"></i>
              <p>Lesson Requests</p>
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="main-panel">
      <!-- Navbar -->
      <nav class="navbar navbar-expand-lg navbar-transparent navbar-absolute fixed-top ">
        <div class="container-fluid">
          <div class="navbar-wrapper">
            <a class="navbar-brand" href="javascript:;">Dependants</a>
          </div>

          <button class="navbar-toggler" type="button" data-toggle="collapse" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="navbar-toggler-icon icon-bar"></span>
            <span class="navbar-toggler-icon icon-bar"></span>
            <span class="navbar-toggler-icon icon-bar"></span>
          </button>
          <div class="collapse navbar-collapse justify-content-end">
            <form class="navbar-form">
              <!-- Put empty placeholder here -->
            </form>

            <ul class="navbar-nav">
              <li class="nav-item" id="activationNavItem">
                <a href="#" class="btn btn-danger btn-round" style="visibility: hidden;" id="btnActivateAccount" ></a>
              </li>
              <li class="nav-item">
                <a class="navbar-brand" href="javascript:;">
                   Hi <span id="user"></span> !
                </a> 
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link" href="javascript:;" id="navbarDropdownNotification" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <i class="material-icons">notifications</i> Notifications
                </a>
                <!-- <a class="nav-link" href="http://example.com" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <i class="material-icons">notifications</i>
                  <span class="notification">5</span>
                  <p class="d-lg-none d-md-block">
                    Some Actions
                  </p>
                </a> -->
								<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
									<p style="padding: 1em;" >No notification</p>
                  <!-- <a class="dropdown-item" href="#">Mike John responded to your email</a>
                  <a class="dropdown-item" href="#">You have 5 new tasks</a>
                  <a class="dropdown-item" href="#">You're now friend with Andrew</a>
                  <a class="dropdown-item" href="#">Another Notification</a>
                  <a class="dropdown-item" href="#">Another One</a> -->
                </div>
              </li>
              <!-- your navbar here -->
			  
			  			<li class="nav-item dropdown">
                <a class="nav-link" href="javascript:;" id="navbarDropdownProfile" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <i class="material-icons">person</i>
                  <p class="d-lg-none d-md-block">
                    Account
                  </p>
                </a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownProfile">
                  <a class="dropdown-item" href="../edit-profile.html">Edit Profile</a>
									<a class="display:block; dropdown-item" href="../about.html">About</a>
									<div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="javascript:;" data-toggle="modal" data-target="#signOutModal" id="btn-logout">Log out</a>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </nav>
      <!-- End Navbar -->

      <!-- Modal Start -->

      <!-- Delete Dependant modal -->
      <div class="row">
        <div class="modal fade" id="delStuModal" tabindex="-1" role="dialog" aria-labelledby="delStuModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="delStuModalLabel"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnDelStuModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="delStuModalBody">
                <div id="delStuId" value=""></div>
                Are you sure you want to continue?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnDelStuModalClose2">Not Now</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnDelStuModalUpdate">Delete</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Sign Out modal -->
      <div class="row">
        <div class="modal fade" id="signOutModal" tabindex="-1" role="dialog" aria-labelledby="signOutModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="signOutLabel">Logging Out</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="signOutModalBody">
                Are you sure you want to continue?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnSignOutModalUpdate">Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal End -->

      <div class="content">
        <div class="container-fluid">
          <div class="row" id="desciption-row" >
            <!-- Update button -->

            <div class="d-flex flex-row">
              <a href="./add-dependant.html" class="btn btn-primary btn-round" id="btnAddClass" style="background-color: #2e74b6;">Add Dependant <i class="material-icons" style="color: white; margin-left: 0.5em; padding-bottom: 0.2em;">east</i></a>
            </div>
          </div>

          <div class="row" id="card-all-students" style="margin-top: 1rem;">

            <div class="col-md-12 card-student">
              <div class="row" >
                <div class="col-md-11" style="padding: 0;">
                  <div class="row" style="margin: 0;">
                    <div class="col-md-3">
                      <h6 style="font-weight: 600; color: #2e74b6; font-size: 0.8rem; margin: 0;" data-toggle="tooltip" title="No info">Dependant Name</h6>
                    </div>
                    <div class="col-md-1">
                      <h6 style="font-weight: 600; color: #2e74b6; font-size: 0.8rem; margin: 0;" data-toggle="tooltip" title="No info">Gender</h6>
                    </div>
                    <div class="col-md-2">
                      <h6 style="font-weight: 600; color: #2e74b6; font-size: 0.8rem; margin: 0;" data-toggle="tooltip" title="No info">Contact No.</h6>
                    </div>
                    <div class="col-md-2">
                      <h6 style="font-weight: 600; color: #2e74b6; font-size: 0.8rem; margin: 0;" data-toggle="tooltip" title="No info">Email</h6>
                    </div>
                    <div class="col-md-4">
                      <h6 style="font-weight: 600; color: #2e74b6; font-size: 0.8rem; margin: 0;" data-toggle="tooltip" title="No info">School</h6>
                    </div>
                  </div>
                </div>
                <div class="col-md-1">
                  <h6 style="font-weight: 600; color: #2e74b6; font-size: 0.8rem; margin: 0;" data-toggle="tooltip" title="No info">Action</h6>
                </div>

              </div>
            </div>

            <!-- Dependant List Start -->
            <!-- <div class="col-md-12 card-student-item">
              <div class="row">
                <div class="col-md-11" >
                  <div class="row" style=" margin: 12px 0 0 0;">
                    <div class="col-md-3">
                      <p style="font-size: 1rem; font-weight: 400;">Alric Liew</p>
                    </div>
                    <div class="col-md-1 col-3">
                      <p>Male</p>
                    </div>
                    <div class="col-md-2 col-8">
                      <p>+60138252818</p>
                    </div>
                    <div class="col-md-2">
                      <p>alricliew@gmail.com</p>
                    </div>
                    <div class="col-md-4">
                      <p>SMK Bau</p>
                    </div>
                  </div>
                </div>
                <div class="col-md-1 align-self-center">
                  <div class="row" style="margin: 12px 0 12px 8px;">
                    <a id="btnDelStudent" href="javascript:;"  data-toggle="modal" data-target="#delStuModal" data-id="M1IODJJZencMhRDVx1gm" data-studentname="Alric Liew">
                      <span class="fa-stack" style="vertical-align: middle; font-size: 73%; color: red; cursor: pointer;">
                        <i class="fas fa-circle fa-stack-2x" style="text-shadow:  2px 2px 4px rgba(46, 46, 46, 0.8);" aria-hidden="true"></i>
                        <i class="fas fa-minus fa-stack-1x fa-inverse" style="padding: 0;" aria-hidden="true"></i>
                      </span>
                    </a>
                  </div>
                </div>
              </div>
            </div> -->
          </div>
 
		    </div>
      </div>

      <footer class="footer">
        <div class="container-fluid">
          <nav class="float-left">
          <ul>
            <!-- <li>
            <a href="https://golearn.com.my" target="_blank">
              Visit GoLearn
            </a>
            </li> -->
          </ul>
          </nav>
          <!-- <div class="copyright float-right">
            &copy;
            <script>
              document.write(new Date().getFullYear())
            </script> 
            , made with <i class="material-icons">favorite</i> by <a href="#" >GoLearn Team</a>
          </div> -->
          <!-- your footer here -->
        </div>
      </footer>
    </div>
	  
  </div>

  <script src="../../assets/js/core/jquery.min.js"></script>
  <script src="../../assets/js/core/popper.min.js"></script>
  <script src="../../assets/js/core/bootstrap-material-design.min.js"></script>
  <script src="../../assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
  <!-- Plugin for the momentJs  -->
  <script src="../../assets/js/plugins/moment.min.js"></script>
  <!--  Plugin for Sweet Alert -->
  <script src="../../assets/js/plugins/sweetalert2.js"></script>
  <!-- Forms Validations Plugin -->
  <script src="../../assets/js/plugins/jquery.validate.min.js"></script>
  <!-- Plugin for the Wizard, full documentation here: https://github.com/VinceG/twitter-bootstrap-wizard -->
  <!-- <script src="assets/js/plugins/jquery.bootstrap-wizard.js"></script> -->
  <!-- 	Plugin for Select, full documentation here: http://silviomoreto.github.io/bootstrap-select -->
  <!-- <script src="assets/js/plugins/bootstrap-selectpicker.js"></script> -->
  <!--  Plugin for the DateTimePicker, full documentation here: https://eonasdan.github.io/bootstrap-datetimepicker/ -->
  <!-- <script src="assets/js/plugins/bootstrap-datetimepicker.min.js"></script> -->
  <!--  DataTables.net Plugin, full documentation here: https://datatables.net/  -->
  <!-- <script src="assets/js/plugins/jquery.dataTables.min.js"></script> -->
  <!-- 	Plugin for Tags, full documentation here: https://github.com/bootstrap-tagsinput/bootstrap-tagsinputs  -->
  <!-- <script src="assets/js/plugins/bootstrap-tagsinput.js"></script> -->
  <!-- Plugin for Fileupload, full documentation here: http://www.jasny.net/bootstrap/javascript/#fileinput -->
  <!-- <script src="assets/js/plugins/jasny-bootstrap.min.js"></script> -->
  <!--  Full Calendar Plugin, full documentation here: https://github.com/fullcalendar/fullcalendar    -->
  <!-- <script src="assets/js/plugins/fullcalendar.min.js"></script> -->
  <!-- Vector Map plugin, full documentation here: http://jvectormap.com/documentation/ -->
  <!-- <script src="assets/js/plugins/jquery-jvectormap.js"></script> -->
  <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
  <!-- <script src="assets/js/plugins/nouislider.min.js"></script> -->
  <!-- Include a polyfill for ES6 Promises (optional) for IE11, UC Browser and Android browser support SweetAlert -->
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/core-js/2.4.1/core.js"></script> -->
  <!-- Library for adding dinamically elements -->
  <!-- <script src="assets/js/plugins/arrive.min.js"></script> -->
  <!--  Google Maps Plugin    -->
  <!-- <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script> -->
  <!-- Chartist JS -->
  <!-- <script src="assets/js/plugins/chartist.min.js"></script> -->
  <!--  Notifications Plugin    -->
  <script src="../../assets/js/plugins/bootstrap-notify.js"></script>
  <!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="../../assets/js/material-dashboard.js?v=2.1.2" type="text/javascript"></script>
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.min.js" integrity="sha384-lpyLfhYuitXl2zRZ5Bn2fqnhNAKOAaM/0Kr9laMspuaMiZfGmfwRNFh8HlMy49eQ" crossorigin="anonymous"></script>
  
  <!-- Common constants -->
  <script src="../../assets/js/common.js" type="text/javascript"></script>
  <!-- Global Var -->
  <script src="../../assets/js/client-globalvar.js" type="text/javascript"></script>
  <!-- Core Client Js -->
  <script src="../../assets/js/client-core.js" type="text/javascript"></script>

  <script>
    // // Global Variables
    // var userId;
    // var current_name, current_email, current_phone, current_imgUri, current_nric,
    //   current_address1, current_address2, current_addressPostCode, current_addressState, current_address;

		// var db = firebase.firestore();
		// db.settings({ timestampsInSnapshots: true });

    // Initialization
    AuthCheck();

    // Page Specific Initialization
    function loadPageInitFunc(){

      loadAllDependantInfo(userId);
    }


		// firebase.auth().onAuthStateChanged(function(user){
      
		// 	if(!user){
    //     // Return to login if user does not exist.
		// 		window.location.href = "./login.html"
		// 	}else{
    //     // if the displayName is null, it means user register using Phone
    //     if (firebase.auth().currentUser.displayName == null ){
    //       userId = firebase.auth().currentUser.phoneNumber;
    //     }else
    //       userId = firebase.auth().currentUser.email.replace("[^a-zA-Z0-9]", "_").toLowerCase();

    //     loadUserInfo(userId);
    //     updateLastOnline(userId);
    //     loadAllDependantInfo(userId);

    //   }
		// });

    // // User Specific
    // function loadUserInfo(userId){
    //   // Tutor Id must be a phone with +60, no spacing or other chars
    //   var docRef = db.collection("Users").doc(userId);
      
    //   // docRef.get().then((doc) => {
    //   docRef.onSnapshot((doc) => {
    //     if (doc.exists) {
    //       // console.log("Document data:", doc.data());
    //       current_name = (doc.data().name == null || doc.data().name == "")? "New User" : doc.data().name;
    //       current_email = (doc.data().email == null || doc.data().email == "")? "" : doc.data().email;
    //       current_phone = (doc.data().phone == null || doc.data().phone == "")? "" : doc.data().phone; 
    //       current_imgUri = (doc.data().imgUrl == null || doc.data().imgUrl == "")? "../assets/img/empty-photo.png" : doc.data().imgUrl;
    //       current_address1= (doc.data().address1 == null || doc.data().address1 == "")? '' : doc.data().address1 + ', ';
    //       current_address2= (doc.data().address2 == null || doc.data().address2 == "")? '' : doc.data().address2 + ', '; 
    //       current_addressPostCode= (doc.data().addressPostCode == null || doc.data().addressPostCode == "")? '' : doc.data().addressPostCode + ', ';
    //       current_addressState= (doc.data().addressState == null || doc.data().addressState == "")? '' : doc.data().addressState;
    //       current_address = current_address1 + current_address2 + current_addressPostCode + current_addressState;

    //       // Set the nav user name and public profile link
    //       document.getElementById("user").textContent = doc.data().name;
    //     } 
    //     else {
    //       console.log("No user! Redirecting to login");
    //       window.location = "./login.html"
          
    //     }
    //   });
    // };

    // // Update Last Online
    // function updateLastOnline(userId){
    //   // Update last online
    //   var docRefDate = db.collection("Users").doc(userId);

    //   docRefDate.get().then((doc) => {
    //     if (doc.exists) {
    //       let docRef = db.collection("Users").doc(userId);
    //       let docRefWithMerge = docRef.set({
    //         [SYSTEM_LAST_ONLINE_KEY] : firebase.firestore.Timestamp.fromDate(new Date())
    //         }, { merge: true });
            
    //     } else {
    //         // doc.data() will be undefined in this case
    //         console.log("No such document!");
    //     }
    //   }).catch((error) => {
    //       console.log("Error getting document:", error);
    //   });
    // }

    // Tutor Specific
    function loadAllDependantInfo(userId){
      // Tutor Id must be a phone with +60, no spacing or other chars
      var docRef = db.collection("Class")
          .doc("v1")
          .collection("Dependant")
          .where("userId", "==", userId)
          .where("status", "==", true)
      
      docRef
      .get()
      .then((querySnapshot) => {

        // Session Storage data
        let docsObj = [];

        querySnapshot.forEach((doc) => {
          // console.log(doc.data())
          docsObj.push(doc.data());
          renderAllDependant(doc, false)
        });

        // Store all docs data to sessionStorage
        sessionStorage.setItem(SESSION_STORAGE_DEPENDANT_ALL_DOCS_KEY, JSON.stringify(docsObj));
        sessionStorage.setItem(SESSION_STORAGE_DEPENDANT_CURRENT_DOC_KEY, null);
      });

    };

    // Render all dependant
    function renderAllDependant(doc, renderNull){
      // <div class="col-md-12 card-student-item">
      //   <div class="row">
      //     <div class="col-md-11" >
      //       <div class="row" style="margin: 12px 0 0 0;">
      //         <div class="col-md-3">
      //           <p style="font-size: 1rem; font-weight: 400;">Alric Liew</p>
      //         </div>
      //         <div class="col-md-1 col-3">
      //           <p>Male</p>
      //         </div>
      //         <div class="col-md-2 col-9">
      //           <p>+60138252818</p>
      //         </div>
      //         <div class="col-md-2">
      //           <p>alricliew@gmail.com</p>
      //         </div>
      //         <div class="col-md-4">
      //           <p>SMK Bau</p>
      //         </div>
      //       </div>
      //     </div>
      //     <div class="col-md-1 align-self-center">
      //       <div class="row" style="margin: 12px 0 12px 8px;">
      //         <a id="btnDelStudent" href="javascript:;"  data-toggle="modal" data-target="#delStuModal" data-id="M1IODJJZencMhRDVx1gm" data-studentname="Alric Liew">
      //           <span class="fa-stack" style="vertical-align: middle; font-size: 73%; color: red; cursor: pointer;">
      //             <i class="fas fa-circle fa-stack-2x" style="text-shadow:  2px 2px 4px rgba(46, 46, 46, 0.8);" aria-hidden="true"></i>
      //             <i class="fas fa-minus fa-stack-1x fa-inverse" style="padding: 0;" aria-hidden="true"></i>
      //           </span>
      //         </a>
      //       </div>
      //     </div>
      //   </div>
      // </div>
      // Name
      let stuName_p = document.createElement('p');
      stuName_p.textContent = doc.data().childName;
      stuName_p.setAttribute("style", "font-size: 1rem; font-weight: 400;")
      let stuName_div = document.createElement('div');
      stuName_div.className = "col-md-3";
      stuName_div.appendChild(stuName_p);
      // Gender
      let gender_p = document.createElement('p');
      gender_p.textContent = (doc.data().childGender === 0) ? 'Male' : 'Female';
      let gender_div = document.createElement('div');
      gender_div.className = "col-md-1 col-3";
      gender_div.appendChild(gender_p);
      // Phone
      let phone_p = document.createElement('p');
      phone_p.textContent = doc.data().childPhone;
      let phone_div = document.createElement('div');
      phone_div.className = "col-md-2 col-9";
      phone_div.appendChild(phone_p);
      // Email
      let email_p = document.createElement('p');
      email_p.textContent = doc.data().childEmail;
      let email_div = document.createElement('div');
      email_div.className = "col-md-2";
      email_div.appendChild(email_p);
      // School
      let school_p = document.createElement('p');
      school_p.textContent = doc.data().childSchool;
      let school_div = document.createElement('div');
      school_div.className = "col-md-4";
      school_div.appendChild(school_p);

      // Dependant Detail 
      let detail_div = document.createElement('div');
      detail_div.className = 'row';
      detail_div.setAttribute("style","margin: 12px 0 0 0;");
      detail_div.appendChild(stuName_div);
      detail_div.appendChild(gender_div);
      detail_div.appendChild(phone_div);
      detail_div.appendChild(email_div);
      detail_div.appendChild(school_div);
      let detail_top_div = document.createElement('div');
      detail_top_div.className = "col-md-11";
      // detail_top_div.setAttribute("style","padding: 0;");
      // detail_top_div.setAttribute("style"," padding: 12px 0px 12px 0px;");
      detail_top_div.setAttribute("onclick","editDependantFunction(this)");
      detail_top_div.setAttribute("data-id", doc.data().id);
      detail_top_div.appendChild(detail_div);

      //Del btn
      let blogsHtml_btn = '';
      // blogsHtml_btn += "<i class='material-icons' style='color: red;''>remove</i>";
      blogsHtml_btn += "<span class='fa-stack' style='vertical-align: middle; font-size: 73%; color: red; cursor: pointer;'><i class='fas fa-circle fa-stack-2x' style='text-shadow:  2px 2px 4px rgba(46, 46, 46, 0.8);'></i><i class='fas fa-minus fa-stack-1x fa-inverse' style='padding: 0;'></i></span>";


      let btn_a = document.createElement('a');
      btn_a.innerHTML = blogsHtml_btn;
      // btn_a.className = "btn btn-sm btn-outline-danger btn-round";
      btn_a.setAttribute("id","btnDelStudent");
      btn_a.setAttribute("href","javascript:;");
      btn_a.setAttribute("style","margin: 0.1rem; padding: 0.2rem;");
      // btn_a.setAttribute("style","margin: 0; padding: 0.3em;");
      btn_a.setAttribute("data-toggle","modal");
      btn_a.setAttribute("data-target","#delStuModal");
      btn_a.setAttribute("data-id", doc.data().id);
      btn_a.setAttribute("data-studentname",  doc.data().childName);
      let btn_a_div = document.createElement('div');
      btn_a_div.setAttribute("style","margin: 12px 0 12px 8px;");
      btn_a_div.className = "row";
      btn_a_div.appendChild(btn_a);

      //
      let btn_div = document.createElement('div');
      // btn_div.setAttribute("style"," padding: 12px 0px 12px 0px;");
      btn_div.className = "col-md-1 align-self-center";
      btn_div.appendChild(btn_a_div);

 
      // Student Top
      let card_div = document.createElement('div');
      card_div.className = "row"
      card_div.appendChild(detail_top_div);
      card_div.appendChild(btn_div);

      // Card top
      let card_top_div = document.createElement('div');
      card_top_div.className = "col-md-12 card-student-item"
      card_top_div.appendChild(card_div);

      const card_all_students = document.getElementById("card-all-students");
      card_all_students.appendChild(card_top_div);
    }

    // Edit Dependant Function
    function editDependantFunction(elem){
      // Get attribute and 
      if (JSON.parse(sessionStorage.getItem(SESSION_STORAGE_DEPENDANT_ALL_DOCS_KEY)) == null ){
        console.log("Error: Impossible to reach this state");
        // Because this func only trigger when there's active class loaded
        return;
      }else{

        let Obj = null;
        let allList = null;

        // Set the fields
        allList = JSON.parse(sessionStorage.getItem(SESSION_STORAGE_DEPENDANT_ALL_DOCS_KEY));
        allList.forEach((item) => {
          if (item.id === elem.getAttribute('data-id')){
            sessionStorage.setItem(SESSION_STORAGE_DEPENDANT_CURRENT_DOC_KEY, JSON.stringify(item));
          }
            window.location = './edit-dependant.html';
        });
        
      }
		}

  </script>

  <script>
		$( document ).ready(function() {

     // Delete Modal shown
     $('#delStuModal').on('show.bs.modal', function (event) {
        let button = $(event.relatedTarget) // Button that triggered the modal
        STUDENT_ID = button.data('id') // Extract info from data-* attributes
        STUDENT_NAME = button.data('studentname') // Extract info from data-* attributes
        
        // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
        // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
        var modal = $(this)
        modal.find('.modal-title').text('Delete '+ STUDENT_NAME);
        // modal.find('#delStuId').set("value", STUDENT_ID);
        document.getElementById("delStuId").setAttribute('value', STUDENT_ID);
      });
      // Delete confirm button clicked
      $('#btnDelStuModalUpdate').on('click', function (e) {
        let depId = document.getElementById("delStuId").getAttribute('value');

        var docRef = db.collection("Class")
          .doc("v1")
          .collection("Dependant")
          .doc(depId);

        let data = {
          [DEP_DATE_DEL]: new Date(),
          [DEP_STATUS]: false,
        }  
        // console.log(data);

        var docRefWithMerge = docRef.set(data , { merge: true })
        .then(() => {
          window.location.href = "./";
        }).catch((error) => {
          console.log("Error getting document:", error);
        });

      
      });

      $('#btnSignOutModalUpdate').on('click', function (e) {
        firebase.auth().signOut().then(() => {
            // Sign-out successful.
          }).catch((error) => {
            func.showNotification('top','center', 'danger', 'error_outline', "Logging out failed." );
          });
      });

    });

  </script>
 
</body>

</html>