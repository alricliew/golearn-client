<!doctype html>
<html lang="en">

<head>
  <title>GoLearn School</title>
  <!-- Meta -->
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  <title>GoLearn School</title>
  <meta name=description content="GoLearn School&trade; is Malaysia #1 teaching platform to run your tuition business and manage your lessons. Start now for Free!">
  <meta property=og:title content="GoLearn School">
  <meta property=og:site_name content="GoLearn School">
  <meta property=og:type content=website>
  <meta property=og:url content=https://app.golearn.com.my/school/course/manage.html>
  <meta property=og:image content=https://app.golearn.com.my/assets/img/icon-apple-touch-180x180.png>
  <meta property=og:description content="GoLearn School&trade; is Malaysia #1 teaching platform to run your tuition business and manage your lessons. Start now for Free!">
  <link rel=apple-touch-icon sizes=180x180 href=https://app.golearn.com.my/assets/img/icon-apple-touch-180x180.png>
  <link rel=icon type=image/png sizes=32x32 href=https://app.golearn.com.my/assets/img/icon-32x32.png>
  <link rel=icon type=image/png sizes=16x16 href=https://app.golearn.com.my/assets/img/icon-16x16.png>
  <!-- Fonts and icons  -->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <script src="https://kit.fontawesome.com/2bdd669e92.js" crossorigin="anonymous"></script>
  <!-- Material Kit CSS -->
  <link href="../../assets/css/material-dashboard.css?v=2.1.2" rel="stylesheet"/>
  <!-- Firebase Init -->
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-storage.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.4.1/firebase-firestore.js"></script>
  <script src="../../assets/js/firebase.js"></script>
  <!-- Tutor Portal specific CSS -->
  <link href="../../assets/css/tutor-portal.css" rel="stylesheet" />
  <link href="../../assets/css/multitabform.css" rel="stylesheet" />
  <link href="../../assets/css/multistepform.css" rel="stylesheet" />
  <!-- ClockPicker Stylesheet -->
  <link href="../../assets/css/bootstrap-clockpicker.min.css" rel="stylesheet" type="text/css">
  <!-- TinyMce -->
  <script src="../../assets/js/plugins/tinymce/tinymce.min.js" type="text/javascript"></script>
  <!-- Tinymce init -->
  <script>
    function initTinyMCE(){

      tinymce.init({
        mode : "exact",
        selector:'.detail',
        plugins: 'lists paste',
        menubar:false,
        toolbar: 'bold italic | bullist numlist',
        max_chars: 400,
        setup: function (editor) {
          var allowedKeys = [8, 13, 16, 17, 18, 20, 33, 34, 35, 36, 37, 38, 39, 40, 46];
          editor.on('keydown', function (e) {

            // console.log(tinymce_getContentLength());
            // Disable confirmation button
            if (tinymce_getContentLength() > 1) {
              document.getElementById('btnaddLessonDetailDescModalUpdate').removeAttribute("disabled")            
            }else {
              document.getElementById('btnaddLessonDetailDescModalUpdate').setAttribute("disabled", true)            
            }

            // lessonDetailDescOnChangeHandler();

            if (allowedKeys.indexOf(e.keyCode) != -1){
              return true;
            }
            if (tinymce_getContentLength() + 1 > this.settings.max_chars) {
              func.showNotification('top','center', 'warning', 'error_outline', 'You have reach maximum allowed number of ' + editor.settings.max_chars + ' characters.' );
              e.preventDefault();
              e.stopPropagation();
              return false;
            }
            
            return true;
          });
 
          editor.on('keyup', function (e) {

            lessonDetailDescOnChangeHandler(e);
          });
        },
        paste_preprocess: function (plugin, args) {
      
          var editor = tinymce.get(tinymce.activeEditor.id);
          var len = editor.contentDocument.body.innerText.length;
          var text = $(args.content).text();
          if (len + text.length > editor.settings.max_chars) {
              func.showNotification('top','center', 'warning', 'error_outline', 'Pasting this exceeds the maximum allowed number of ' + editor.settings.max_chars + ' characters.' );
              args.content = '';
          } else {

          }
        },

      });

      function tinymce_getContentLength() {
        return tinymce.get(tinymce.activeEditor.id).contentDocument.body.innerText.length;
      }

      // Rich Text Editor
      function lessonDetailDescOnChangeHandler() {
        // alert("Some one modified something");
        // alert("The HTML is now:" + inst.getBody().innerHTML);

        // let invNotesContent = tinymce.get("invNotes").getContent({ format: "text" });
        // document.getElementById("countNotes").textContent = invNotesContent.length + '/400';

      }

      function lessonDetailDescOnChangeHandler(inst) {

        // let invFooterNotesContent = tinymce.get("invFooterNotes").getContent({ format: "text" });
        // document.getElementById("countFooterNotes").textContent = invFooterNotesContent.length + '/400';

      }


    }
  </script>
  
  <!-- Switch -->
  <style>
    .switch {
      position: relative;
      display: inline-block;
      width: 40px;
      height: 24px;
      vertical-align: middle;
      margin: 0;
    }

    /* Hide default HTML checkbox */
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    /* The slider */
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      -webkit-transition: .4s;
      transition: .4s;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      -webkit-transition: .4s;
      transition: .4s;
    }

    input:checked + .slider {
      background-color: #2e74b6;
    }

    input:focus + .slider {
      box-shadow: 0 0 1px #2e74b6;
    }

    input:checked + .slider:before {
      -webkit-transform: translateX(16px);
      -ms-transform: translateX(16px);
      transform: translateX(16px);
    }

    /* Rounded sliders */
    .slider.round {
      border-radius: 20px;
    }

    .slider.round:before {
      border-radius: 50%;
    }

    select>option:hover
    {
        color: #1B517E;
        cursor: pointer;
    }
  </style>
  <!-- Obj Table -->
  <style>
    .table {
      border: 1px solid #ccc;
      border-collapse: collapse;
    }
    .table th,
    .table td {
        border: 1px solid #ccc;
    }
    .table th,
    .table td {
        padding: 0.5rem;
    }
    .draggable {
        cursor: move;
        user-select: none;
    }
    .placeholder {
        background-color: #edf2f7;
        border: 2px dashed #cbd5e0;
    }
    .clone-list {
        /* border-top: 1px solid #ccc; */
    }
    .clone-table {
        border-collapse: collapse;
        border: none;
    }
    .clone-table th{
        border: 1px solid #ccc;
        border-top: none;
        padding: 0.5rem;
        font-size: 1.2em;
        font-weight: 300;
    }

    .clone-table td {
        border: 1px solid #ccc;
        border-top: none;
        padding: 0.5rem;

        font-weight: 300;
    }
    .dragging {
        background: #fff;
        /* border-top: 1px solid #ccc; */
        z-index: 999;
    }
  </style>
   <!-- Card Loading -->
   <style>

    .br {
      border-radius: 8px;  
    }
    .w30 {
      width: 30%;
    }
    .w50 {
      width: 50%;
    }
    .w80 {
      width: 80%;
    }
    .card {
      border: 2px solid #fff;
      /* box-shadow:0px 0px 10px 0 #a9a9a9; */
      padding: 12px 20px;
      /* width: 80%; */
      /* margin: 50px auto; */
      margin-top: 0.2rem;
    }
    .card-shimmer-wrapper {
      width: 0px;
      animation: fullView 0.5s forwards cubic-bezier(0.250, 0.460, 0.450, 0.940);
    }
    .profilePic {
      height: 60px;
      width: 60px;
      border-radius: 50%;
    }
    .comment {
      height: 10px;
      background: #777;
      margin-top: 15px;
    }

    @keyframes fullView {
      100% {
        width: 100%;
      }
    }

    .animate {
      animation : shimmer 2s infinite linear;
      background: linear-gradient(to right, #eff1f3 4%, #e2e2e2 25%, #eff1f3 36%);
        background-size: 1000px 100%;
    }

    @keyframes shimmer {
      0% {
        background-position: -1000px 0;
      }
      100% {
        background-position: 1000px 0;
      }
    }
  </style>
  <!-- Screen Loading -->
  <style>
    @keyframes load {
      50% {
        transform: translateY(1.5em);
      }
    }
    .loading {
      /* margin: 4em auto; */
      position: absolute;
      /* width: 5em; */
      top: 40%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1;
      background: rgba(255, 255, 255, 0.137);

    }
    .loading > div, .loading:before, .loading:after {
      animation: load 1.2s ease-in-out infinite;
      background-color: rgb(211, 211, 211);
      border-radius: 50%;
      content: '';
      height: 1em;
      width: 1em;
    }
    .loading > div {
      animation-delay: 0.2s;
      left: 0;
      position: absolute;
    }
    .loading:before {
      left: -2em;
      position: absolute;
    }
    .loading:after {
      animation-delay: 0.4s;
      left: 2em;
      position: absolute;
    }
  </style>

</head>

<body>

  <div class="wrapper ">
    <div class="sidebar" data-color="purple" data-background-color="white" data-image="../../assets/img/sidebar-3.jpg">
      <div class="logo">
        <a href="../" class="simple-text logo-mini" style="padding: 0.5rem">
			    <img src="../../assets/img/golearn-school-logo.svg" style="width: 200px; height: auto;" alt=""></img>
        </a>
      </div>
      <div class="sidebar-wrapper">
        <ul class="nav" style="margin-bottom: 50px;">
          <li class="nav-item">
            <a class="nav-link" href="../">
              <i class="far fa-chart-bar fa-fw nav-icon"></i>
              <p>Dashboard</p>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../report/">
              <i class="far fa-lightbulb fa-fw nav-icon"></i>
              <p>Insight</p>
            </a>
          </li>
          <li class="nav-item">
            <h4 class="nav-link" style="margin-left: 1rem;">Teaching</h4>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../class/">
              <i class="fas fa-chalkboard fa-fw nav-icon"></i>
              <p>Classes</p>
            </a>
          </li>
		  		<li class="nav-item">
            <a class="nav-link" href="../student/">
              <i class="fas fa-user-graduate fa-fw nav-icon"></i>
              <p>Students</p>
            </a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="../teacher/">
              <i class="fas fa-chalkboard-teacher fa-fw nav-icon"></i>
              <p>Teachers</p>
            </a>
          </li>
          <li class="nav-item">
            <h4 class="nav-link" style="margin-left: 1rem;">Financial</h4>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../invoice/">
              <i class="fas fa-file-invoice-dollar fa-fw nav-icon"></i>
              <p>Invoices</p>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="../salary/">
              <i class="fas fa-money-bill-wave fa-fw nav-icon"></i>
              <p>Salaries</p>
            </a>
          </li>
          <li class="nav-item" id="navPayroll" style="display: none;">
            <a class="nav-link" href="../payroll/">
              <i class="fas fa-hand-holding-usd fa-fw nav-icon"></i>
              <p>Payroll <span style="visibility: hidden;">PRO</span></p>
            </a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="../transaction/">
              <i class="fas fa-exchange-alt fa-fw nav-icon"></i>
              <p>Transactions</p>
            </a>
          </li>
          <li class="nav-item">
            <h4 class="nav-link" style="margin-left: 1rem;">Public</h4>
          </li>
          <li class="nav-item active">
            <a class="nav-link" href="./">
              <i class="fas fa-book-open fa-fw nav-icon"></i>
              <p>My Public Courses 
                <span style="background-color: #2e74b6;padding: 0.2em 0.5em 0.2em 0.5em;color: white;border-radius: 3px;font-size: x-small;">New</span>
              </p>
            </a>
          </li>
		  		<li class="nav-item">
            <a class="nav-link" href="../job/">
              <i class="fas fa-briefcase fa-fw nav-icon"></i>
              <p>Tuition Jobs</p>
            </a>
          </li>
          <li class="nav-item ">
            <a class="nav-link" href="../settings/">
              <i class="fas fa-user-cog fa-fw nav-icon"></i>
              <p>Update Information</p>
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="main-panel">
      <!-- Navbar -->
      <nav class="navbar navbar-expand-lg navbar-transparent navbar-absolute fixed-top ">
        <div class="container-fluid">
          <div class="navbar-wrapper">
            <a class="navbar-brand" href="javascript:;">Courses <span><i class="material-icons" style="color: gray;">chevron_right</i></span> Manage</a>
          </div>
          <button class="navbar-toggler" type="button" data-toggle="collapse" aria-controls="navigation-index" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="navbar-toggler-icon icon-bar"></span>
            <span class="navbar-toggler-icon icon-bar"></span>
            <span class="navbar-toggler-icon icon-bar"></span>
          </button>
          <div class="collapse navbar-collapse justify-content-end">
            <form class="navbar-form">
              <!-- Put empty placeholder here -->
            </form>

            <ul class="navbar-nav">
              <li class="nav-item" id="activationNavItem">
                <a href="#" class="btn btn-primary btn-round btn-sm" style="visibility: hidden;" id="btnActivateAccount"></a>
              </li>
              <li class="nav-item">
                <a class="navbar-brand" href="javascript:;">
                   Hi <span id="user"></span> !
                </a> 
              </li>
              <li class="nav-item dropdown">
                <a class="nav-link" href="javascript:;" id="navbarDropdownNotification" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <i class="material-icons">notifications</i> Notifications
                </a>
                <!-- <a class="nav-link" href="http://example.com" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <i class="material-icons">notifications</i>
                  <span class="notification">5</span>
                  <p class="d-lg-none d-md-block">
                    Some Actions
                  </p>
                </a> -->
								<div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">
									<p style="padding: 1em;" >No notification</p>
                  <!-- <a class="dropdown-item" href="#">Mike John responded to your email</a>
                  <a class="dropdown-item" href="#">You have 5 new tasks</a>
                  <a class="dropdown-item" href="#">You're now friend with Andrew</a>
                  <a class="dropdown-item" href="#">Another Notification</a>
                  <a class="dropdown-item" href="#">Another One</a> -->
                </div>
              </li>
              <!-- your navbar here -->
			  
			  			<li class="nav-item dropdown">
                <a class="nav-link" href="javascript:;" id="navbarDropdownProfile" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <i class="material-icons">person</i>
                  <p class="d-lg-none d-md-block">
                    Account
                  </p>
                </a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownProfile">
                  <a class="dropdown-item" href="../edit-profile.html">Edit Profile</a>
                  <a id="navPublicProfile" class="dropdown-item" href="#">My Public Profile</a>
									<a class="display:block; dropdown-item" href="../about.html">About</a>
									<div class="dropdown-divider"></div>
                  <a class="dropdown-item" href="javascript:;" data-toggle="modal" data-target="#signOutModal" id="btn-logout">Log out</a>
									<div class="dropdown-divider"></div>
									<a style="font-weight: 500 ;padding: 0.5em ;text-align: center; width: 200px; background-color: #428dd4 ;display: block; color: #fff;" href="https://golearn.com.my/pricing/" target="_blank" id="btnUpgradeToPro">Upgrade to Pro</a>

                </div>
              </li>
            </ul>
          </div>
        </div>
      </nav>
      <!-- End Navbar -->

			<!-- Modal Start -->

      <!-- Course Status Toggle modal -->
      <div class="row">
        <div class="modal fade" id="statusToggleModal" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="statusToggletModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="statusToggleLabel">
                  <!-- Activate Course? -->
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"  id="btnStatusToggleModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <div id="courseStatusAction" value=""></div>
                <p id="inCourseStatusToggleMessage">
                  <!-- Are you sure you want to continue? -->
                </p>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnStatusToggleModalClose2">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnStatusToggleModalUpdate">Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Unlink Class modal -->
      <div class="row">
        <div class="modal fade" id="unlinkModal" tabindex="-1" role="dialog" aria-labelledby="unlinkModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Unlink From This Class?</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" >
                Are you sure you want to continue?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnUnlinkModalUpdate">Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Link Class - List Admins's Class modal -->
      <div class="row">
        <div class="modal fade" id="addClassModal" tabindex="-1" role="dialog" aria-labelledby="addClassModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered modal-lg" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="addClassModalLabel">My Classes</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnAddClassModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="addClassModalBody">
                <div class="row">
                  <div class="col-md-12" id="studentTop">
                          
                    <div class="container" id="add-tutor-modal-container">
                      <!-- Tutor header -->
                      <div class="row lesson-header">
                        <div class="col-md-1">
                        </div>
                        <div class="col-md-6">
                          <p>Class Name</p>
                        </div>
                        <div class="col-md-3">
                          <p>Teacher(s)</p>
                        </div>
                        <div class="col-md-2">
                          <p>Action</p> 
                        </div>
                      </div>
   
                      <!-- Loading block -->
                      <div class="row">
                        <div class="card br" id="card-load" style="margin: auto 0;">
                          <div class="card-shimmer-wrapper">
                            <div class="row">
                              <div class="col-md-1 col-3">
                                <div class="profilePic animate din"></div>
                              </div>
                              <div class="col-md-11 col-9">
                                <div class="comment br animate w80"></div>
                                <div class="comment br animate w30"></div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
        

                      <!-- No data placeholder -->
                      <div class="row text-center" style="display: none; margin: 1rem;" id="noDataPlaceholder">
                        <p>No data</p>
                      </div>

                      <!-- Tutor List Start -->
                      <!-- <div class="row tutor-wrapper">
                        <div class="col-md-1">
                          <div style="height: 50px; width: 50px; display: inline-block; position: relative; overflow: hidden; border-radius: 50%;">
                            <img id="viewTutorImgUrl" style="height: 100%;width: 100%; object-fit: cover;" src="../../assets/img/empty-photo.png"/>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <p class="tutor-item">Y3 English Class</p>
                        </div>
                        <div class="col-md-3">
                          <p class="tutor-item">Alric Liew </p>
                        </div>
                        <div class="col-md-2">
                          <button type="button" class="btn btn-primary btn-sm" data-dismiss="modal" id="btnSelectTutor">Select</button>
                        </div>
                      </div> -->

   
                    </div>

                  </div>
                </div>

                <!-- Load More -->
                <div class="row">
                  <div class="col-md-12" style="margin-top: 1rem;">
                    <a href="javascript:;" class="btn btn-outline-primary btn-round btn-sm" id="btnClassLoadMore">Load More <i class="material-icons" style="color: #2e74b6; margin-left: 0.5em; padding-bottom: 0.2em;">expand_more</i></a>
                  </div>
                </div>

              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary"  data-dismiss="modal" id="btnAddClassModalClose2">Close</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Add Lesson Detail Embed Media -->
      <div class="row">
        <div class="modal fade" id="addLessonDetailEmbedModal" tabindex="-1" role="dialog" aria-labelledby="addLessonDetailEmbedModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="addLessonDetailEmbedModalTitle">
                  Add Embeded Media 
                  <i class="fas fa-video" style="margin-left: 12px;"></i>
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnaddLessonDetailEmbedModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">

                <div id="inLessonDetailEmbedId" value=""></div>

                <div class="row">
                  <div class="col-md-12">
                    <div class="form-group">
                      <textarea type="text" class="form-control" id="inLessonDetailEmbed" rows="5"></textarea>
                    </div>
                    <p id="inLessonDetailEmbedValid" style="color: red;"></p>

                    <div>
                      <a href="https://support.google.com/youtube/answer/171780" target="_blank" style="font-size: small;">Example: Embed a Youtube video or playlist</a>
                    </div>
                    <div>
                      <a href="https://vimeo.zendesk.com/hc/en-us/articles/224969968-Embedding-videos-overview" target="_blank" style="font-size: small;">Example: Embed a Vimeo video</a>
                    </div>
                  </div>
                </div>

              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnaddLessonDetailEmbedModalClose2">Not Now</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnaddLessonDetailEmbedModalUpdate" disabled>Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Add Lesson Detail Resource Link -->
      <div class="row">
        <div class="modal fade" id="addLessonDetailResourceModal" tabindex="-1" role="dialog" aria-labelledby="addLessonDetailResourceModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="addLessonDetailResourceModalTitle">Add resource link 
                  <i class="fas fa-link" style="margin-left: 12px;"></i>
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnaddLessonDetailResourceModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="addLessonDetailResourceModalBody">

                <div id="inLessonDetailResourceId" value=""></div>

                <div class="row">
                  <div class="col-md-12">
                    <div class="form-group">
                      <input type="text" class="form-control" id="inLessonDetailResource">
                    </div>
                  </div>
                </div>
                <p id="inLessonDetailResourceValid" style="color: red;"></p>

              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnaddLessonDetailResourceModalClose2">Not Now</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnaddLessonDetailResourceModalUpdate" disabled>Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Add Lesson Detail Description -->
      <div class="row">
        <div class="modal fade" id="addLessonDetailDescModal" tabindex="-1" role="dialog" aria-labelledby="addLessonDetailDescModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="addLessonDetailDescModalTitle">
                  Add Description
                </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnaddLessonDetailDescModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">

                <div id="inLessonDetailDescId" value=""></div>

                <div class="row">
                  <div class="col-md-12">
                    <div class="form-group">
                      <textarea id="inLessonDetailDesc" class="detail"></textarea>
                    </div>
                    
                  </div>
                </div>

              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnaddLessonDetailDescModalClose2">Not Now</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnaddLessonDetailDescModalUpdate" disabled>Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Remove Lesson Detail modal -->
      <div class="row">
        <div class="modal fade" id="removeLessonDetailModal" tabindex="-1" role="dialog" aria-labelledby="removeLessonDetailModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Remove <span id="removeLessonDetailModalTitle"></span></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <div id="removeLessonDetailId" value=""></div>
                <div id="removeLessonDetailType" value=""></div>

                Are you sure you want to continue?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnRemoveLessonDetaillUpdate">Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Edit Item's Title -->
      <div class="row">
        <div class="modal fade" id="editTitleModal" tabindex="-1" role="dialog" aria-labelledby="editTitleModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="editTitleModalTitle">Edit Title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnEditTitleModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="editTitleModalBody">

                <div id="inItemId" value=""></div>
                <div id="inItemName" value=""></div>

                <div class="row">
                  <div class="col-md-12">
                    <div class="form-group">
                      <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Item Title* <span id="countName" style="color: grey; margin-left: 1rem;">0/80</span></span> 
                      <textarea type="text" class="form-control" id="inItemTitle" maxlength="80"></textarea>
                    </div>
                  </div>
        
                </div>

              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnEditTitleModalClose2">Not Now</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnEditTitleModalUpdate">Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Delete Course modal -->
      <div class="row">
        <div class="modal fade" id="delCourseModal" tabindex="-1" role="dialog" aria-labelledby="delCourseModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="delCourseModalLabel">Are you absolutely sure? </h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btndelCourseModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="delCourseModalBody">
                <p>This action cannot be <strong style="color: red;">undone</strong>. This will permanently unpublish your course, delete the course details and remove all the reviews from your clients.</p>
                <p>You will be prevented from creating a similar course for 6 months.</p>
                <p>If you still want to keep this course but hide it from the public, you may <strong style="color: #2e74b6 ;">uncheck</strong> Course Status.</p> 
              
                <p>Please type <strong>DELETE</strong> to confirm.</p>

                <input type="text" class="form-control" id="delCourseModalIn">


              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-dismiss="modal" id="btndelCourseModalUpdate" style="white-space: normal; word-wrap: break-word;" disabled>I understand the consequences. Delete this course.</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Earning Full Report modal -->
      <!-- Added style="overflow-y:scroll;" to make it scrollable -->
      <div class="row">
        <div class="modal fade" style="overflow-y:scroll;" id="earningFullReportModal" tabindex="-1" role="dialog" aria-labelledby="earningFullReportModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered modal-lg" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="earningFullReportLabel">Full Earning Estimation</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnEarningFullReportModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="earningFullReportModalBody">
                <div class="row">
                  <div class="col-md-4">
                    <h4>General Notes</h4>
                    <p>1. The estimation is based on your current settings. In real case, your clients/parents may have their own request.</p>
                    <p>2. If "<strong>Per Hour</strong>" fee type is chosen, the monthly tuition fee displayed on your public profile will have default calculation based on 2 hours per class, 1 class per week and 4 weeks in a month</p>

                  </div>
                  <div class="col-md-8">
                    <h4>Earning Estimation</h4>
                    <div class="row">
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p>Number of Month</p>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p>% You Earn</p>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p >You Earn</p>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p>1st Month</p>
                        </div>                      
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_comm1">0.0%</p>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_fee1">RM0.00</p>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p>2nd Month</p>
                        </div>                      
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_comm2">0.0%</p>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_fee2">RM0.00</p>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p>3rd Month</p>
                        </div>                      
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_comm3">0.0%</p>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_fee3">RM0.00</p>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p>4th Month</p>
                        </div>                      
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_comm4">0.0%</p>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_fee4">RM0.00</p>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p>5th Month</p>
                        </div>                      
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_comm5">0.0%</p>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_fee5">RM0.00</p>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p>6th Month</p>
                        </div>                      
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_comm6">0.0%</p>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_fee6">RM0.00</p>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p>7th Month</p>
                        </div>                      
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_comm7">0.0%</p>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_fee7">RM0.00</p>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p>8th Month</p>
                        </div>                      
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_comm8">0.0%</p>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_fee8">RM0.00</p>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p>9th Month</p>
                        </div>                      
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_comm9">0.0%</p>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_fee9">RM0.00</p>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p>10th Month Onward</p>
                        </div>                      
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_comm10">0.0%</p>
                        </div>
                      </div>
                      <div class="col-md-4">
                        <div class="d-flex justify-content-center">
                          <p style="color: green;" id="modal_fee10">RM0.00</p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnEarningFullReportModalClose2">Okay</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Online Only Info modal -->
      <div class="row">
        <div class="modal fade" id="onlineOnlyInfoModal" tabindex="-1" role="dialog" aria-labelledby="onlineOnlyInfoModalLabel" aria-hidden="true">
          <div class="modal-dialog   modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="onlineOnlyInfoLabel">What does "Online Only" mean?</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnOnlineOnlyInfoModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="onlineOnlyInfoModalBody">
                Checking this option means this course will appear if someone is searching for <strong>Online Only</strong> classes. To ensure it appears at your "Update Information -> <strong>Preferred Area</strong>", create another course with this option <strong>unchecked</strong>.
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnOnlineOnlyInfoModalClose2">Edit Preferred Area</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnOnlineOnlyInfoModalClose2">Okay</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Create Course modal -->
      <div class="row">
        <div class="modal fade" id="createCourseModal" tabindex="-1" role="dialog" aria-labelledby="createCourseModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="createCourseLabel">Creating a new course ...</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="btnCreateCourseModalClose1">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="createCourseModalBody">
                Are you sure you want to continue?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id="btnCreateCourseModalClose2">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnCreateCourseModalUpdate">Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Save modal -->
      <div class="row">
        <div class="modal fade" id="saveModal" tabindex="-1" role="dialog" aria-labelledby="saveModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="saveLabel">Save</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="saveModalBody">
                Are you sure you want to continue?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnSaveModalUpdate">Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Publish modal -->
      <div class="row">
      <div class="modal fade" id="publishModal" tabindex="-1" role="dialog" aria-labelledby="publishModalLabel" aria-hidden="true">
        <div class="modal-dialog  modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="publishLabel">Publish Your Course</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body" id="publishModalBody">
              <p>
                Satisfied with your course design? Publish it now! <br>
              </p>
              <p style="font-style: italic;">
                It could take up to 48 hours for review before fully going public. 
              </p>
             
              Are you sure you want to continue?
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
              <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnPublishModalUpdate">Confirm</button>
            </div>
          </div>
        </div>
      </div>
      </div>

      <!-- Suspended modal -->
      <div class="row">
        <div class="modal fade" id="suspendedModal" tabindex="-1" role="dialog" aria-labelledby="suspendedModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Important</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <p>We detected violations against our policies. This course had been removed from the public.</p>
                <p id="courseAdminMessage">

                </p>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <a href="https://golearn.com.my/contact-us" target="_blank" class="btn btn-primary">Contact Us</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Loading Screen -->
      <div class="loading" id="loadingScreen">
        <div></div>
      </div>

      <!-- Sign-out modal -->
      <div class="row">
        <div class="modal fade" id="signOutModal" tabindex="-1" role="dialog" aria-labelledby="signOutModalLabel" aria-hidden="true">
          <div class="modal-dialog  modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="signOutLabel">Logging Out</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body" id="signOutModalBody">
                Are you sure you want to continue?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" id="btnSignOutModalUpdate">Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="container overflow-hidden">

          
          <!-- Back button -->
          <div class="row d-flex">
            <div class="p-2" style="padding: 0 8px 8px 0!important;">
              <a href="./" class="btn btn-outline-primary btn-round" id="btnBack"><i class="material-icons" style="color: #2e74b6; margin-right: 0.5em;  padding-bottom: 0.2em;">west</i> Back</a>
            </div>
            <div class="p-2" style="padding: 0 8px 8px 0!important;">
              <button type="button" class="btn btn-outline-primary btn-round" style="background: #2e74b6; color: #ffffff; " disabled data-toggle="modal" data-target="#saveModal" id="btnSave"><i class="material-icons" style=" margin-right: 0.5em;  padding-bottom: 0.2em;">save</i> Save</button>
            </div>
            <div class="ml-auto p-2" style="padding: 0 0 8px 0!important; display: none;" id="btnPublishDiv">
              <button class="btn btn-success btn-round" data-toggle="modal" data-target="#publishModal" id="btnPublish">Publish</button>
            </div>
            <div class="ml-auto p-2" style="padding: 0 8px 8px 0!important; display: none;" id="btnSuspendedDiv">
              <button class="btn btn-danger btn-round" data-toggle="modal" data-target="#suspendedModal">Important</button>
            </div>
          </div>

          <div class="row">
            <div class="col-md-12">
              <!--multitabs-form navbar-->
              <div class="row" >
                <div class="col-12 col-lg-12 ml-auto mr-auto mb-4">
                  <div class="d-flex flex-wrap multitabs-form__progress">
                    <button class="multitabs-form__progress-btn js-active" type="button" title="General">General</button>
                    <button class="multitabs-form__progress-btn" type="button" title="Content">Content</button>
                    <button class="multitabs-form__progress-btn" type="button" title="Pricing">Pricing</button>
                    <button class="multitabs-form__progress-btn" type="button" title="Advanced">Advanced</button>

                  </div>
                </div>
              </div>

              <!--multitabs-form-->
              <div class="multitabs-form" id="multitabs_form">
                <div class="row">
                  <div class="col-12">
                    <form class="multitabs-form__form">
                      <!-- General form-->
                      <div class="multitabs-form__panel shadow p-4 rounded bg-white js-active" data-animation="scaleIn">
                        <h6 style="float:right; position: relative;" name="subject" ></h6>
                        <h4 class="multitabs-form__title" style="display: inline;">Course details</h4>

                        <div class="multitabs-form__content">
                          <!-- Details -->
                          <div style="margin-top: 1rem;"></div>
                          <div class="row">
                            <div class="col-md-12">

                              <div class="form-group" style="margin-top: 1rem;">
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Course Name* <span id="countCourseName" style="color: grey; margin-left: 1rem;">0/80</span></span> 
                                <input type="text" class="form-control" id="inCourseName" data-compulsory="true" oninput="this.className = 'form-control'" maxlength="80">
                              </div>
        
                              <div class="form-group" style="margin-top: 1.5rem;" >
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Course Description <span id="countCourseDesc" style="color: grey; margin-left: 1rem;">0/400</span></span> 
                                <textarea class="form-control" maxlength="400" rows="4" id="inCourseDesc" data-compulsory="false"></textarea>
                              </div>

                            </div>

                          </div>
                            
                          <!-- What students will learn? -->
                          <div style="margin-top: 2rem;"></div>
                          <div class="row">
                            <div class="col-md-12">
                              <h4>What students will learn?
                                <span class="tooltiptext-trigger">? 
                                  <span class="tooltiptext-general">
                                    <h6>What students will learn?</h6>
                                    <p>You must include at least <strong style="color: #2e74b6;">4 learning objectives or outcomes</strong> that students can expect to achieve after joining your course.</p>
                                  </span> 
                                </span>
                              </h4>
              
                            </div>
          
                          </div>

                          <div class="row">
                            <div class="col-12" id="table-top" style="overflow-x:auto; padding: 0">
                              <div class="row table-item-top">
                                <div class="col-md-12 table-item" >

                                  <table id="tableObj" class="table-light table-sm" cellspacing="0" width="100%">
                                    <thead>
                                      <tr>
                                        <th style="width: 25px; min-width: 25px;"></th>
                                        <th class="th-item"></th>
                                        <th class="th-action"></th>
                                      </tr>
                                    </thead>
                                    <tbody style="border-bottom: solid thin #eeeeee;">
                                      <tr class="item">
                                        <td><i class="fas fa-grip-vertical"></i></td>
                                        <td><input type="text" class="form-control" placeholder=" Example: Learn the full marks scoring tips for short questions" maxlength="160" data-compulsory="true" oninput="this.className = 'form-control'"></td>
                                      </tr>
                                      <tr class="item">
                                        <td><i class="fas fa-grip-vertical"></i></td>
                                        <td><input type="text" class="form-control" placeholder=" Example: Score essay with examiner recommended techniques" maxlength="160" data-compulsory="true" oninput="this.className = 'form-control'"  ></td>
                                      </tr>
                                      <tr class="item">
                                        <td><i class="fas fa-grip-vertical"></i></td>
                                        <td><input type="text" class="form-control" placeholder=" Example: Learn how to write an excellent summary" maxlength="160" data-compulsory="true" oninput="this.className = 'form-control'" ></td>
                                      </tr>
                                      <tr class="item">
                                        <td><i class="fas fa-grip-vertical"></i></td>
                                        <td><input type="text" class="form-control" placeholder=" Example: Get the perfect writings opening and closing" maxlength="160" data-compulsory="true" oninput="this.className = 'form-control'" ></td>
                                      </tr>
                                    </tbody>
                                  </table>
                                </div>

                                <div class="col-12">
                                  <a class="btn btn-sm btn-outline-primary btn-round" style="text-transform: none;" onclick="addRow();"><i class="material-icons" style="color: #2e74b6;">add</i></a>
                                </div>

                              </div>

                              
      
                            </div>

                          </div>

                          <!-- Timeslot -->
                          <div style="margin-top: 2rem;"></div>
                          <h4>Time slots</h4>
                          <div class="row">
                            <div class="col-md-12" id="timeSlotTop">
                            
                              <div class="container" id="timeSlot-container">
                                <div class="row" style="padding: 0rem 3rem 0rem 0rem; border: solid #2e74b6; border-width: thin; margin-top: 1rem;" id="timeSlot-1">
                                  
                                  <div class="col-md-5">
                                    <div class="form-group">
                                      <span class="" style="font-size: smaller; font-weight: 300; color: gray;">Day of Week*</span> 
                                      <select class="form-control" name="tutor_course[]" id="inDayOfWeek1" data-compulsory="true" oninput="this.className = 'form-control'">
                                        <option value="">Select Day Of Week</option>
                                        <option value="mon">Monday</option>
                                        <option value="tue">Tuesday</option>
                                        <option value="wed">Wednesday</option>
                                        <option value="thu">Thursday</option>
                                        <option value="fri">Friday</option>
                                        <option value="sat">Saturday</option>
                                        <option value="sun">Sunday</option>
                                      </select>
                                    </div>
                                  </div>
                                  <div class="col-md-3">
                                    <div class="form-group"  >
                                      <span class="" style="font-size: smaller; font-weight: 300; color: gray;">Start Time*</span> 
                                      <div class="input-group clockpicker" data-placement="bottom" data-align="top" data-autoclose="true" style="margin-top: 0.3rem;">
                                        <input id="inStartTime1" type="text" class="form-control" value="" data-compulsory="true" oninput="this.className = 'form-control'" style="cursor: not-allowed; pointer-events: none;">
                                        <span class="d-flex align-items-center input-group-addon">
                                          <span class="material-icons">
                                            more_time
                                          </span>
                                        </span>
                                      </div>  
                                    </div>
                                  </div>
                                  <div class="col-md-3">
                                    <div class="form-group">
                                      <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">End Time*</span> 
                                      <div class="input-group clockpicker" data-placement="bottom" data-align="top" data-autoclose="true" style="margin-top: 0.3rem;">
                                        <input id="inEndTime1" type="text" class="form-control" value="" data-compulsory="true" oninput="this.className = 'form-control'" style="cursor: not-allowed; pointer-events: none;">
                                        <span class="d-flex align-items-center input-group-addon">
                                          <span class="material-icons">
                                            more_time
                                          </span>
                                        </span>
                                      </div>  
                                    </div>
                                  </div>
                    
                                </div>

                              </div>
                            </div>

                            <div class="col-lg-4 col-md-4 col-sm-4">
                              <a class="btn btn-sm btn-outline-primary btn-round" id="btnAddTimeSlot"><i class="material-icons" style="color: #2e74b6;">add</i></a>
                            </div>

                          </div>

                          <!-- Language -->
                          <div style="margin-top: 2rem;"></div>
                          <h4>Language(s) you use in this course</h4>
                          <div class="row">
                            <div class="col-md-12">
                            
                              <div class="form-check" style="margin-top: 1.0rem;">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="checkbox" value="" id="lanEng">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  English
                                </label>
                              </div>
                              <div class="form-check" style="margin-top: 1.0rem;">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="checkbox" value="" id="lanBm">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  Bahasa Melayu
                                </label>
                              </div>
                              
                              <div class="form-check" style="margin-top: 1.0rem;">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="checkbox" value="" id="lanBc">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  Mandarin
                                </label>
                              </div>
                              <div class="form-check" style="margin-top: 1.0rem;">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="checkbox" value="" id="lanBt">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  Tamil
                                </label>
                              </div>
                              <div class="form-check" style="margin-top: 1.0rem;">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="checkbox" value="" id="lanOther">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  Other Languages
                                </label>
                              </div>

                            </div>
                          </div>

                          <!-- Mode -->
                          <div style="margin-top: 2rem;"></div>
                          <h4>Your teaching mode</h4>
                          <div class="row">
                            <div class="col-md-12">
                            
                              <div class="form-check" style="margin-top: 1.0rem;">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="checkbox" value="" id="modeOnlineGroup" >
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  Online Class
                                </label>
                              </div>
                              <div class="form-check" style="margin-top: 1.0rem;">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="checkbox" value="" id="modeGroup">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  Physical Class
                                </label>
                              </div>
                              
                              <div class="form-check" style="margin-top: 1.0rem;">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="checkbox" value="" id="modeOnline">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  1-to-1 Online Tutoring
                                </label>
                              </div>
    
                              <div class="form-check" style="margin-top: 1.0rem;">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="checkbox" value="" id="modeHomeTutorToStudent">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  1-to-1 Tutoring - Tutor to Student's Place
                                </label>
                              </div>

                              <div class="form-check" style="margin-top: 1.0rem;">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="checkbox" value="" id="modeHomeStudentToTutor">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  1-to-1 Tutoring - Student to Tutor's Place
                                </label>
                              </div>

                            </div>
                          </div>


                        </div>
                      </div>

                      <!-- Content form-->
                      <div class="multitabs-form__panel shadow p-4 rounded bg-white" data-animation="scaleIn">
                        <h6 style="float:right; position: relative;" name="subject" ></h6>
                        <h4 class="multitabs-form__title" style="display: inline;">Content
                          <span class="tooltiptext-trigger">? 
                            <span class="tooltiptext-general">
                              <h6>Content</h6>
                              <p>Add content such as lectures, course chapters and more to give your clients a peek into your offer.</p>
                            </span> 
                          </span>
                        </h4>
                        <div class="multitabs-form__content">

                          
                          <div class="row">
                            

                            <div class="col-12" style="padding: 0">

                              <div class="row table-item-top">
                                <div class="col-md-12 table-item" style="padding: 0;">
                                  <table id="tableContent"  class="table-light table-sm" cellspacing="0" width="100%">
                                    <thead style="visibility: collapse;">
                                      <tr>
                                        <th style="width: 25px; min-width: 25px;"></th>
                                        <th class="th-item"></th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                      <!-- <tr class="item" style="border: solid 1px grey; background: #f5f5f5;" id="xxxx" >`
                                        <td style="background: #eeeeee;" >
                                          <i class="fas fa-grip-vertical" style="color: white;"></i>
                                        </td>
                                        <td style="padding-right: 1rem;">
                                          <p class="" style="font-size: 15px; font-weight: 400; color: grey; margin-top: 1rem; ">
                                            <span name="section-title">Chapter 2: New Title </span>
                                            <span>                  
                                              <a href="javascript:;" data-toggle="modal" data-target="#editTitleModal" data-id="xxxx"  data-name="section-title">
                                                <i class="fas fa-pen"></i>
                                              </a>
                                            </span>
                                            <span style="float: right;">
                                              <i class="fas fa-minus-circle" style="color: red; cursor: pointer;"  data-toggle="modal" data-target="#removeLessonDetailModal" data-id="xxxx"  data-type="section"  onclick="// removeRow(this); "></i>
                                            </span>
                                          </p>
                                          <div class="lesson-item-wrapper"> 
                                            <div class="lesson-item" id="yyyy" style="border: solid 1px grey; background: white; padding: 1rem; margin-bottom: 1rem;">
                                              <p style="font-size: 15px; font-weight: 400; color: gray; margin: 0.5rem 0;">
                                                <span name="lesson-title">Lesson 1 </span>

                                                <span>                  
                                                  <a href="javascript:;" data-toggle="modal" data-target="#editTitleModal" data-id="yyyy" data-name="lesson-title">
                                                    <i class="fas fa-pen"></i>
                                                  </a>
                                                </span> 
                                                <span style="float: right;">
                                                  <i class="fas fa-angle-down" style="color: grey; cursor: pointer; margin-right: 8px;" onclick="showLessonDetail(this)"></i>
                                                  <i class="fas fa-minus-circle" style="color: red; cursor: pointer;"  data-toggle="modal" data-target="#removeLessonDetailModal" data-id="yyyy"  data-type="lesson" onclick="//removeRow(this); "></i>
                                                </span>
                                              </p>

                                              <div class="lessonDetail" style="display: '';">
                                                <div class="lessonDetailDesc"  style="margin-top: 0.5rem;">
                                                  <div name="description"></div>
                                                  <a href="javascript:;" data-toggle="modal" data-target="#addLessonDetailDescModal" data-id="yyyy">
                                                    Add description
                                                  </a>


                                                  <p style="font-size: 15px; font-weight:300; margin: 0.5rem 0; color: grey;">Description</p>
                                                  <textarea class="detail" style="display: none;"></textarea>
                                                  <a href="javascript:;" onclick="removeLessonDetailDesc(this)">Remove description</a>
                                                </div>
                                                <div class="lessonDetailResources"style="margin-top: 1rem;">

                                                  <div class="d-flex bd-highlight align-items-center" name="resource">
                                                    <div class="p-2 bd-highlight" style="padding: 0 0.5rem 0 0!important;">
                                                      <a href="https://golearn.com.my" target="_blank"  >
                                                        <i class="fas fa-external-link-alt"></i>
                                                      </a>
                                                    </div>
                                                    <div class="p-2 bd-highlight" style="padding: 0 0.5rem 0 0!important;">
                                                      <i class="fas fa-minus-circle" style="color: red; cursor: pointer; float: right;" onclick="removeResource(this);"></i>
                                                    </div>
                                                    <div class="p-2 bd-highlight" style="word-wrap: break-word; overflow-wrap: break-word; word-break: break-word; padding: 0!important;" >
                                                      https://www.google.com/search?q=sotware&oq=sotware&aqs=chrome..69i57j0i10i131i433l3j0i10l2j46i10i131i199i433i465j0i10j0i10i131i433l2.1184j1j7&sourceid=chrome&ie=UTF-8
                                                    </div>
                                                  </div>

                                                  <a href="javascript:;" data-toggle="modal" data-target="#addLessonDetailResourceModal" data-id="yyyy">
                                                    Add resources
                                                  </a>

                                                </div>
                                                
                                                <div class="lessonDetailEmbed" style="margin-top: 1rem;">
                                                  <a href="javascript:;" data-toggle="modal" data-target="#addLessonDetailEmbedModal" data-id="yyyy">
                                                    Add embeded media
                                                  </a>
                                                </div>
                                              </div>
                                            </div>
                                          </div>
                                          <a  href="javascript:;" onclick="addLesson(uuid);" style="font-size: small;">Add new lesson</a>
                                        </td>
                                      </tr> -->
                                    </tbody>
                                  </table>
                                </div>
                              </div>

         
                            </div>
      
                            <div class="col-12" style="margin-top: 1rem;">
                              <a href="javascript:;" class="btn btn-primary btn-round" id="addItem" style="text-transform: none;"  onclick="var uuid_section = create_UUID(); addSection(uuid_section); addLesson(uuid_section);">Add new section <i class="fas fa-plus-circle" style="color: #fff; margin-left: 0.5em; padding-bottom: 0.2em;"></i></a>
                            </div>

                          </div>
               

                        </div>
                      </div>

                      <!-- Pricing form-->
                      <div class="multitabs-form__panel shadow p-4 rounded bg-white" data-animation="scaleIn">
                        <h6 style="float:right; position: relative;" name="subject" ></h6>

                        <h4 class="multitabs-form__title" style="display: inline;">Fee</h4>
                        <div class="multitabs-form__content">
    
                          <!-- Fee -->
                          <div style="margin-top: 1rem;"></div>
                          <div class="row">
                            <div class="col-md-12">
                              <div class="form-group">
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Fee* (RM)</span> 
                                <input type="number" step=".01" pattern="^\d*(\.\d{0,2})?$" class="form-control" id="inFee" data-compulsory="true" oninput="this.className = 'form-control'; checkFeeLimit();" max="9999">
                              </div>
    
                              <!-- <div style="margin-top: 1.0rem;"></div> -->
                              <span class="" style="font-size: smaller; font-weight: 300; color: gray; padding-right: 2rem;" >Fee Type</span> 
                              <div class="form-group" >
                                <div class="form-check form-check-radio form-check-inline">
                                  <label class="form-check-label">
                                    <input class="form-check-input" type="radio" name="exampleRadios" id="feeTypePerMonthRadio" value="option1" data-compulsory="false" checked>
                                    Per Month
                                    <span class="circle">
                                      <span class="check"></span>
                                    </span>
                                  </label>
                                </div>
                                <div class="form-check form-check-radio form-check-inline">
                                  <label class="form-check-label">
                                    <input class="form-check-input" type="radio" name="exampleRadios" id="feeTypePerHourRadio" value="option2" data-compulsory="false">
                                    Per Hour
                                    <span class="circle">
                                      <span class="check"></span>
                                    </span>
                                  </label>
                                </div>
                              </div>
    
                              <div class="form-group">
                                <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Fee Description <span id="countCourseFeeDesc" style="color: grey; margin-left: 1rem;">0/400</span></span> 
                                <textarea class="form-control" maxlength="250" rows="3" id="inCourseFeeDesc" data-compulsory="false"></textarea>
                              </div>
                            </div>
                          
                          </div>
            
                          <div style="margin-top: 2rem;"></div>
                          <h4>Promotions</h4>
                          <div class="row">
                            <div class="col-md-12">
                            
                              <div class="form-check" style="margin-top: 1.0rem;">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="checkbox" value="" id="incLM">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  Learning materials included
                                </label>
                              </div>
                              <div class="form-check" style="margin-top: 1.0rem;">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="checkbox" value="" id="incFD">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  Free downloads
                                </label>
                              </div>
                              
                              <div class="form-check" style="margin-top: 1.0rem;">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="checkbox" value="" id="inc30MTC">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  30 minutes trial class
                                </label>
                              </div>
    
                              <div class="form-check" style="margin-top: 1.0rem;">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="checkbox" value="" id="incFCF">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  First class free
                                </label>
                              </div>

                              <div class="form-check" style="margin-top: 1.0rem;">
                                <label class="form-check-label">
                                  <input class="form-check-input" type="checkbox" value="" id="incFG">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  Free gift
                                </label>
                              </div>

                              <div class="form-check" style="margin-top: 1.0rem;">
                                <span style="vertical-align: middle; font-size: 15px; font-weight: 400; color: rgb(165, 165, 165);">
                                  Available on
                                </span>
                              </div>

                              <div class="form-check" style="margin-top: 0.5rem;">
                                <label class="form-check-label-inline" style="margin-right:0.5rem">
                                  <input class="form-check-input" type="checkbox" value="" id="incAOMeet">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  Google Meet
                                </label>
                                <label class="form-check-label-inline"style="margin-right:0.5rem">
                                  <input class="form-check-input" type="checkbox" value="" id="incAOZoom">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  Zoom
                                </label>
                                <label class="form-check-label-inline"style="margin-right:0.5rem">
                                  <input class="form-check-input" type="checkbox" value="" id="incAOTeams">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  Microsoft Teams
                                </label>
                                <label class="form-check-label-inline"style="margin-right:0.5rem">
                                  <input class="form-check-input" type="checkbox" value="" id="incAOWebex">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  Webex
                                </label>
                                <label class="form-check-label-inline"style="margin-right:0.5rem">
                                  <input class="form-check-input" type="checkbox" value="" id="incAOFb">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  Facebook
                                </label>
                                <label class="form-check-label-inline"style="margin-right:0.5rem">
                                  <input class="form-check-input" type="checkbox" value="" id="incAOYoutube">
                                  <span class="form-check-sign">
                                    <span class="check"></span>
                                  </span>
                                  Youtube
                                </label>
                      
                              </div>

                            </div>
                          </div>

                        </div>
                      </div>

                      <!-- Advanced form-->
                      <div class="multitabs-form__panel shadow p-4 rounded bg-white" data-animation="scaleIn">
                        <h6 style="float:right; position: relative;" name="subject"></h6>

                        <h4 class="multitabs-form__title" style="display: inline;">Advanced</h4>
                        <div class="multitabs-form__content">
    
                          <!-- Preview -->
                          <div class="row align-items-center">
                            <div class="col-md-12" style="padding: 0;" >
                              <button type="button" class="btn btn-sm btn-outline-primary btn-round" id="btnPreview" style="color: #2e74b6; display: inline;" disabled>Preview</button>
                            </div>
                          </div>

                          <!-- Status -->
                          <div style="margin-top: 1rem;"></div>
                          <div class="row">
                            <div class="col-sm-12 text-left">
                              <span class="" style="font-size: smaller; font-weight: 300; color: gray;">Course Status</span> 
                              <span class="tooltiptext-trigger">? 
                                <span class="tooltiptext-general">
                                  <h6>Course Status</h6>
                                  <p><strong style="color: #2e74b6;">Uncheck</strong> to hide from the public.</p>
                                </span> 
                              </span>
                            </div>
                          </div>
                          
                          <div class="row">
                            <div class="col-md-12 align-self-center" >
                              <!-- Rounded switch -->
                              <label class="switch">
                                <input type="checkbox" id="classStatusCheck" data-toggle="modal" data-target="#statusToggleModal" disabled>
                                <span class="slider round"></span>
                              </label>
                              <span style="vertical-align: middle; font-size: 15px; font-weight: 400; color: rgb(165, 165, 165);">
                                Active
                              </span>
                            </div>
                          </div>

                          <!-- Link Class -->
                          <div style="margin-top: 2rem;"></div>
                          <div class="form-group">
                            <span class="" style="font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;">Link To Existing Class</span> 
                            <span class="tooltiptext-trigger">? 
                              <span class="tooltiptext-general">
                                <h6>Link To Existing Class</h6>
                                <p>
                                  Some of the linked class details & latest lessons will be visible to the public. <br>
                                  <span style="font-style: italic;">The details and lessons taught in the linked class <strong style="color: #2e74b6;">should be related to the subject</strong> of this course.</span>
                                </p>
                              </span> 
                            </span>
                          </div>
                          <div class="row align-items-center">
                            <div class="col-md-12" >
                              <button type="button" class="btn btn-sm btn-outline-primary btn-round" id="btnLinkClass" style="color: #2e74b6; display: inline;" data-toggle='modal' data-target='#addClassModal' disabled>Link</button>
                              <p style="margin: 0 0 0 0.5rem; display: inline; font-size: small;" id="inClassName"></p>
                              <!-- <div id="inClassNameId" value = ""></div> -->
                            </div>
                          </div>


                          <!-- Delete Course -->
                          <div style="margin-top: 2rem;"></div>
                          <div class="row" id="advDeleteCourse" style="display: none;">
                            <div class="col-sm-12 text-left">
                              <span class="" style="font-size: smaller; color: grey;">Delete this course</span> 
                              <span class="tooltiptext-trigger" style="background-color: red; padding: 0.2em 0.6em 0.2em 0.6em;">!
                                <span class="tooltiptext-general" style="border: thin solid red;">
                                  <h6 style="color: red;">Delete this course</h6>
                                  <!-- <p>This action cannot be <strong style="color: red;">undone</strong>. This will permanently unpublish your course, delete the course details and remove all the reviews from your clients.</p> -->
                                  <!-- <p>You will be prevented from creating a similar course for 6 months.</p> -->
                                  <!-- <p>If you still want to keep this course but hide it from the public, you may <strong style="color: #2e74b6 ;">uncheck</strong> Course Status.</p>  -->

                                  <p>This action cannot be <strong style="color: red;">undone</strong>. This will permanently remove your course & delete all the course details.</p>
                                  <p style="font-style: italic;">You are only allowed to delete course before it was published.</p>
                                </span> 
                              </span>
                            </div>
                          </div>
                          <div class="row" id="advDeleteCourseBtn" style="display: none;">
                            <div class="col-md-12" >
                              <a class="btn btn-sm btn-outline-danger btn-round" id="btnDelClass" style="color: red; background-color: white;" data-toggle='modal' data-target='#delCourseModal'>Delete Course <i class="fas fa-exclamation-triangle" style="color: red;"></i></a> 
                            </div>
                          </div>

                        </div>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>

      <footer class="footer">
        <div class="container-fluid">
          <nav class="float-left">
          <ul>
            <li>
            <!-- <a href="https://golearn.com.my/join-us" target="_blank">
              Visit GoLearn Tutor
            </a> -->
            </li>
          </ul>
          </nav>
          <!-- <div class="copyright float-right">
            &copy;
            <script>
              document.write(new Date().getFullYear())
            </script> 
            , made with <i class="material-icons">favorite</i> by <a href="#" >GoLearn Team</a>
          </div> -->
          <!-- your footer here -->
        </div>
      </footer>
    </div>
	  
  </div>

  <script src="../../assets/js/core/jquery.min.js"></script>
  <script src="../../assets/js/core/popper.min.js"></script>
  <script src="../../assets/js/core/bootstrap-material-design.min.js"></script>
  <script src="../../assets/js/plugins/perfect-scrollbar.jquery.min.js"></script>
  <!-- Plugin for the momentJs  -->
  <script src="../../assets/js/plugins/moment.min.js"></script>
  <!--  Plugin for Sweet Alert -->
  <script src="../../assets/js/plugins/sweetalert2.js"></script>
  <!-- Forms Validations Plugin -->
  <script src="../../assets/js/plugins/jquery.validate.min.js"></script>
  <!--  Notifications Plugin    -->
  <script src="../../assets/js/plugins/bootstrap-notify.js"></script>
  <!-- Control Center for Material Dashboard: parallax effects, scripts for the example pages etc -->
  <script src="../../assets/js/material-dashboard.js?v=2.1.2" type="text/javascript"></script>
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.min.js" integrity="sha384-lpyLfhYuitXl2zRZ5Bn2fqnhNAKOAaM/0Kr9laMspuaMiZfGmfwRNFh8HlMy49eQ" crossorigin="anonymous"></script>
  <!-- Common constants -->
  <script src="../../assets/js/common.js" type="text/javascript"></script>
  <!-- General Info -->
  <script src="../../assets/js/const.js" type="text/javascript"></script>
  <!-- Global Var -->
  <script src="../../assets/js/globalvar.js" type="text/javascript"></script>
  <!-- Core Tutor Js -->
  <script src="../../assets/js/tutor-core.js" type="text/javascript"></script>
  <!-- Datepicker -->
  <script src="../../assets/js/mc-calendar.min.js" type="text/javascript"></script>
  <!-- ClockPicker -->
  <script type="text/javascript" src="../../assets/js/bootstrap-clockpicker.min.js"></script>

  <script>
     
    var url_string = window.location.href
    var url = new URL(url_string);
    var courseId = url.searchParams.get("id");
    var courseNameOri = "";
    var courseContentId = "";
    var courseClassId = "";
    var courseFinalUrl = "";
    var courseCat = "";
    var courseSub = "";
    var courseStatus = "";

    // Initialization
    AuthCheck();

    // Page Specific Initialization
    function loadPageInitFunc(){
      

      // Get Default List of Tutor
      if (courseId != null && courseId != ''){

        // console.log(courseId);

        loadCourse(courseId);
        
        // loadCourseContent(courseId);

      }else {
        // window.location = "./";

        alert("No id found. Go back to home page")
      }

    }

    // Load Course Content
    function loadCourseContent(courseId) {
      var courseContentRef = db.collection("course")
      .doc('v1')
      .collection("content")
      .where(COURSE_CONTENT_COURSE_ID, '==', courseId)
      .limit(1);

			courseContentRef
			.get()
			.then((querySnapshot) => {
  
        querySnapshot.forEach((doc) => {
          // console.log(doc.data());
          courseContentId = doc.id;
          // courseFinalUrl = doc.data()[COURSE_URL];

          initCourseContent(doc);

        });

			}).catch((error) => {
				console.log("Error getting documents: ", error);
        func.showNotification('top','center', 'warning', 'error_outline', 'This course has no content. Please create one!' );

			});

    }

    // Get linked class info
    function loadLinkedClass(classId) {
      var classRef = db.collection("Class")
      .doc('v1')
      .collection("Class")
      .doc(classId);

			classRef
			.get()
			.then((doc) => {
        if (doc.exists) {
          document.getElementById("inClassName").textContent = doc.data()[CLASS_NAME];
          // document.getElementById("inClassNameId").setAttribute('value', doc.data()[COURSE_CLASS_ID]);
          document.getElementById("btnLinkClass").textContent = 'Unlink';
          document.getElementById("btnLinkClass").setAttribute('data-target', '#unlinkModal');

        } else {
          document.getElementById("btnLinkClass").textContent = 'Link';
          document.getElementById("btnLinkClass").setAttribute('data-target', '#addClassModal');
          console.log("No such document!");
        }

        // Enable link btn
        document.getElementById("btnLinkClass").removeAttribute('disabled');

			}).catch((error) => {
				console.log("Error getting documents: ", error);
			});
    }

    // Get the course content
    function initCourseContent(doc){
      // Course Content Format
      // [0] HEADER - UNUSED
      // [1] SECTION
      // [2] <section setting> UNUSED ( Can be used to set visibility)
      // [3] <section title> - Chapter 1
      // [4] LESSON
      // [5] <lesson setting> UNUSED (Can be used to set visibility / lesson type)
      // [6] <lesson title> - Addtion
      // [7] LESSON_DESCRIPTION
      // [8] <lesson description - html>
      // [9] LESSON_RESOURCE
      // [10] <lesson resource 1 - url >
      // [11] <lesson resource 2 - url >
      // [12] LESSON_EMBED
      // [13] <lesson embed media - html>
      // [14] LESSON (empty lesson)
      // [15] <lesson setting> UNUSED (Can be used to set visibility / lesson type)
      // [16] <lesson title> - Subtraction
      // [17] LESSON_DESCRIPTION
      // [19] LESSON_RESOURCE
      // [20] LESSON_EMBED
      // [21] SECTION (empty section)
      // [22] <section setting> UNUSED ( Can be used to set visibility)
      // [23] <section title> - Chapter 1

      var content = doc.data()[COURSE_CONTENT_ITEM];


      // console.log(itemStartIndex, additionalItemStartIndex, subtotalStartIndex, totalStartIndex)

      // let itemList = invData.slice(itemStartIndex+1, additionalItemStartIndex); //+1 to ignore the first indentifier, ITEMLIST
      // let additionalItem = invData.slice(additionalItemStartIndex+1, totalStartIndex); //+1 to ignore the first indentifier
      // let total = invData[totalStartIndex+1];

      var itemSectionStartIndexArr = [];
      content.filter(function(item, index) {
        if(item === 'SECTION'){
          itemSectionStartIndexArr.push(index)
        }
      });

      // console.log(itemSectionStartIndexArr)
      // ----------- SECTION ------------ //
      if (itemSectionStartIndexArr != null && itemSectionStartIndexArr.length > 0){

        // Loop through each section
        const sectionItemList = [];
        itemSectionStartIndexArr.forEach((sectionStartRow, index) => {
          // Get the items in each sections
          let sectionEndRow = itemSectionStartIndexArr[index+1]

          if (index + 1 == itemSectionStartIndexArr.length) {
            // Last item reach. The last row of last section is the last row of content
            sectionEndRow = content.length
          }
          else {
            sectionEndRow = itemSectionStartIndexArr[index + 1] // The row before the next SECTION row
          }
          // console.log(sectionStartRow, sectionEndRow)
          const  itemList = content.slice(sectionStartRow, sectionEndRow);
          let section_title = itemList[2] // Section Title
          // console.log(itemList)
          // console.log(section_title)

          // sectionItemList.push (itemList)

          let uuid_section = create_UUID(); 
          addSection(uuid_section, section_title);

          // ----------- LESSON ------------ //
          // Get Lesson's Index
          var itemLessonStartIndexArr = [];
          itemList.filter(function(item, index) {
            if(item === 'LESSON'){
              itemLessonStartIndexArr.push(index)
            }
          });

          if (itemLessonStartIndexArr != null && itemLessonStartIndexArr.length > 0){

            // Loop through each lesson
            itemLessonStartIndexArr.forEach((lessonStartRow, index) => {

              // Get the items in each sections
              let lessonEndRow = itemLessonStartIndexArr[index+1]

              if (index + 1 == itemLessonStartIndexArr.length) {
                // Last item reach. The last row of last section is the last row of content
                lessonEndRow = content.length
              }
              else {
                lessonEndRow = itemLessonStartIndexArr[index + 1] // The row before the next SECTION row
              }

              const lessonItemList = itemList.slice(lessonStartRow, lessonEndRow);
              // console.log(lessonItemList)

              // + 1 to get the actual content
              let lessonDescIndex = lessonItemList.indexOf('LESSON_DESC') + 1;
              let lessonResourcesIndex = lessonItemList.indexOf('LESSON_RESOURCE')+ 1;
              let lessonEmbedIndex = lessonItemList.indexOf('LESSON_EMBED') + 1;
              // console.log(lessonDescIndex, lessonResourcesIndex, lessonEmbedIndex )

              let title_lesson = lessonItemList[2] // Lesson Title
              let desc = lessonItemList[lessonDescIndex]; // Lesson Description
              var resourceList = [];
              // console.log(resourceList)

              if (lessonItemList[lessonResourcesIndex] === 'LESSON_EMBED' || lessonItemList[lessonResourcesIndex] == ''){

              }else {

                resourceList = lessonItemList.slice(lessonResourcesIndex, lessonEmbedIndex - 1); //
              }

              let embed = lessonItemList[lessonEmbedIndex]; // Lesson Embeded Media
              // console.log(title_lesson)

              // console.log(desc)
              // console.log(resourceList)
              // console.log(embed)
              addLesson(uuid_section, title_lesson, desc, resourceList, embed);
            });
          }
          else {
            // No lesson in this section
          }

          
        });

      }else{
        // func.showNotification('top','center', 'warning', 'error_outline', 'This course has no content. Please create one!' );
      }

    }

    // Load Course info
    function loadCourse(courseId) {

      initTinyMCE();

      var courseRef = db.collection("course")
      .doc('v1')
      .collection("course")
      .doc(courseId);

      // var courseContentRef = db.collection("course")
      // .doc('v1')
      // .collection("content")
      // .where(COURSE_CONTENT_COURSE_ID, '==', courseId);

      const promiseArr = [];
      promiseArr.push(courseRef.get());
      // promiseArr.push(courseContentRef.get());

      Promise.all(promiseArr)
      .then((snapshots) => {

        var promiseAll = [];

        // Course Info
        if(snapshots[0].exists){
          // console.log(snapshots[0].data());

          initCourse(snapshots[0]);

          courseContentId = snapshots[0].data()[COURSE_CONTENT_ID];
          courseClassId = snapshots[0].data()[COURSE_CLASS_ID];
          courseCat = snapshots[0].data()[COURSE_CAT_ID];
          courseSub = snapshots[0].data()[COURSE_SUB_ID];
          courseStatus = snapshots[0].data()[COURSE_STATUS];
          courseFinalUrl = snapshots[0].data()[COURSE_URL];
          
          // console.log('courseStatus: ' + courseStatus)

          if ( snapshots[0].data()[COURSE_STATUS_MESSAGE] != null && snapshots[0].data()[COURSE_STATUS_MESSAGE] != ""){
            func.showNotification('top','center', 'danger', 'error_outline', "Important: " +  snapshots[0].data()[COURSE_STATUS_MESSAGE]);
            
          }
          
          // // Course Content
          // if (snapshots[1] != null && snapshots[1].size > 0){
          //   // Course Content Info
          //   snapshots[1].forEach((doc) => {
          //     console.log(doc.data());
          //     courseContentId = doc.id;
          //     initCourseContent(doc);
          //   })
          // }
          // else {
          //   func.showNotification('top','center', 'warning', 'error_outline', 'This course has no content. Please create one!' );
          // }
          if (snapshots[0].data()[COURSE_CONTENT_ID] != null && snapshots[0].data()[COURSE_CONTENT_ID] !== ""){
            let courseContentRef = db.collection("course")
              .doc('v1')
              .collection("content")
              .doc(snapshots[0].data()[COURSE_CONTENT_ID]);

            promiseAll.push(courseContentRef.get())
          }
          else {
            promiseAll.push(null);
          }

          // Load Class Info
          if (snapshots[0].data()[COURSE_CLASS_ID] == null || snapshots[0].data()[COURSE_CLASS_ID] == ""){
            promiseAll.push(null)
          }
          else {
            // loadLinkedClass(classId);
            var classRef = db.collection("Class")
            .doc('v1')
            .collection("Class")
            .doc(snapshots[0].data()[COURSE_CLASS_ID]);

            promiseAll.push(classRef.get())
            
           
          }

          return Promise.all(promiseAll);

        } 
        else {
          console.log("No such course!");
          func.showNotification('top','center', 'danger', 'error_outline', "No such course!");

          return 2;

        }


      })
      // Get Class Info
      .then((snapshots) => {


        // if (snapshots == 1) {
        //  // Do nothing 
        //  document.getElementById("loadingScreen").style.display = "none";

        // }
        // // No such course
        // else if (snapshots == 2) {
        //  // Do nothing 
        //  document.getElementById("loadingScreen").style.display = "";

        // }
        // else if (snapshots.exists){
        //   document.getElementById("inClassName").textContent = snapshots.data()[CLASS_NAME];
        //   document.getElementById("btnLinkClass").textContent = 'Unlink';
        //   document.getElementById("btnLinkClass").setAttribute('data-target', '#unlinkModal');

        //   document.getElementById("loadingScreen").style.display = "none";

        // }
        // else {
        //   document.getElementById("btnLinkClass").textContent = 'Link';
        //   document.getElementById("btnLinkClass").setAttribute('data-target', '#addClassModal');
        //   console.log("No such document!");

        //   document.getElementById("loadingScreen").style.display = "none";

        // }

        // document.getElementById("btnLinkClass").removeAttribute('disabled');


        // Init Course Content
        if (snapshots[0] != null  && snapshots[0].exists){
          // console.log('Course Content');
          // console.log(snapshots[0].data());
          initCourseContent(snapshots[0]);
          // snapshots[0].forEach((doc) => {
          //   console.log(doc.data());
          //   courseContentId = doc.id;
          //   initCourseContent(doc);
          // })
        }
        else {
          func.showNotification('top','center', 'warning', 'error_outline', 'This course has no content. Please create one!' );
        }

        // Init Class
        if (snapshots[1] != null  && snapshots[1].exists){
          document.getElementById("inClassName").textContent = snapshots[1].data()[CLASS_NAME];
          document.getElementById("btnLinkClass").textContent = 'Unlink';
          document.getElementById("btnLinkClass").setAttribute('data-target', '#unlinkModal');
        }  
        else {
          document.getElementById("btnLinkClass").textContent = 'Link';
          document.getElementById("btnLinkClass").setAttribute('data-target', '#addClassModal');
        }
        document.getElementById("btnLinkClass").removeAttribute('disabled');

        // Global init
        if (snapshots == 2) {
          // No such course
          document.getElementById("loadingScreen").style.display = "";

        }
        else {
          document.getElementById("loadingScreen").style.display = "none";

        }

      })
      // Complete
      .then(() =>{
        // document.getElementById("loadingScreen").style.display = "none";

      });



      ////////////////

			// courseRef
			// .get()
			// .then((doc) => {
      //   if (doc.exists) {
      //     console.log(doc.data());
      //     initCourse(doc);
      //     courseClassId = doc.data()[COURSE_CLASS_ID]
      //     courseStatus = doc.data()[COURSE_STATUS]
      //     // Get class info
      //     if (doc.data()[COURSE_CLASS_ID] == null || doc.data()[COURSE_CLASS_ID] == ""){
      //       // Unlinked,  Enable link btn
      //       document.getElementById("btnLinkClass").textContent = 'Link';
      //       document.getElementById("btnLinkClass").setAttribute('data-target', '#addClassModal');
      //       document.getElementById("btnLinkClass").removeAttribute('disabled');
      //     }else {
      //       loadLinkedClass(doc.data()[COURSE_CLASS_ID]);
      //     }

      //   } else {
      //     console.log("No such document!");
      //     // window.location = "./"
      //   }

        

			// }).catch((error) => {
			// 	console.log("Error getting documents: ", error);
			// });


      // /////////////////////////
 

			// courseContentRef
			// .get()
			// .then((querySnapshot) => {
  
      //   querySnapshot.forEach((doc) => {
      //     // console.log(doc.data());
      //     courseContentId = doc.id;
      //     initCourseContent(doc);

      //   })

			// }).catch((error) => {
			// 	console.log("Error getting documents: ", error);
      //   func.showNotification('top','center', 'warning', 'error_outline', 'This course has no content. Please create one!' );

			// });

    }

    function initCourse(doc){

      // General
      let category = Category[CategoryId.indexOf(doc.data()[COURSE_CAT_ID])];
      let subject = getSubjectBasedOnCategoryIdAndSubjectId(doc.data()[COURSE_CAT_ID], doc.data()[COURSE_SUB_ID])
      let subjectEleList = document.querySelectorAll('h6[name=subject]');
      subjectEleList.forEach((ele) => {
        ele.textContent = category +'-' + subject;
      });

      // Draft mode
      if (doc.data()[COURSE_STATUS] == COURSE_STATUS_DRAFT){
        document.getElementById("btnPublishDiv").style.display = "";
        document.getElementById("btnPublish").removeAttribute("disabled");
        document.getElementById("btnPublish").textContent = "Publish";
      }
      else if (doc.data()[COURSE_STATUS] ==  COURSE_STATUS_REVIEW){
        document.getElementById("btnPublishDiv").style.display = "";
        document.getElementById("btnPublish").setAttribute("disabled", true);
        document.getElementById("btnPublish").textContent = "Pending";
      }else {
        document.getElementById("btnPublishDiv").style.display = "none";
      }
      // Suspended mode
      document.getElementById("courseAdminMessage").textContent = doc.data()[COURSE_STATUS_MESSAGE];
      if (doc.data()[COURSE_STATUS] == COURSE_STATUS_SUSPENDED){
        document.getElementById("btnSuspendedDiv").style.display = "";
      }else {
        // Enable Page
        document.getElementById("btnSave").removeAttribute("disabled");
        document.getElementById("btnSuspendedDiv").style.display = "none";
      }

      courseNameOri = doc.data()[COURSE_NAME];

      document.getElementById("inCourseName").value = doc.data()[COURSE_NAME];
      document.getElementById("countCourseName").textContent = doc.data()[COURSE_NAME].length + '/80'
      document.getElementById("inCourseDesc").value = doc.data()[COURSE_DESC];
      document.getElementById("countCourseDesc").textContent = doc.data()[COURSE_DESC].length + '/400'

      // What stu will learn
      let objList = doc.data()[COURSE_OBJ_ARR]
      const tbody_temp = table.querySelector("tbody");
      let trList = tbody_temp.querySelectorAll("tr[class=item]");

      objList.forEach((obj, index) => {
        if (index < 4) {
          trList[index].querySelector("input").value = obj;
        }else {
          addRow(obj);
        }
      });


      // Time Slot
      // Remove second and above time slot
      clearTimeSlot();
      //    1st Slot
      let subject_drop = document.getElementById("inDayOfWeek1");

      if (doc.data()[COURSE_TIMESLOT_DAY_OF_WEEK_ARR][0] == null || doc.data()[COURSE_TIMESLOT_DAY_OF_WEEK_ARR][0] == ""){
        // Someone removed the first Day of Week. So do nothing here
      }else {
        document.getElementById('inDayOfWeek1').value = doc.data()[COURSE_TIMESLOT_DAY_OF_WEEK_ARR][0];
      }
      document.getElementById("inStartTime1").value = doc.data()[COURSE_TIMESLOT_START_ARR][0];
      document.getElementById("inEndTime1").value = doc.data()[COURSE_TIMESLOT_END_ARR][0];

      if (doc.data()[COURSE_TIMESLOT_DAY_OF_WEEK_ARR].length > 1){
        // Add time slot
        for (let i = 1; i<doc.data()[COURSE_TIMESLOT_DAY_OF_WEEK_ARR].length; i++){
          addTimeSlot(doc.data()[COURSE_TIMESLOT_DAY_OF_WEEK_ARR][i], doc.data()[COURSE_TIMESLOT_START_ARR][i], doc.data()[COURSE_TIMESLOT_END_ARR][i]); 
        }
      }
      initTimePicker();

      // Fee Panel
      document.getElementById("inFee").value = doc.data()[COURSE_FEE];
      document.getElementById("feeTypePerMonthRadio").checked = doc.data()[COURSE_FEE_TYPE] === FEES_TYPE_PER_MONTH_KEY ;
      document.getElementById("feeTypePerHourRadio").checked = doc.data()[COURSE_FEE_TYPE] === FEES_TYPE_PER_HOUR_KEY ;
      document.getElementById("inCourseFeeDesc").value = doc.data()[COURSE_FEE_DESC];
      document.getElementById("countCourseFeeDesc").textContent = doc.data()[COURSE_FEE_DESC].length + '/250'

      let includeList = doc.data()[COURSE_INCLUDE];
      if (includeList != null && includeList.length > 0){
        includeList.forEach((include) => {
          if (include === 'LM') document.getElementById("incLM").checked = true;
          else if(include === 'FD') document.getElementById("incFD").checked = true;
          else if(include === '30MTC') document.getElementById("inc30MTC").checked = true;
          else if(include === 'FCF') document.getElementById("incFCF").checked = true;
          else if(include === 'FG') document.getElementById("incFG").checked = true;
          else if(include === 'AOMeet') document.getElementById("incAOMeet").checked = true;
          else if(include === 'AOZoom') document.getElementById("incAOZoom").checked = true;
          else if(include === 'AOWebex') document.getElementById("incAOWebex").checked = true;
          else if(include === 'AOTeams') document.getElementById("incAOTeams").checked = true;
          else if(include === 'AOFb') document.getElementById("incAOFb").checked = true;
          else if(include === 'AOYoutube') document.getElementById("incAOYoutube").checked = true;

        });
      }

      // Teaching mode
      let modeList = doc.data()[COURSE_MODE_ARR];
      if (modeList != null && modeList.length > 0){
        modeList.forEach((mode) => {
          if (mode === MODE_HOME_TUTOR_TO_STUDENT) document.getElementById("modeHomeTutorToStudent").checked = true;
          else if(mode === MODE_HOME_STUDENT_TO_TUTOR) document.getElementById("modeHomeStudentToTutor").checked = true;
          else if(mode === MODE_GROUP) document.getElementById("modeGroup").checked = true;
          else if(mode === MODE_ONLINE) document.getElementById("modeOnline").checked = true;
          else if(mode === MODE_ONLINE_GROUP) document.getElementById("modeOnlineGroup").checked = true;
        });
      }

      // Language
      let lanList = doc.data()[COURSE_LAN_ARR];
      if (lanList != null && lanList.length > 0){
        lanList.forEach((lan) => {
          if (lan === LAN_ENGLISH) document.getElementById("lanEng").checked = true;
          else if(lan === LAN_BM) document.getElementById("lanBm").checked = true;
          else if(lan === LAN_BC) document.getElementById("lanBc").checked = true;
          else if(lan === LAN_BT) document.getElementById("lanBt").checked = true;
          else if(lan === LAN_OTHER) document.getElementById("lanOther").checked = true;
        });
      }

      // Advanced panel
      // Preview
      document.getElementById("btnPreview").removeAttribute("disabled");
      if (doc.data()[COURSE_URL] == null || doc.data()[COURSE_URL] == ""){
        let url = "https://app.golearn.com.my/course/?cid="+doc.data()[COURSE_ID]+"&tid="+encode64(tutorId)+"&action=preview";
        document.getElementById("btnPreview").setAttribute('onclick', "window.open('"+url+"')");
        document.getElementById("btnPreview").textContent = "Preview";
      }else {
        let url = "https://golearn.com.my/all-courses/" +doc.data()[COURSE_URL] +".html";
        document.getElementById("btnPreview").setAttribute('onclick', "window.open('"+url+"')");
        document.getElementById("btnPreview").textContent = "Public View";
      }



      document.getElementById("classStatusCheck").removeAttribute('disabled');

      if (doc.data()[COURSE_STATUS] === COURSE_STATUS_DRAFT || doc.data()[COURSE_STATUS] === COURSE_STATUS_REVIEW  || 
      doc.data()[COURSE_STATUS] === COURSE_STATUS_SUSPENDED){
        document.getElementById("classStatusCheck").checked = false;

      }else if (doc.data()[COURSE_STATUS] === COURSE_STATUS_INACTIVE){
        document.getElementById("classStatusCheck").checked = false;
      }else if (doc.data()[COURSE_STATUS] === COURSE_STATUS_ACTIVE){
        document.getElementById("classStatusCheck").checked = true;

      }

      // Get class info
      if (doc.data()[COURSE_CLASS_ID] == null || doc.data()[COURSE_CLASS_ID] == ""){
        // Unlinked,  Enable link btn
        document.getElementById("btnLinkClass").textContent = 'Link';
        document.getElementById("btnLinkClass").setAttribute('data-target', '#addClassModal');
        document.getElementById("btnLinkClass").removeAttribute('disabled');
      }

      // Delete only allowed for unpublished course
      if (doc.data()[COURSE_STATUS] === COURSE_STATUS_DRAFT){
        document.getElementById("advDeleteCourse").style.display = "";
        document.getElementById("advDeleteCourseBtn").style.display = "";

      }


      

    }

    // Add Time Slot
    function addTimeSlot(dayOfWeekVal, startTime, endTime){
      var x = document.getElementById("timeSlot-container").childElementCount;

      let dayOfWeek_form_label = document.createElement('span');
      dayOfWeek_form_label.className = "";
      dayOfWeek_form_label.textContent = "Day of Week";
      dayOfWeek_form_label.setAttribute("style", "font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;");

      // let blogsHtml_dayOfWeek = '';
      // blogsHtml_dayOfWeek += "<option value=''>Select Day Of Week</option><option value='mon'>Monday</option><option value='tue'>Tuesday</option><option value='wed'>Wednesday</option><option value='thu'>Thursday</option><option value='fri'>Friday</option><option value='sat'>Saturday</option><option value='sun'>Sunday</option>";
      let dayOfWeek_form_input = document.createElement('select');
      // dayOfWeek_form_input.innerHTML = blogsHtml_dayOfWeek;
      dayOfWeek_form_input.className = "form-control";
      dayOfWeek_form_input.selected = dayOfWeekVal;
      dayOfWeek_form_input.setAttribute("data-compulsory", "true");
      dayOfWeek_form_input.setAttribute("oninput", "this.className = 'form-control'");
      dayOfWeek_form_input.setAttribute("id", "DayOfWeek" + (x+1));
      let myDayOfWeekId = MyDayOfWeekId; 
      let myDayOfWeek = MyDayOfWeek; 
      // First items
      let el = document.createElement("option");
      el.textContent = 'Select Day Of Week';
      el.value = '';
      dayOfWeek_form_input.appendChild(el);
      //Create Mon - Sun options
      for (var i = 0; i < myDayOfWeekId.length; i++) {
        let el = document.createElement("option");
        el.textContent = myDayOfWeek[i];
        el.value = myDayOfWeekId[i];
        // Set default selection
        if (dayOfWeekVal === myDayOfWeekId[i]){
          el.selected =  true;
        }

        dayOfWeek_form_input.appendChild(el);
      }

      let dayOfWeek_form_div = document.createElement('div');
      dayOfWeek_form_div.className = "form-group bmd-form-group";
      dayOfWeek_form_div.appendChild(dayOfWeek_form_label)
      dayOfWeek_form_div.appendChild(dayOfWeek_form_input)
      let dayOfWeek_div = document.createElement('div');
      dayOfWeek_div.className = "col-md-5";
      dayOfWeek_div.appendChild(dayOfWeek_form_div)

      // Start Time
      let startTime_form_label = document.createElement('span');
      startTime_form_label.className = "";
      startTime_form_label.textContent = "Start Time";
      startTime_form_label.setAttribute("style", "font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;");

      let startTime_form_input = document.createElement('input');
      startTime_form_input.type = "text";
      startTime_form_input.className = "form-control";
      startTime_form_input.value = startTime;
      startTime_form_input.setAttribute("id", "StartTime" + (x+1));
      startTime_form_input.setAttribute("style", "cursor: not-allowed; pointer-events: none;");
      // startTime_form_input.setAttribute("value", "");
      startTime_form_input.setAttribute("data-compulsory", "true");
      startTime_form_input.setAttribute("oninput", "this.className = 'form-control'");

      let blogsHtml_startTimeIcon = '';
      blogsHtml_startTimeIcon += "<span class='material-icons'>more_time</span>";
      let startTime_span = document.createElement('span');
      startTime_span.innerHTML = blogsHtml_startTimeIcon;
      startTime_span.className = "d-flex align-items-center input-group-addon"

      let startTime_form_input_div = document.createElement('div');
      startTime_form_input_div.type = "text";
      startTime_form_input_div.className = "input-group clockpicker";
      startTime_form_input_div.setAttribute("data-placement", "bottom");
      startTime_form_input_div.setAttribute("data-align", "top");
      startTime_form_input_div.setAttribute("data-autoclose", "true");
      startTime_form_input_div.setAttribute("style", "margin-top: 0.3rem;");
      startTime_form_input_div.appendChild(startTime_form_input)
      startTime_form_input_div.appendChild(startTime_span)

      let startTime_form_div = document.createElement('div');
      startTime_form_div.className = "form-group bmd-form-group";
      startTime_form_div.appendChild(startTime_form_label)
      startTime_form_div.appendChild(startTime_form_input_div)
      let startTime_div = document.createElement('div');
      startTime_div.className = "col-md-3";
      startTime_div.appendChild(startTime_form_div)

      let endTime_form_label = document.createElement('span');
      endTime_form_label.className = "";
      endTime_form_label.textContent = "End Time";
      endTime_form_label.setAttribute("style", "font-size: smaller; font-weight: 300; color: gray; margin-bottom: 0;");

      // <div class="input-group clockpicker" data-placement="right" data-align="top" data-autoclose="true" style="margin-top: 0.3rem;">
      //   <input type="text" class="form-control" value="13:30" id="">
      // </div>

      let endTime_form_input = document.createElement('input');
      endTime_form_input.type = "text";
      endTime_form_input.className = "form-control";
      endTime_form_input.value = endTime;
      endTime_form_input.setAttribute("id", "EndTime" + (x+1));
      endTime_form_input.setAttribute("style", "trcursor: not-allowed; pointer-events: none;ue");
      // endTime_form_input.setAttribute("value", "");
      endTime_form_input.setAttribute("data-compulsory", "true");
      endTime_form_input.setAttribute("oninput", "this.className = 'form-control'");

      let blogsHtml_endTimeIcon = '';
      blogsHtml_endTimeIcon += "<span class='material-icons'>more_time</span>";
      let endTime_span = document.createElement('span');
      endTime_span.innerHTML = blogsHtml_endTimeIcon;
      endTime_span.className = "d-flex align-items-center input-group-addon"

      let endTime_form_input_div = document.createElement('div');
      endTime_form_input_div.type = "text";
      endTime_form_input_div.className = "input-group clockpicker";
      endTime_form_input_div.setAttribute("data-placement", "bottom");
      endTime_form_input_div.setAttribute("data-align", "top");
      endTime_form_input_div.setAttribute("data-autoclose", "true");
      endTime_form_input_div.setAttribute("style", "margin-top: 0.3rem;");
      endTime_form_input_div.appendChild(endTime_form_input)
      endTime_form_input_div.appendChild(endTime_span)

      let endTime_form_div = document.createElement('div');
      endTime_form_div.className = "form-group bmd-form-group";
      endTime_form_div.appendChild(endTime_form_label)
      endTime_form_div.appendChild(endTime_form_input_div)
      let endTime_div = document.createElement('div');
      endTime_div.className = "col-md-3";
      endTime_div.appendChild(endTime_form_div)
      

      // let delete_i = document.createElement('i');
      // delete_i.className = "fas fa-minus-circle";
      // delete_i.setAttribute("style", 'color: red; cursor: pointer;');
      // delete_i.setAttribute("id", "btnRemoveTimeSlot" + (x+1))
      // delete_i.setAttribute("onclick", "removeTimeSlot("+(x+1)+")")

      let blogsHtml_btn = '';
      blogsHtml_btn += "<i class='material-icons' style='color: red;'>remove</i>";
      let btnRemove_a = document.createElement('a');
      btnRemove_a.innerHTML = blogsHtml_btn;
      btnRemove_a.className = "btn btn-sm btn-outline-danger btn-round"
      btnRemove_a.setAttribute("id", "btnRemoveTimeSlot" + (x+1))
      btnRemove_a.setAttribute("onclick", "removeTimeSlot("+(x+1)+")")
      let btnRemove_div = document.createElement('div');
      btnRemove_div.className = "col-md-1  d-flex align-items-center";
      btnRemove_div.appendChild(btnRemove_a)

      let timeSlotTop_div = document.createElement('div');
      timeSlotTop_div.setAttribute("id", "timeSlot-"+(x+1));
      timeSlotTop_div.setAttribute("style", "padding: 0rem 3rem 0rem 0rem; border: solid #2e74b6; border-width: thin; margin-top: 1rem;");
      timeSlotTop_div.className = "row"
      timeSlotTop_div.appendChild(dayOfWeek_div)
      timeSlotTop_div.appendChild(startTime_div)
      timeSlotTop_div.appendChild(endTime_div)
      timeSlotTop_div.appendChild(btnRemove_div)

      const timeSlot_container = document.getElementById("timeSlot-container");
      timeSlot_container.appendChild(timeSlotTop_div);
      
    }
    
    // Get Time Slot Data
    var dayOfWeekArr = [];
    var startTimeArr = [];
    var endTimeArr = [];
    function getAllTimeSlots() {
      dayOfWeekArr = [];
      startTimeArr = [];
      endTimeArr = [];
      // This function deals with validation of the form fields with data-compulsory = 'true'
      var x, y, i, valid = true;
      x = document.getElementById("timeSlotTop");
      // console.log(x)
      // y = x[activePanelNum].getElementsByTagName("input") && x[activePanelNum].querySelectorAll('[type="text"]');
      y =x.querySelectorAll('[data-compulsory="true"]');

      // A loop that checks every input field in the current tab:
      for (i = 0; i < y.length; i++) {

        if (i % 3 === 0){
          dayOfWeekArr.push(y[i].value)
        }
        if (i % 3 === 1){
          startTimeArr.push(y[i].value)
        }
        if (i % 3 === 2){
          endTimeArr.push(y[i].value)
        }
   
        
        // If a field is empty...
        if (y[i].value == "") {
          // add an "invalid" class to the field:
          // y[i].className += " invalid";
          // and set the current valid status to false:
          valid = false;
        }
      }

      // console.log(dayOfWeekArr)
      // console.log(startTimeArr)
      // console.log(endTimeArr)
      return valid; // return the valid status
    }


    // Remove Time Slot
    function removeTimeSlot(id){
      $( "#timeSlot-"+id ).remove();
    }
  
    // Remove second and above Time Slot
    function clearTimeSlot(){
      var timeSlotContainerChildCount = document.getElementById("timeSlot-container").childElementCount;
      var timeSlotContainer = document.getElementById("timeSlot-container").children;

      // console.log(timeSlotContainer);
      Array.from(timeSlotContainer).forEach((row, index) => {

        if (index > 0){
          row.remove();
        }
        // console.log(row);
        // console.log(index);
      });

    }
    
    // Init Time picker
    function initTimePicker(){
      $('.clockpicker').clockpicker()
      .find('input').change(function(){
        // Time changed
        // console.log(this.value);
        // this.className = "form-control";
      });
    }

    // Section - Remove section
    function removeSection(sectionId) {
      document.getElementById(sectionId).remove();
    }

    // Section - Add Section
    function addSection(uuid_section, title_section = "New Section"){

      // let uuid_lesson = create_UUID(); // Lesson UUID

      // <tr class="item" style="border: solid 1px grey; background: #f5f5f5;" id="xxxx" >
      //   <td style="background: #eeeeee;" >
      //     <i class="fas fa-grip-vertical" style="color: white;"></i>
      //   </td>
      //   <td style="padding-right: 1rem;">
      //     <p class="" style="font-size: 15px; font-weight: 400; color: grey; margin-top: 1rem; ">
      //       <span name="section-title">Chapter 2: New Title </span>
      //       <span>                  
      //         <a href="javascript:;" data-toggle="modal" data-target="#editTitleModal" data-id="xxxx"  data-name="section-title">
      //           <i class="fas fa-pen"></i>
      //         </a>
      //       </span>
      //       <span style="float: right;">
      //         <i class="fas fa-minus-circle" style="color: red; cursor: pointer;"  data-toggle="modal" data-target="#removeLessonDetailModal" data-id="xxxx"  data-type="section"  onclick="// removeRow(this); "></i>
      //       </span>
      //     </p>
      //     <div class="lesson-item-wrapper"> 
      //       <div class="lesson-item" id="yyyy" style="border: solid 1px grey; background: white; padding: 1rem; margin-bottom: 1rem;">
      //         <p style="font-size: 15px; font-weight: 400; color: gray; margin: 0.5rem 0;">
      //           <span name="lesson-title">Lesson 1 </span>

      //           <span>                  
      //             <a href="javascript:;" data-toggle="modal" data-target="#editTitleModal" data-id="yyyy" data-name="lesson-title">
      //               <i class="fas fa-pen"></i>
      //             </a>
      //           </span> 
      //           <span style="float: right;">
      //             <i class="fas fa-angle-down" style="color: grey; cursor: pointer; margin-right: 8px;" onclick="showLessonDetail(this)"></i>
      //             <i class="fas fa-minus-circle" style="color: red; cursor: pointer;"  data-toggle="modal" data-target="#removeLessonDetailModal" data-id="yyyy"  data-type="lesson" onclick="//removeRow(this); "></i>
      //           </span>
      //         </p>

      //         <div class="lessonDetail" style="display: '';">
      //           <div class="lessonDetailDesc"  style="margin-top: 0.5rem;">
      //             <div name="description"></div>
      //             <a href="javascript:;" onclick="addLessonDetailDesc(this);" >
      //               Add description
      //             </a>
      //             <a href="javascript:;" data-toggle="modal" data-target="#addLessonDetailDescModal" data-id="yyyy">
      //               Add description
      //             </a>
      //           </div>
      //           <div class="lessonDetailResources"style="margin-top: 1rem;">
      //             <a href="javascript:;" data-toggle="modal" data-target="#addLessonDetailResourceModal" data-id="yyyy">
      //               Add resources
      //             </a>
      //           </div>
      //           <div class="lessonDetailEmbed" style="margin-top: 1rem;">
      //             <a href="javascript:;" data-toggle="modal" data-target="#addLessonDetailEmbedModal" data-id="yyyy">
      //               Add embeded media
      //             </a>
      //           </div>
      //         </div>
      //       </div>
      //     </div>

      //     <a  href="javascript:;" id="addRow" onclick="addLesson(this);">Add new lesson</a>
      //   </td>
      // </tr>

      // Section title
      let section_title_html = "<span name='section-title'>"+title_section+"</span>";
      let section_title_edit_html = "<span><a href='javascript:;' data-toggle='modal' data-target='#editTitleModal' data-id='"+uuid_section+"' data-name='section-title'> <i class='fas fa-pen'></i></a></span>";
      let section_title_remove_html = `
          <span style="float: right;">
            <i class="fas fa-minus-circle" style="color: red; cursor: pointer;"  data-toggle="modal" data-target="#removeLessonDetailModal" data-id="`+ uuid_section+ `" data-type="section"></i>
          </span>`
      let section_title_all_html = section_title_html + section_title_edit_html + section_title_remove_html
      let section_title_p = document.createElement('p');
      section_title_p.setAttribute('style', 'font-size: 15px; font-weight: 400; color: gray; margin-top: 1rem;');
      section_title_p.innerHTML = section_title_all_html;
      
      // // Lesson Detail - Desc
      // let desc_a = document.createElement('a');
      // desc_a.href = 'javascript:;';
      // desc_a.textContent = 'Add description';
      // desc_a.setAttribute('data-toggle', 'modal');
      // desc_a.setAttribute('data-target', '#addLessonDetailDescModal');
      // desc_a.setAttribute('data-id', uuid_lesson);
      // let desc_div = document.createElement('div');
      // desc_div.setAttribute('name', 'description');
      // let lessondetaildesc_div = document.createElement('div');
      // lessondetaildesc_div.className = "lessonDetailDesc";
      // lessondetaildesc_div.setAttribute('style', 'margin-top: 0.5rem;');
      // lessondetaildesc_div.appendChild(desc_div);
      // lessondetaildesc_div.appendChild(desc_a);

      // // Lesson Detail - Resource
      // let resource_a = document.createElement('a');
      // resource_a.href = 'javascript:;';
      // resource_a.textContent = 'Add resource';
      // resource_a.setAttribute('data-toggle', 'modal');
      // resource_a.setAttribute('data-target', '#addLessonDetailResourceModal');
      // resource_a.setAttribute('data-id', uuid_lesson);
      // let lessondetailresource_div = document.createElement('div');
      // lessondetailresource_div.className = "lessonDetailResources";
      // lessondetailresource_div.setAttribute('style', 'margin-top: 1rem;');
      // lessondetailresource_div.appendChild(resource_a);

      // // Lesson Detail - Embed Media
      // let embed_a = document.createElement('a');
      // embed_a.href = 'javascript:;';
      // embed_a.textContent = 'Add embed media';
      // embed_a.setAttribute('data-toggle', 'modal');
      // embed_a.setAttribute('data-target', '#addLessonDetailEmbedModal');
      // embed_a.setAttribute('data-id', uuid_lesson);
      // let lessondetailembed_div = document.createElement('div');
      // lessondetailembed_div.className = "lessonDetailEmbed";
      // lessondetailembed_div.setAttribute('style', 'margin-top: 1rem;');
      // lessondetailembed_div.appendChild(embed_a);

      // let detail_top_div = document.createElement('div');
      // detail_top_div.className = "lessonDetail";
      // detail_top_div.setAttribute('style', "display: none;");
      // detail_top_div.appendChild(lessondetaildesc_div);
      // detail_top_div.appendChild(lessondetailresource_div);
      // detail_top_div.appendChild(lessondetailembed_div);

      // // Lesson Title
      // let lesson_title_html = "<span name='lesson-title'>New Lesson</span>";
      // let lesson_title_edit_html = "<span><a href='javascript:;' data-toggle='modal' data-target='#editTitleModal' data-id='"+uuid_lesson+"' data-name='lesson-title'> <i class='fas fa-pen'></i></a></span>";
      // let lesson_title_remove_html = `
      //     <span style="float: right;">
      //       <i class="fas fa-angle-down" style="color: grey; cursor: pointer; margin-right: 8px;" onclick="showLessonDetail(this)"></i>
      //       <i class="fas fa-minus-circle" style="color: red; cursor: pointer;"  data-toggle="modal" data-target="#removeLessonDetailModal" data-id="`+ uuid_lesson+ `" data-type="lesson"></i>
      //     </span>`
      // let lesson_title_all_html = lesson_title_html + lesson_title_edit_html + lesson_title_remove_html
      // let title_p = document.createElement('p');
      // title_p.setAttribute('style', 'font-size: 15px; font-weight: 400; color: gray; margin: 0.5rem 0;');
      // title_p.innerHTML = lesson_title_all_html;

      // let lesson_top_div = document.createElement('div');
      // lesson_top_div.className = "lesson-item";
      // lesson_top_div.id = uuid_lesson;
      // lesson_top_div.setAttribute('style', 'border: solid 1px grey; background: white; padding: 1rem; ');
      // lesson_top_div.appendChild(title_p);
      // lesson_top_div.appendChild(detail_top_div);

      // Lesson Detail Wrapper
      let lesson_wrapper_div = document.createElement('div');
      lesson_wrapper_div.className = "lesson-item-wrapper";
      // lesson_wrapper_div.appendChild(lesson_top_div);
     
      // Add new lesson button
      let add_new_lesson_a = document.createElement('a');
      add_new_lesson_a.href = "javascript:;";
      add_new_lesson_a.textContent = "Add new lesson";
      add_new_lesson_a.setAttribute('style', 'font-size: small');
      add_new_lesson_a.setAttribute('onclick', "addLesson('"+uuid_section+"');");

      // let section_td =  document.createElement('td');
      // section_td.setAttribute('style', 'padding-right: 1rem;');
      // section_td.appendChild(section_title_p);
      // section_td.appendChild(lesson_wrapper_div);
      // section_td.appendChild(add_new_lesson_a);

      // let dragable_td =  document.createElement('td');
      // dragable_td.setAttribute('style', 'background: #eeeeee;');
      // dragable_td.innerHTML = "<i class='fas fa-grip-vertical' style='color: white;'></i>";

      // Section Top
      let section_top_tr = document.createElement('tr');

      // Get the table 
      const table_temp = document.getElementById("tableContent")

      // Get the tbody tag
      const tbody_temp = table_temp.querySelector("tbody");
      // let table_temp = elem.parentNode.parentNode.parentNode;
      // console.log(table_temp);

      // Get the number of tr[class=item] in tbody
      // let draggableRowLastIndex = document.getElementById("body_"+id).querySelectorAll("tr[class=item]").length;
      let draggableRowLastIndex = table_temp.querySelectorAll("tr[class=item]").length;
      // console.log(draggableRowLastIndex);

      // Create an empty <tr> element and add it to the last position of draggable items.
      var row = tbody_temp.insertRow(draggableRowLastIndex);
   
      // Insert new cells (<td> elements) at the 1st and 2nd position of the "new" <tr> element:
      var cell1 = row.insertCell(0);
      var cell2 = row.insertCell(1);

      row.className = 'item';
      row.setAttribute('style', 'border: solid 1px grey; background: #f5f5f5; ');
      row.id = uuid_section;

      // Add some text to the new cells:
      cell1.setAttribute('style', 'background: #eeeeee;');
      cell1.innerHTML = "<i class='fas fa-grip-vertical' style='color: white;'></i>";

      cell2.setAttribute('style', 'padding-right: 1rem;');
      cell2.appendChild(section_title_p);
      cell2.appendChild(lesson_wrapper_div);
      cell2.appendChild(add_new_lesson_a);

      assignDraggableContent();

    }

    // Lesson - Add lesson
    function addLesson(uuid_section, title_lesson = 'New Lesson', desc = '', resource = [], embed = ''){
      
      let uuid_lesson = create_UUID(); // Lesson uuid

      // <div class="lesson-item" id="yyyy" style="border: solid 1px grey; background: white; padding: 1rem; margin-bottom: 1rem;">
      //   <p style="font-size: 15px; font-weight: 400; color: gray; margin: 0.5rem 0;">
      //     <span name="lesson-title">Lesson 1 </span>
      //     <span>                  
      //       <a href="javascript:;" data-toggle="modal" data-target="#editTitleModal" data-id="yyyy" data-name="lesson-title">
      //         <i class="fas fa-pen"></i>
      //       </a>
      //     </span> 
      //     <span style="float: right;">
      //       <i class="fas fa-angle-down" style="color: grey; cursor: pointer; margin-right: 8px;" onclick="showLessonDetail(this)"></i>
      //       <i class="fas fa-minus-circle" style="color: red; cursor: pointer;"  data-toggle="modal" data-target="#removeLessonDetailModal" data-id="yyyy"  data-type="lesson" onclick="//removeRow(this); "></i>
      //     </span>
      //   </p>

      //   <div class="lessonDetail" style="display: '';">
      //     <div class="lessonDetailDesc"  style="margin-top: 0.5rem;">
      //       <div name="description"></div>
      //       <a href="javascript:;" data-toggle="modal" data-target="#addLessonDetailDescModal" data-id="yyyy">
      //         Add description
      //       </a>
      //     </div>
      //     <div class="lessonDetailResources"style="margin-top: 1rem;">
      //       <a href="javascript:;" data-toggle="modal" data-target="#addLessonDetailResourceModal" data-id="yyyy">
      //         Add resources
      //       </a>
      //     </div>
      //     <div class="lessonDetailEmbed" style="margin-top: 1rem;">
      //       <a href="javascript:;" data-toggle="modal" data-target="#addLessonDetailEmbedModal" data-id="yyyy">
      //         Add embeded media
      //       </a>
      //     </div>
      //   </div>
      // </div>

      // Lesson Detail - Desc
      let desc_div = document.createElement('div');
      desc_div.setAttribute('name', 'description');
      // Add Lesson Desc
      let desc_a = document.createElement('a');
      desc_a.href = 'javascript:;';
      desc_a.textContent = 'Add description';
      desc_a.setAttribute('data-toggle', 'modal');
      desc_a.setAttribute('data-target', '#addLessonDetailDescModal');
      desc_a.setAttribute('data-id', uuid_lesson);
      // Edit Lesson Desc
      let editDesc = document.createElement("a");
      editDesc.textContent = "Edit"
      editDesc.setAttribute("href", "javascript:;");
      editDesc.setAttribute("style", "margin-right:12px");
      editDesc.setAttribute("data-toggle", "modal");
      editDesc.setAttribute("data-target", "#addLessonDetailDescModal");
      editDesc.setAttribute("data-id", uuid_lesson);
      editDesc.setAttribute("data-action", 'edit');
      // Remove lesson desc
      let removeDesc = document.createElement("a");
      removeDesc.textContent = "Remove"
      removeDesc.setAttribute("href", "javascript:;");
      removeDesc.setAttribute("data-toggle", "modal");
      removeDesc.setAttribute("data-target", "#removeLessonDetailModal");
      removeDesc.setAttribute("data-id", uuid_lesson);
      removeDesc.setAttribute("data-type", 'description');

      let lessondetaildesc_div = document.createElement('div');
      lessondetaildesc_div.className = "lessonDetailDesc";
      lessondetaildesc_div.setAttribute('style', 'margin-top: 0.5rem;');
      if (desc == null || desc == ""){
        lessondetaildesc_div.appendChild(desc_div);
        lessondetaildesc_div.appendChild(desc_a);
      }
      else {
        desc_div.innerHTML = desc;
        lessondetaildesc_div.appendChild(desc_div);
        lessondetaildesc_div.appendChild(editDesc);
        lessondetaildesc_div.appendChild(removeDesc);
      }


      // Lesson Detail - Resource
      let resource_a = document.createElement('a');
      resource_a.href = 'javascript:;';
      resource_a.textContent = 'Add resource';
      resource_a.setAttribute('data-toggle', 'modal');
      resource_a.setAttribute('data-target', '#addLessonDetailResourceModal');
      resource_a.setAttribute('data-id', uuid_lesson);
      let lessondetailresource_div = document.createElement('div');
      lessondetailresource_div.className = "lessonDetailResources";
      lessondetailresource_div.setAttribute('style', 'margin-top: 1rem;');
      if (resource == null || resource.length == 0){
        // Do nothing
      }
      else {
        resource.forEach((res) => {

          let external_link_alt_html = "<i class='fas fa-external-link-alt'></i>";
          let external_link_alt_a = document.createElement('a');
          external_link_alt_a.setAttribute('href', res)
          external_link_alt_a.setAttribute('target', '_blank');
          external_link_alt_a.innerHTML=external_link_alt_html;
          let external_link_alt_div = document.createElement('div');
          external_link_alt_div.className = "p-2";
          external_link_alt_div.setAttribute('style', 'padding: 0 0.5rem 0 0!important;');
          external_link_alt_div.appendChild(external_link_alt_a);

          let remove_html = "<i class='fas fa-minus-circle' style='color: red; cursor: pointer; float: right;' onclick='removeResource(this);' aria-hidden='true'></i>";
          let remove_div = document.createElement('div');
          remove_div.className = "p-2";
          remove_div.setAttribute('style', 'padding: 0 0.5rem 0 0!important;');
          remove_div.innerHTML = remove_html;

          let url_div = document.createElement('div');
          url_div.className = "p-2";
          url_div.setAttribute('style', 'word-wrap: break-word; overflow-wrap: break-word; word-break: break-word; padding: 0!important;');
          url_div.setAttribute('name', 'resource-item');
          url_div.textContent = res;

          let d_flex_div = document.createElement('div');
          d_flex_div.className = "d-flex align-items-center";
          d_flex_div.setAttribute('name', 'resource');
          d_flex_div.appendChild(external_link_alt_div);
          d_flex_div.appendChild(remove_div);
          d_flex_div.appendChild(url_div);
          lessondetailresource_div.appendChild(d_flex_div);

        });

      }
      lessondetailresource_div.appendChild(resource_a);


      // Lesson Detail - Embed Media
      let embed_a = document.createElement('a');
      embed_a.href = 'javascript:;';
      embed_a.textContent = 'Add embed media';
      embed_a.setAttribute('data-toggle', 'modal');
      embed_a.setAttribute('data-target', '#addLessonDetailEmbedModal');
      embed_a.setAttribute('data-id', uuid_lesson);
      let lessondetailembed_div = document.createElement('div');
      lessondetailembed_div.className = "lessonDetailEmbed";
      lessondetailembed_div.setAttribute('style', 'margin-top: 1rem;');
      if (embed == null || embed == ""){
        lessondetailembed_div.appendChild(embed_a);
      }
      else {
        let embed_div = document.createElement('div');
        embed_div.setAttribute('name', 'embed');
        embed_div.innerHTML = embed;

        let remove_a = document.createElement("a");
        remove_a.textContent = "Remove embeded media"
        remove_a.setAttribute("href", "javascript:;");
        remove_a.setAttribute("data-toggle", "modal");
        remove_a.setAttribute("data-target", "#removeLessonDetailModal");
        remove_a.setAttribute("data-id", uuid_lesson);
        remove_a.setAttribute("data-type", 'embed');

        lessondetailembed_div.appendChild(embed_div);
        lessondetailembed_div.appendChild(remove_a);
      }

      let detail_top_div = document.createElement('div');
      detail_top_div.className = "lessonDetail";
      detail_top_div.setAttribute('style', "display: none;");
      detail_top_div.appendChild(lessondetaildesc_div);
      detail_top_div.appendChild(lessondetailresource_div);
      detail_top_div.appendChild(lessondetailembed_div);

      // Lesson Title
      let lesson_title_html = "<span name='lesson-title'>"+title_lesson+"</span>";
      let lesson_title_edit_html = "<span><a href='javascript:;' data-toggle='modal' data-target='#editTitleModal' data-id='"+uuid_lesson+"' data-name='lesson-title'> <i class='fas fa-pen'></i></a></span>";
      let lesson_title_remove_html = `
          <span style="float: right;">
            <i class="fas fa-angle-down" style="color: grey; cursor: pointer; margin-right: 8px;" onclick="showLessonDetail(this)"></i>
            <i class="fas fa-minus-circle" style="color: red; cursor: pointer;"  data-toggle="modal" data-target="#removeLessonDetailModal" data-id="`+ uuid_lesson+ `" data-type="lesson"></i>
          </span>`
      let lesson_title_all_html = lesson_title_html + lesson_title_edit_html + lesson_title_remove_html
      let title_p = document.createElement('p');
      title_p.setAttribute('style', 'font-size: 15px; font-weight: 400; color: gray; margin: 0.5rem 0;');
      title_p.innerHTML = lesson_title_all_html;

      let lesson_top_div = document.createElement('div');
      lesson_top_div.className = "lesson-item";
      lesson_top_div.id = uuid_lesson;
      lesson_top_div.setAttribute('style', 'border: solid 1px grey; background: white; padding: 1rem; margin-bottom: 1rem;');
      lesson_top_div.appendChild(title_p);
      lesson_top_div.appendChild(detail_top_div);

      // const section = ele.parentElement.querySelector(".lesson-item-wrapper");
      // section.appendChild(lesson_top_div);

      const section = document.getElementById(uuid_section).querySelector(".lesson-item-wrapper");;
      section.appendChild(lesson_top_div);
    }

    // Lesson - Remove lesson
    function removeLesson(lessonItemId) {
      document.getElementById(lessonItemId).remove();
    }
    
    // Content - Show Details
    function showLessonDetail(ele) {
      ele.setAttribute("onclick", "hideLessonDetail(this)");
      ele.className = "fas fa-angle-up";
      let lesson_item = ele.parentNode.parentNode.parentNode; // get the class="lesson-item"
      const lesson_detail = lesson_item.querySelector(".lessonDetail");
      lesson_detail.style.display = "";
    }

    // Content - Hide Details
    function hideLessonDetail(ele) {
      ele.setAttribute("onclick", "showLessonDetail(this)");
      ele.className = "fas fa-angle-down";
      let lesson_item = ele.parentNode.parentNode.parentNode; // get the class="lesson-item"
      const lesson_detail = lesson_item.querySelector(".lessonDetail");
      lesson_detail.style.display = "none";
    }


    // Content - Show Lesson Desc
    function addLessonDetailDesc(ele) {

      let lessonDescHeader = document.createElement("p"); // get the class="lessonDesc"
      lessonDescHeader.textContent = "Description";
      lessonDescHeader.setAttribute("style", "font-size: 15px; font-weight:300; margin: 0.5rem 0; color: grey;")
      let lessonDescTextarea = document.createElement("textarea");
      lessonDescTextarea.className = "detail";

      let removeDesc = document.createElement("a");
      removeDesc.textContent = "Remove description"
      removeDesc.setAttribute("href", "javascript:;");
      removeDesc.setAttribute("onclick", "removeLessonDetailDesc(this)")

      let lessonDesc = ele.parentNode; // get the class="lessonDesc"
      lessonDesc.appendChild(lessonDescHeader);
      lessonDesc.appendChild(lessonDescTextarea);
      lessonDesc.appendChild(removeDesc);

      ele.remove();

      initTinyMCE();

    }

    function addLessonDetailDesc2(itemId, descInnerHtml){

      let lessonDescHeader = document.createElement("p"); // get the class="lessonDesc"
      lessonDescHeader.textContent = "Description";
      lessonDescHeader.setAttribute("style", "font-size: 15px; font-weight:300; margin: 0.5rem 0; color: grey;")

      let lessonDesc_div= document.createElement("div");
      lessonDesc_div.setAttribute("name", "description");
      lessonDesc_div.innerHTML = descInnerHtml;

      let editDesc = document.createElement("a");
      editDesc.textContent = "Edit"
      editDesc.setAttribute("href", "javascript:;");
      editDesc.setAttribute("style", "margin-right:12px");
      editDesc.setAttribute("data-toggle", "modal");
      editDesc.setAttribute("data-target", "#addLessonDetailDescModal");
      editDesc.setAttribute("data-id", itemId);
      editDesc.setAttribute("data-action", 'edit');

      let removeDesc = document.createElement("a");
      removeDesc.textContent = "Remove"
      removeDesc.setAttribute("href", "javascript:;");
      removeDesc.setAttribute("data-toggle", "modal");
      removeDesc.setAttribute("data-target", "#removeLessonDetailModal");
      removeDesc.setAttribute("data-id", itemId);
      removeDesc.setAttribute("data-type", 'description');
      // removeDesc.setAttribute("onclick", "removeLessonDetailDesc('"+itemId+"')")

      const lessonItem = document.getElementById(itemId).querySelector(".lessonDetailDesc");
      lessonItem.innerHTML = "";
      lessonItem.appendChild(lessonDescHeader);
      lessonItem.appendChild(lessonDesc_div);
      lessonItem.appendChild(editDesc);
      lessonItem.appendChild(removeDesc);

    }

    // Content - Remove Lesson Desc
    function removeLessonDetailDesc(lessonItemId) {

      // Empty p tag
      let lessonDesc_p= document.createElement("p");
      lessonDesc_p.setAttribute("name", "description");
      lessonDesc_p.innerHTML = "";

      let addDesc = document.createElement("a");
      addDesc.textContent = "Add description"
      addDesc.setAttribute("href", "javascript:;");
      addDesc.setAttribute("data-toggle", "modal");
      addDesc.setAttribute("data-target", "#addLessonDetailDescModal");
      addDesc.setAttribute("data-id", lessonItemId);
      addDesc.setAttribute("data-action", 'new');


      const lessonItem = document.getElementById(lessonItemId).querySelector(".lessonDetailDesc");
      lessonItem.innerHTML = "";
      lessonItem.appendChild(lessonDesc_p);
      lessonItem.appendChild(addDesc);


      // let addDesc = document.createElement("a");
      // addDesc.textContent = "Add description"
      // addDesc.setAttribute("href", "javascript:;");
      // addDesc.setAttribute("onclick", "addLessonDetailDesc(this)")

      // let lessonDesc = ele.parentNode;
      // lessonDesc.appendChild(addDesc);

      // ele.remove(); // Remove the "Remove description"
      // tinymce.remove(lessonDesc.id);
      // let header = lessonDesc.querySelector("p"); // Remove Textare
      // header.remove();
      // let textarea = lessonDesc.querySelector("textarea"); // Remove Textare
      // textarea.remove();

    }
    
    // Content - Add new resource
    function addLessonDetailResource(lessonItemId, resourceUrl){
      // <div class="d-flex bd-highlight align-items-center" style="padding-top: 1rem; border-top: solid 1px #eee;">
      //   <div class="p-2 bd-highlight" style="padding: 0 0.3rem 0 0!important;">
      //     <a href="https://golearn.com.my" target="_blank">
      //       <i class="fas fa-external-link-alt" aria-hidden="true"></i>
      //     </a>
      //   </div>
      //   <div class="p-2 bd-highlight" style="word-wrap: break-word; min-width: 45vw; max-width: 100vw; padding: 0!important;" name="resource-item">
      //     https://www.google.com/search?q=sotware&amp;oq=sotware&amp;aqs=chrome..69i57j0i10i131i433l3j0i10l2j46i10i131i199i433i465j0i10j0i10i131i433l2.1184j1j7&amp;sourceid=chrome&amp;ie=UTF-8
      //   </div>
      //   <div class="mr-auto p-2  bd-highlight">
      //     <i class="fas fa-minus-circle" style="color: red; cursor: pointer; float: right;" onclick="removeRow(this); " aria-hidden="true"></i>
      //   </div>
      // </div>

      let external_link_alt_html = "<i class='fas fa-external-link-alt'></i>";
      let external_link_alt_a = document.createElement('a');
      external_link_alt_a.setAttribute('href', resourceUrl)
      external_link_alt_a.setAttribute('target', '_blank');
      external_link_alt_a.innerHTML=external_link_alt_html;
      let external_link_alt_div = document.createElement('div');
      external_link_alt_div.className = "p-2";
      external_link_alt_div.setAttribute('style', 'padding: 0 0.5rem 0 0!important;');
      external_link_alt_div.appendChild(external_link_alt_a);

      let remove_html = "<i class='fas fa-minus-circle' style='color: red; cursor: pointer; float: right;' onclick='removeResource(this);' aria-hidden='true'></i>";
      let remove_div = document.createElement('div');
      remove_div.className = "p-2";
      remove_div.setAttribute('style', 'padding: 0 0.5rem 0 0!important;');
      remove_div.innerHTML = remove_html;

      let url_div = document.createElement('div');
      url_div.className = "p-2";
      url_div.setAttribute('style', 'word-wrap: break-word; overflow-wrap: break-word; word-break: break-word; padding: 0!important;');
      url_div.setAttribute('name', 'resource-item');
      url_div.textContent = resourceUrl;

      let d_flex_div = document.createElement('div');
      d_flex_div.className = "d-flex align-items-center";
      d_flex_div.setAttribute('name', 'resource');
      d_flex_div.appendChild(external_link_alt_div);
      d_flex_div.appendChild(remove_div);
      d_flex_div.appendChild(url_div);

      const lessonItem = document.getElementById(lessonItemId).querySelector(".lessonDetailResources");

      lessonItem.insertBefore(d_flex_div, lessonItem.children[0])

    }


    // Content - Add new embed link
    function addLessonDetailEmbed(lessonItemId, embedUrl){
      // <div>
      //   <iframe src="https://player.vimeo.com/video/56063210?h=241ce6669e" width="640" height="480" frameborder="0" allow="autoplay; fullscreen; picture-in-picture" allowfullscreen></iframe>
      //   <p>
      //     <a href="https://vimeo.com/56063210">Video Salon Video Riot</a> from 
      //     <a href="https://vimeo.com/vjculture">VJ Culture</a> on 
      //     <a href="https://vimeo.com">Vimeo</a>.
      //   </p>
      // </div>
      // <a href="javascript:;" onclick="removeLessonDetailEmbed(this)">Remove embeded media</a>

      let embed_div = document.createElement('div');
      embed_div.setAttribute('name', 'embed');
      embed_div.innerHTML = embedUrl;

      let remove_a = document.createElement("a");
      remove_a.textContent = "Remove embeded media"
      remove_a.setAttribute("href", "javascript:;");
      remove_a.setAttribute("data-toggle", "modal");
      remove_a.setAttribute("data-target", "#removeLessonDetailModal");
      remove_a.setAttribute("data-id", lessonItemId);
      remove_a.setAttribute("data-type", 'embed');
      // remove_a.setAttribute("onclick", "removeLessonDetailEmbed('"+lessonItemId+"')")

      const lessonItem = document.getElementById(lessonItemId).querySelector(".lessonDetailEmbed");
      lessonItem.innerHTML = "";
      lessonItem.appendChild(embed_div);
      lessonItem.appendChild(remove_a);

    }

    // Content - Remove embed link
    function removeLessonDetailEmbed(lessonItemId) {
      // <a href="javascript:;" data-toggle="modal" data-target="#addLessonDetailEmbedModal" data-id="yyyy">
      //   Add embeded media
      // </a>
      let addEmbed = document.createElement("a");
      addEmbed.textContent = "Add embeded media"
      addEmbed.setAttribute("href", "javascript:;");
      addEmbed.setAttribute("data-toggle", "modal");
      addEmbed.setAttribute("data-target", "#addLessonDetailEmbedModal");
      addEmbed.setAttribute("data-id", lessonItemId);

      const lessonItem = document.getElementById(lessonItemId).querySelector(".lessonDetailEmbed");
      lessonItem.innerHTML = "";
      lessonItem.appendChild(addEmbed);

    }
    

    // Check if valid url. Return true if valid.
    function isValidHttpUrl(string) {
      let url;
      try {
        url = new URL(string);
      } catch (_) {
        return false;  
      }
      return true;
    }

    //-------- Item Table Handling Start-----------------/
    const table = document.getElementById('tableObj');
    let draggingEle;
    let draggingRowIndex;
    let placeholder;
    let list;
    let isDraggingStarted = false;

    // The current position of mouse relative to the dragging element
    let x = 0;
    let y = 0;

    // Swap two nodes
    const swap = function (nodeA, nodeB) {
        const parentA = nodeA.parentNode;
        const siblingA = nodeA.nextSibling === nodeB ? nodeA : nodeA.nextSibling;

        // Move `nodeA` to before the `nodeB`
        nodeB.parentNode.insertBefore(nodeA, nodeB);

        // Move `nodeB` to before the sibling of `nodeA`
        parentA.insertBefore(nodeB, siblingA);
    };

    // Check if `nodeA` is above `nodeB`
    const isAbove = function (nodeA, nodeB) {
        // Get the bounding rectangle of nodes
        const rectA = nodeA.getBoundingClientRect();
        const rectB = nodeB.getBoundingClientRect();

        return rectA.top + rectA.height / 2 < rectB.top + rectB.height / 2;
    };

    const cloneTable = function () {
      const rect = table.getBoundingClientRect();
      const width = parseInt(window.getComputedStyle(table).width);

      list = document.createElement('div');
      list.classList.add('clone-list');
      list.style.position = 'fixed';
      // list.style.left = `${rect.left}px`;
      // list.style.top = `${rect.top}px`;
      table.parentNode.insertBefore(list, table);

      // Hide the original table
      table.style.visibility = 'hidden';

      table.querySelectorAll('tr').forEach(function (row) {
        // Create a new table from given row
        const item = document.createElement('div');
        item.classList.add('draggable');

        const newTable = document.createElement('table');
        // newTable.setAttribute('class', 'clone-table');
        newTable.setAttribute('class', 'table-light table-sm');
        newTable.setAttribute('cellspacing', "0");
        newTable.setAttribute('width',"100%");
        newTable.style.width = `${width}px`;

        const newRow = document.createElement('tr');
        const cells = [].slice.call(row.children);
        cells.forEach(function (cell) {
          const newCell = cell.cloneNode(true);
          newCell.style.width = `${parseInt(window.getComputedStyle(cell).width)}px`;
          newRow.appendChild(newCell);
        });

        newTable.appendChild(newRow);
        item.appendChild(newTable);
        list.appendChild(item);
      });
    };

    const mouseDownHandler = function (e, item) {
      console.log(e) 
      console.log('item: ', item) 

      // Get the original row
        // Layer 1
        let originalRow = e.target.parentNode;
        if (originalRow.nodeName.toLowerCase() === 'tr'){
          // Correct parents node. Do nothing
        }else {
          // Layer 2
          originalRow = originalRow.parentNode;
          if (originalRow.nodeName.toLowerCase() === 'tr'){
          // Correct parents node. Do nothing
          }else {
            // Layer 3
            originalRow = originalRow.parentNode;
            if (originalRow.nodeName.toLowerCase() === 'tr'){
            // Correct parents node. Do nothing
            }else {
              // Layer 4
              // Impossible to  reach here
              originalRow = originalRow.parentNode;
              if (originalRow.nodeName.toLowerCase() === 'tr'){
              // Correct parents node. Do nothing
              }else {
                // Layer 5
                // Impossible to  reach here
                originalRow = originalRow.parentNode;
                if (originalRow.nodeName.toLowerCase() === 'tr'){
                  // Correct parents node. Do nothing
                }else {
                  // Layer 6
                  // Impossible to  reach here
                  originalRow = originalRow.parentNode;
                  if (originalRow.nodeName.toLowerCase() === 'tr'){
                    // Correct parents node. Do nothing
                  }else {
                    // There must be so many nested tag inside a cell. 
                    // Technically, it is impossible to reach here. 
                    // In case you are here, just add more layers.
                  }
                }
              }
            }
          }

        }

        draggingRowIndex = [].slice.call(table.querySelectorAll('tr')).indexOf(originalRow);
        // Determine the mouse position
        x = e.clientX;
        y = e.clientY;

        // Attach the listeners to `document`
        // document.addEventListener('mousemove', mouseMoveHandler);
        // document.addEventListener('mouseup', mouseUpHandler);
        document.addEventListener('pointermove', mouseMoveHandler);
        document.addEventListener('pointerup', mouseUpHandler);
    };

    const mouseMoveHandler = function (e) {
      if (!isDraggingStarted) {
        isDraggingStarted = true;

        cloneTable();
        // console.log(draggingRowIndex);
        // console.log([].slice.call(list.children));
        draggingEle = [].slice.call(list.children)[draggingRowIndex];
        draggingEle.classList.add('dragging');

        // Let the placeholder take the height of dragging element
        // So the next element won't move up
        placeholder = document.createElement('div');
        placeholder.classList.add('placeholder');
        draggingEle.parentNode.insertBefore(placeholder, draggingEle.nextSibling);
        placeholder.style.height = `${draggingEle.offsetHeight}px`;
      }

      // Set position for dragging element
      draggingEle.style.position = 'absolute';
      draggingEle.style.top = `${draggingEle.offsetTop + e.clientY - y}px`;
      draggingEle.style.left = `${draggingEle.offsetLeft + e.clientX - x}px`;

      // Reassign the position of mouse
      x = e.clientX;
      y = e.clientY;

      // The current order
      // prevEle
      // draggingEle
      // placeholder
      // nextEle
      const prevEle = draggingEle.previousElementSibling;
      const nextEle = placeholder.nextElementSibling;

      // The dragging element is above the previous element
      // User moves the dragging element to the top
      // We don't allow to drop above the header
      // (which doesn't have `previousElementSibling`)
      if (prevEle && prevEle.previousElementSibling && isAbove(draggingEle, prevEle)) {
        // The current order    -> The new order
        // prevEle              -> placeholder
        // draggingEle          -> draggingEle
        // placeholder          -> prevEle
        swap(placeholder, draggingEle);
        swap(placeholder, prevEle);
        return;
      }

      // The dragging element is below the next element
      // User moves the dragging element to the bottom
      if (nextEle && isAbove(nextEle, draggingEle)) {
        // The current order    -> The new order
        // draggingEle          -> nextEle
        // placeholder          -> placeholder
        // nextEle              -> draggingEle
        swap(nextEle, placeholder);
        swap(nextEle, draggingEle);
      }
    };

    const mouseUpHandler = function () {
        // Remove the placeholder
        placeholder && placeholder.parentNode.removeChild(placeholder);

        draggingEle.classList.remove('dragging');
        draggingEle.style.removeProperty('top');
        draggingEle.style.removeProperty('left');
        draggingEle.style.removeProperty('position');

        // Get the end index
        const endRowIndex = [].slice.call(list.children).indexOf(draggingEle);

        isDraggingStarted = false;

        // Remove the `list` element
        list.parentNode.removeChild(list);

        // Move the dragged row to `endRowIndex`
        let rows = [].slice.call(table.querySelectorAll('tr'));
        draggingRowIndex > endRowIndex
            ? rows[endRowIndex].parentNode.insertBefore(rows[draggingRowIndex], rows[endRowIndex])
            : rows[endRowIndex].parentNode.insertBefore(
                  rows[draggingRowIndex],
                  rows[endRowIndex].nextSibling
              );

        // Bring back the table
        table.style.removeProperty('visibility');

        // Remove the handlers of `mousemove` and `mouseup`
        // document.removeEventListener('mousemove', mouseMoveHandler);
        // document.removeEventListener('mouseup', mouseUpHandler);
        document.removeEventListener('pointermove', mouseMoveHandler);
        document.removeEventListener('pointerup', mouseUpHandler);
    };

    // Run first 
    const assignDraggable = function(){
      table.querySelectorAll('tr').forEach(function (row, index) {
        // Ignore the header
        // We don't want user to change the order of header
        if (index === 0) {
            return;
        }
        // Ignore row with certain class name
        else if(row.className != 'item'){
          return;
        } 

        // console.log(row)
        // console.log(row.className)
        const firstCell = row.firstElementChild;
        firstCell.classList.add('draggable');
        // firstCell.addEventListener('mousedown', mouseDownHandler);
        firstCell.addEventListener('pointerdown',  mouseDownHandler);

      });
    }
    //-------- Table Content Handling Start-----------------/
    const tableContent = document.getElementById('tableContent');
    let draggingEleContent;
    let draggingRowIndexContent;
    let placeholderContent;
    let listContent;
    let isDraggingStartedContent = false;

    // The current position of mouse relative to the dragging element
    let xContent = 0;
    let yContent = 0;

    // Swap two nodes
    const swapContent = function (nodeA, nodeB) {
        const parentA = nodeA.parentNode;
        const siblingA = nodeA.nextSibling === nodeB ? nodeA : nodeA.nextSibling;

        // Move `nodeA` to before the `nodeB`
        nodeB.parentNode.insertBefore(nodeA, nodeB);

        // Move `nodeB` to before the sibling of `nodeA`
        parentA.insertBefore(nodeB, siblingA);
    };

    // Check if `nodeA` is above `nodeB`
    const isAboveContent = function (nodeA, nodeB) {
        // Get the bounding rectangle of nodes
        const rectA = nodeA.getBoundingClientRect();
        const rectB = nodeB.getBoundingClientRect();

        return rectA.top + rectA.height / 2 < rectB.top + rectB.height / 2;
    };

    const cloneTableContent = function () {
      const rect = tableContent.getBoundingClientRect();
      const width = parseInt(window.getComputedStyle(tableContent).width);

      listContent = document.createElement('div');
      listContent.classList.add('clone-list');
      listContent.style.position = 'fixed';
      // listContent.style.left = `${rect.left}px`;
      // listContent.style.top = `${rect.top}px`;
      tableContent.parentNode.insertBefore(listContent, tableContent);

      // Hide the original tableContent
      tableContent.style.visibility = 'hidden';

      tableContent.querySelectorAll('tr').forEach(function (row) {
        // Create a new tableContent from given row
        const item = document.createElement('div');
        item.classList.add('draggable');

        const newTable = document.createElement('table');
        // newTable.setAttribute('class', 'clone-table');
        newTable.setAttribute('class', 'table-light table-sm');
        newTable.setAttribute('cellspacing', "0");
        newTable.setAttribute('width',"100%");
        newTable.style.width = `${width}px`;

        const newRow = document.createElement('tr');
        const cells = [].slice.call(row.children);
        cells.forEach(function (cell) {
          const newCell = cell.cloneNode(true);
          newCell.style.width = `${parseInt(window.getComputedStyle(cell).width)}px`;
          newRow.appendChild(newCell);
        });

        newTable.appendChild(newRow);
        item.appendChild(newTable);
        listContent.appendChild(item);
      });
    };

    const mouseDownHandlerContent = function (e, item) {
      console.log(e) 
      console.log('item: ', item) 

      // Get the original row
        // Layer 1
        let originalRow = e.target.parentNode;
        if (originalRow.nodeName.toLowerCase() === 'tr'){
          // Correct parents node. Do nothing
        }else {
          // Layer 2
          originalRow = originalRow.parentNode;
          if (originalRow.nodeName.toLowerCase() === 'tr'){
          // Correct parents node. Do nothing
          }else {
            // Layer 3
            originalRow = originalRow.parentNode;
            if (originalRow.nodeName.toLowerCase() === 'tr'){
            // Correct parents node. Do nothing
            }else {
              // Layer 4
              // Impossible to  reach here
              originalRow = originalRow.parentNode;
              if (originalRow.nodeName.toLowerCase() === 'tr'){
              // Correct parents node. Do nothing
              }else {
                // Layer 5
                // Impossible to  reach here
                originalRow = originalRow.parentNode;
                if (originalRow.nodeName.toLowerCase() === 'tr'){
                  // Correct parents node. Do nothing
                }else {
                  // Layer 6
                  // Impossible to  reach here
                  originalRow = originalRow.parentNode;
                  if (originalRow.nodeName.toLowerCase() === 'tr'){
                    // Correct parents node. Do nothing
                  }else {
                    // There must be so many nested tag inside a cell. 
                    // Technically, it is impossible to reach here. 
                    // In case you are here, just add more layers.
                  }
                }
              }
            }
          }

        }

        draggingRowIndexContent = [].slice.call(tableContent.querySelectorAll('tr')).indexOf(originalRow);
        // Determine the mouse position
        xContent = e.clientX;
        yContent = e.clientY;

        // Attach the listeners to `document`
        // document.addEventListener('mousemove', mouseMoveHandlerContent);
        // document.addEventListener('mouseup', mouseUpHandlerContent);
        document.addEventListener('pointermove', mouseMoveHandlerContent);
        document.addEventListener('pointerup', mouseUpHandlerContent);
    };

    const mouseMoveHandlerContent = function (e) {
      if (!isDraggingStartedContent) {
        isDraggingStartedContent = true;

        cloneTableContent();
        // console.log(draggingRowIndexContent);
        // console.log([].slice.call(listContent.children));
        draggingEleContent = [].slice.call(listContent.children)[draggingRowIndexContent];
        draggingEleContent.classList.add('dragging');

        // Let the placeholderContent take the height of dragging element
        // So the next element won't move up
        placeholderContent = document.createElement('div');
        placeholderContent.classList.add('placeholder');
        draggingEleContent.parentNode.insertBefore(placeholderContent, draggingEleContent.nextSibling);
        placeholderContent.style.height = `${draggingEleContent.offsetHeight}px`;
      }

      // Set position for dragging element
      draggingEleContent.style.position = 'absolute';
      draggingEleContent.style.top = `${draggingEleContent.offsetTop + e.clientY - yContent}px`;
      draggingEleContent.style.left = `${draggingEleContent.offsetLeft + e.clientX - xContent}px`;

      // Reassign the position of mouse
      xContent = e.clientX;
      yContent = e.clientY;

      // The current order
      // prevEle
      // draggingEleContent
      // placeholderContent
      // nextEle
      const prevEle = draggingEleContent.previousElementSibling;
      const nextEle = placeholderContent.nextElementSibling;

      // The dragging element is above the previous element
      // User moves the dragging element to the top
      // We don't allow to drop above the header
      // (which doesn't have `previousElementSibling`)
      if (prevEle && prevEle.previousElementSibling && isAboveContent(draggingEleContent, prevEle)) {
        // The current order    -> The new order
        // prevEle              -> placeholderContent
        // draggingEleContent          -> draggingEleContent
        // placeholderContent          -> prevEle
        swapContent(placeholderContent, draggingEleContent);
        swapContent(placeholderContent, prevEle);
        return;
      }

      // The dragging element is below the next element
      // User moves the dragging element to the bottom
      if (nextEle && isAboveContent(nextEle, draggingEleContent)) {
        // The current order    -> The new order
        // draggingEleContent          -> nextEle
        // placeholderContent          -> placeholderContent
        // nextEle              -> draggingEleContent
        swapContent(nextEle, placeholderContent);
        swapContent(nextEle, draggingEleContent);
      }
    };

    const mouseUpHandlerContent = function () {
        // Remove the placeholderContent
        placeholderContent && placeholderContent.parentNode.removeChild(placeholderContent);

        draggingEleContent.classList.remove('dragging');
        draggingEleContent.style.removeProperty('top');
        draggingEleContent.style.removeProperty('left');
        draggingEleContent.style.removeProperty('position');

        // Get the end index
        const endRowIndex = [].slice.call(listContent.children).indexOf(draggingEleContent);

        isDraggingStartedContent = false;

        // Remove the `listContent` element
        listContent.parentNode.removeChild(listContent);

        // Move the dragged row to `endRowIndex`
        let rows = [].slice.call(tableContent.querySelectorAll('tr'));
        draggingRowIndexContent > endRowIndex
            ? rows[endRowIndex].parentNode.insertBefore(rows[draggingRowIndexContent], rows[endRowIndex])
            : rows[endRowIndex].parentNode.insertBefore(
                  rows[draggingRowIndexContent],
                  rows[endRowIndex].nextSibling
              );

        // Bring back the tableContent
        tableContent.style.removeProperty('visibility');

        // Remove the handlers of `mousemove` and `mouseup`
        // document.removeEventListener('mousemove', mouseMoveHandlerContent);
        // document.removeEventListener('mouseup', mouseUpHandlerContent);
        document.removeEventListener('pointermove', mouseMoveHandlerContent);
        document.removeEventListener('pointerup', mouseUpHandlerContent);
    };

    // Run first 
    const assignDraggableContent = function(){
      tableContent.querySelectorAll('tr').forEach(function (row, index) {
        // Ignore the header
        // We don't want user to change the order of header
        if (index === 0) {
            return;
        }
        // Ignore row with certain class name
        else if(row.className != 'item'){
          return;
        } 

        // console.log(row)
        // console.log(row.className)
        const firstCell = row.firstElementChild;
        firstCell.classList.add('draggable');
        // firstCell.addEventListener('mousedown', mouseDownHandlerContent);
        firstCell.addEventListener('pointerdown',  mouseDownHandlerContent);

      });
    }

    // Add a new row
    function addRow(value = ""){

      // console.log(id)

      // Get the table 
      const table_temp = document.getElementById("tableObj")

      // Get the tbody tag
      const tbody_temp = table_temp.querySelector("tbody");
      // let table_temp = elem.parentNode.parentNode.parentNode;
      // console.log(table_temp);

      // Get the number of tr[class=item] in tbody
      // let draggableRowLastIndex = document.getElementById("body_"+id).querySelectorAll("tr[class=item]").length;
      let draggableRowLastIndex = table_temp.querySelectorAll("tr[class=item]").length;
      // console.log(draggableRowLastIndex);

      // Create an empty <tr> element and add it to the last position of draggable items.
      var row = tbody_temp.insertRow(draggableRowLastIndex);
   
      // Insert new cells (<td> elements) at the 1st and 2nd position of the "new" <tr> element:
      var cell1 = row.insertCell(0);
      var cell2 = row.insertCell(1);
      var cell3 = row.insertCell(2);
  
      row.className = 'item'
      // Add some text to the new cells:
      cell1.innerHTML = "<i class='fas fa-grip-vertical'></i>";
      cell2.innerHTML = `<input type='text' class="form-control" maxlength="160" data-compulsory="true" oninput="this.className = 'form-control'" placeholder=' Enter something ...' value='`+value+`'>`;
      cell3.innerHTML = "<i class='fas fa-minus-circle' style='color: red; cursor: pointer;' onclick='removeRow(this);'></i>";

      assignDraggable();
    }

    // Remove a row
    function removeRow(elem){

      // console.log(elem)
      // Get the original row
      // Layer 1
      let originalRow = elem.parentNode;
      if (originalRow.nodeName.toLowerCase() === 'tr'){
        // Correct parents node. Do nothing
      }else {
        // Layer 2
        originalRow = originalRow.parentNode;
        if (originalRow.nodeName.toLowerCase() === 'tr'){
        // Correct parents node. Do nothing
        }else {
          // Layer 3
          originalRow = originalRow.parentNode;
          if (originalRow.nodeName.toLowerCase() === 'tr'){
          // Correct parents node. Do nothing
          }else {
            // Layer 4
            // Impossible to  reach here
            originalRow = originalRow.parentNode;
            if (originalRow.nodeName.toLowerCase() === 'tr'){
            // Correct parents node. Do nothing
            }else {
              // Layer 5
              // Impossible to  reach here
              originalRow = originalRow.parentNode;
              if (originalRow.nodeName.toLowerCase() === 'tr'){
                // Correct parents node. Do nothing
              }else {
                // Layer 6
                // Impossible to  reach here
                originalRow = originalRow.parentNode;
                if (originalRow.nodeName.toLowerCase() === 'tr'){
                  // Correct parents node. Do nothing
                }else {
                  // There must be so many nested tag inside a cell. 
                  // Technically, it is impossible to reach here. 
                  // In case you are here, just add more layers.
                }
              }
            }
          }
        }

      }

      // $( "#timeSlot-"+id ).remove();
      originalRow.parentNode.removeChild(originalRow);

    }
    

    // Remove a resource 
    function removeResource(elem) {

      let resourceEle = elem.parentElement.parentElement;

      console.log(resourceEle)
      console.log(resourceEle.getAttribute("name"));
      if (resourceEle.getAttribute("name") == 'resource'){
        resourceEle.remove();
      }
      
    }

    // Remove a media 
    function removeMedia(elem) {

      let resourceEle = elem.parentElement.parentElement;

      console.log(resourceEle)
      console.log(resourceEle.getAttribute("name"));
      if (resourceEle.getAttribute("name") == 'resource'){
        resourceEle.remove();
      }
      
    }
  
    // Generate uuid
    function create_UUID(){
      var dt = new Date().getTime();
      var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
          var r = (dt + Math.random()*16)%16 | 0;
          dt = Math.floor(dt/16);
          return (c=='x' ? r :(r&0x3|0x8)).toString(16);
      });
      return uuid;
    }

    // Check course fee limit
    function checkFeeLimit(){
      let fee = document.getElementById("inFee").value;
      if (fee > 9999){
        document.getElementById("inFee").value = 9999;
      }else if (fee < 0){
        document.getElementById("inFee").value = 1;
      }else {
        document.getElementById("inFee").value = fee;
      }
    }

    // Validate fields with data-compulsory=true. 
    function ValidateFields(parentId){
      // This function deals with validation of the form fields with data-compulsory = 'true'
      var x, y, i, valid = true;
      x = document.getElementById(parentId);
      y =x.querySelectorAll('[data-compulsory="true"]');

      // A loop that checks every input field in the current tab:
      for (i = 0; i < y.length; i++) {
        // console.log(y[i].value)
        // If a field is empty...
        if (y[i].value == "") {
          // add an "invalid" class to the field:
          y[i].className += " invalid";
          // and set the current valid status to false:
          valid = false;
        }
      }
      return valid; // return the valid status
    }

    // Save data
    function SaveCourse(isPublish = false){

      let inCourseName = document.getElementById("inCourseName").value;
      let inCourseDesc = document.getElementById("inCourseDesc").value;
      
      // What stu will learn
      const tbody_temp = table.querySelector("tbody");
  
      let trList = tbody_temp.querySelectorAll("tr[class=item]");

      let objList = [];
      trList.forEach((tr) => {
        if (tr.querySelector("input").value != null && tr.querySelector("input").value != "")
          objList.push(tr.querySelector("input").value); // Get the input value of second td in each tr 
      });

      // Time Slot
      getAllTimeSlots();

      // Teaching mode
      let modeList = [];
      if (document.getElementById("modeHomeTutorToStudent").checked) modeList.push(MODE_HOME_TUTOR_TO_STUDENT);
      if (document.getElementById("modeHomeStudentToTutor").checked) modeList.push(MODE_HOME_STUDENT_TO_TUTOR);
      if (document.getElementById("modeGroup").checked) modeList.push(MODE_GROUP);
      if (document.getElementById("modeOnline").checked) modeList.push(MODE_ONLINE);
      if (document.getElementById("modeOnlineGroup").checked) modeList.push(MODE_ONLINE_GROUP);

      // Language
      let lanList = [];
      if (document.getElementById("lanEng").checked) lanList.push(LAN_ENGLISH);
      if (document.getElementById("lanBm").checked) lanList.push(LAN_BM);
      if (document.getElementById("lanBc").checked) lanList.push(LAN_BC);
      if (document.getElementById("lanBt").checked) lanList.push(LAN_BT);
      if (document.getElementById("lanOther").checked) lanList.push(LAN_OTHER);

      
      // Fee Panel
      let inFee = document.getElementById("inFee").value;
      let inFeeType = document.getElementById("feeTypePerMonthRadio").checked ? FEES_TYPE_PER_MONTH_KEY : FEES_TYPE_PER_HOUR_KEY;
      let inCourseFeeDesc = document.getElementById("inCourseFeeDesc").value;

      // Promotion
      let includeList = [];
      if (document.getElementById("incLM").checked) includeList.push('LM');
      if (document.getElementById("incFD").checked) includeList.push('FD');
      if (document.getElementById("inc30MTC").checked) includeList.push('30MTC');
      if (document.getElementById("incFCF").checked) includeList.push('FCF');
      if (document.getElementById("incFG").checked) includeList.push('FG');
      if (document.getElementById("incAOMeet").checked) includeList.push('AOMeet');
      if (document.getElementById("incAOZoom").checked) includeList.push('AOZoom');
      if (document.getElementById("incAOWebex").checked) includeList.push('AOWebex');
      if (document.getElementById("incAOTeams").checked) includeList.push('AOTeams');
      if (document.getElementById("incAOFb").checked) includeList.push('AOFb');
      if (document.getElementById("incAOYoutube").checked) includeList.push('AOYoutube');

      // Course Status
      let inCourseStatus = courseStatus;
      if (isPublish)
        inCourseStatus = COURSE_STATUS_REVIEW;
      
      var data = {
        [COURSE_NAME]: inCourseName,
        [COURSE_DESC]: inCourseDesc,
        [COURSE_TIMESLOT_DAY_OF_WEEK_ARR]: dayOfWeekArr,
        [COURSE_TIMESLOT_START_ARR]: startTimeArr,
        [COURSE_TIMESLOT_END_ARR]: endTimeArr,
        [COURSE_OBJ_ARR]: objList,
        [COURSE_MODE_ARR]: modeList,
        [COURSE_LAN_ARR]: lanList,
        [COURSE_INCLUDE]: includeList,
        [COURSE_FEE]: inFee,
        [COURSE_FEE_TYPE]: inFeeType,
        [COURSE_FEE_DESC]: inCourseFeeDesc,
        [COURSE_STATUS]: inCourseStatus,
        [COURSE_DATE_UPDATE]: new Date(),
      }
      console.log(data)

      var batch = db.batch();
      var courseRef = db.collection("course")
      .doc('v1')
      .collection("course")
      .doc(courseId);

      batch.update(courseRef, data);


      let content = getCourseContent();
      // console.log(content);

      var courseContentRef = null ;

      var dataContent = {}
      if (courseContentId == null || courseContentId == ""){
        courseContentRef = db.collection("course")
          .doc('v1')
          .collection("content")
          .doc();

        dataContent = {
          [COURSE_CONTENT_UID]: courseContentRef.id,
          [COURSE_CONTENT_ADMIN_ID]: tutorId,
          [COURSE_CONTENT_COURSE_ID]: courseId,
          [COURSE_CONTENT_CLASS_ID]: courseClassId,
          [COURSE_CONTENT_ITEM]: content,
          [COURSE_CONTENT_DATE_UPDATE]: new Date(),
        }
        batch.set(courseContentRef, dataContent);

      }else {
        courseContentRef = db.collection("course")
          .doc('v1')
          .collection("content")
          .doc(courseContentId);
        dataContent = {
          [COURSE_CONTENT_CLASS_ID]: courseClassId,
          [COURSE_CONTENT_ITEM]: content,
          [COURSE_CONTENT_DATE_UPDATE]: new Date(),
        }
        batch.update(courseContentRef, dataContent);

      }
      
      // console.log('inCourseName :' + inCourseName)
      // console.log('original Course Name :' + courseNameOri )
      // console.log('Course Name changes? :' + inCourseName==courseNameOri )
      // console.log('isPublish :' + isPublish)

      // Send a publish request to admin if publish triggered or lesson name change
      if (isPublish || inCourseName!=courseNameOri){

        courseNameOri = inCourseName; // Update course name

        var courseAdminNotificationRef = db.collection("course")
          .doc('v1')
          .collection("admin_notification")
          .doc();
        const COURSE_ADMIN_UID = 'id';
        const COURSE_ADMIN_TUTOR_ID = "aid";
        const COURSE_ADMIN_COURSE_ID = "cid";
        const COURSE_ADMIN_COURSE_NAME = "name";
        const COURSE_ADMIN_COURSE_CAT_ID = "cat";
        const COURSE_ADMIN_COURSE_SUB_ID = "sub";
        const COURSE_ADMIN_REVIEW_TYPE = "type";
          const COURSE_ADMIN_REVIEW_TYPE_PUBLISH = "publish"; 
          const COURSE_ADMIN_REVIEW_TYPE_NAME = "name_changed"; 
        const COURSE_ADMIN_REVIEW_COMMENT = "comment";
        const COURSE_ADMIN_REVIEW_STATUS = "status"; 
          const COURSE_ADMIN_REVIEW_STATUS_DRAFT = "draft"; 
          const COURSE_ADMIN_REVIEW_STATUS_APPROVE = "approve"; 
          const COURSE_ADMIN_REVIEW_STATUS_REJECT = "reject"; 
        const COURSE_ADMIN_COURSE_FINAL_URL = "url"; 
        const COURSE_ADMIN_DATE_UPDATE = "dateU";
        const COURSE_ADMIN_DATE_REVIEW = "dateR";

        var dataAdminNotification = {
          [COURSE_ADMIN_UID]: courseAdminNotificationRef.id,
          [COURSE_ADMIN_TUTOR_ID]: tutorId,
          [COURSE_ADMIN_COURSE_ID]: courseId,
          [COURSE_ADMIN_COURSE_NAME]: inCourseName,
          [COURSE_ADMIN_COURSE_CAT_ID]: courseCat,
          [COURSE_ADMIN_COURSE_SUB_ID]: courseSub,
          [COURSE_ADMIN_REVIEW_TYPE]: isPublish ? COURSE_ADMIN_REVIEW_TYPE_PUBLISH : COURSE_ADMIN_REVIEW_TYPE_NAME,
          [COURSE_ADMIN_REVIEW_COMMENT]: '',
          [COURSE_ADMIN_REVIEW_STATUS]: COURSE_ADMIN_REVIEW_STATUS_DRAFT,
          [COURSE_ADMIN_COURSE_FINAL_URL]: '',
          [COURSE_ADMIN_DATE_UPDATE]: new Date(),
          [COURSE_ADMIN_DATE_REVIEW]: null,
        }
        batch.set(courseAdminNotificationRef, dataAdminNotification, {merge : true});

      }

      batch.commit()
      // For normal update - After commited the changes, run ajax to regenerate the html with latest changes 
      .then(() => {

        if (!isPublish){
          //TODO: Create a html in golearn.com.my/all-courses/<courseFinalUrl>.html using php
          // https://golearn.com.my/all-courses/a-source/create-course.php?courseid=Yjs2d35YwYE2VHGxqd2c&tutorid=KzYwMTM4MjUyODE4&contentid=&v=20220420
          
          var courseTutorIdEncoded = encode64(tutorId);
          var createCourseUrl = "https://golearn.com.my/all-courses/a-source/create-course.php?courseid=" + courseId + "&tutorid=" + courseTutorIdEncoded+ "&contentid=&v=" + "20220420";
          console.log("Creating course")
          console.log(createCourseUrl);

          return Promise.resolve(
            $.ajax({
              type: "GET",
              url: createCourseUrl,
              data: $(this).serialize(),
              success: function(response)
              {
                console.log(response)
          
              },
              error: function(xhr, textStatus, error) {
                  console.log(xhr.responseText);
                  console.log(xhr.statusText);
                  console.log(xhr);
                  console.log(textStatus);
                  console.log(error);
                  func.showNotification('top','center', 'danger', 'error_outline', "Creating HTML failed. Contact technical person now!");

              }

            })
          )
        }
        

      })
      // Update sitemap
      .then(() => {
        if (!isPublish){
          console.log("Updating sitemap")
          let path = 'all-courses/' + courseFinalUrl + ".html";
          let sitemapParam = "https://golearn.com.my/update-sitemap.php?action="+"update"+"&path="+path+"&lastmod=&sitemap=" + "sitemap-all-courses";

          return Promise.resolve(
            $.ajax({
              type: "GET",
              url: sitemapParam,
              data: $(this).serialize(),
              success: function(response)
              {
                console.log(response)
              },
              error: function(xhr, textStatus, error) {
                  console.log(xhr.responseText);
                  console.log(xhr.statusText);
                  console.log(xhr);
                  console.log(textStatus);
                  console.log(error);
                  func.showNotification('top','center', 'danger', 'error_outline', "Update sitemap failed. Contact technical person now!");
              }
            })
          )

        }
  
        
      })
      // Reload page
      .then(() => {
        func.showNotification('top','center', 'success', 'check_circle', "Course successfully updated" );
        if (isPublish){
          window.location.reload();
        }
      })

    }

    // Get the course content
    function getCourseContent(){
      // Course Content Format
      // [0] HEADER - UNUSED
      // [1] SECTION
      // [2] <section setting> UNUSED ( Can be used to set visibility)
      // [3] <section title> - Chapter 1
      // [4] LESSON
      // [5] <lesson setting> UNUSED (Can be used to set visibility / lesson type)
      // [6] <lesson title> - Addtion
      // [7] LESSON_DESCRIPTION
      // [8] <lesson description - html>
      // [9] LESSON_RESOURCE
      // [10] <lesson resource 1 - url >
      // [11] <lesson resource 2 - url >
      // [12] LESSON_EMBED
      // [13] <lesson embed media - html>
      // [14] LESSON (empty lesson)
      // [15] <lesson setting> UNUSED (Can be used to set visibility / lesson type)
      // [16] <lesson title> - Subtraction
      // [17] LESSON_DESCRIPTION
      // [19] LESSON_RESOURCE
      // [20] LESSON_EMBED
      // [21] SECTION (empty section)
      // [22] <section setting> UNUSED ( Can be used to set visibility)
      // [23] <section title> - Chapter 1

      var content = [];
      content.push('') // Empty header

      // Get all section
      var sectionList = tableContent.querySelectorAll('tr[class=item]');

      if (sectionList == null || sectionList.length == 0){
        // No content
      }
      else {
        // Get Lesson item 
        sectionList.forEach((section) => {

          content.push("SECTION") // New section
          content.push("") // Section setting
          var sectionTitle = section.querySelector('span[name=section-title]').textContent;
          content.push(sectionTitle) // Section setting

          // Get the section title
          var lessonItemList = section.querySelectorAll('div[class=lesson-item]');

          if (lessonItemList == null || lessonItemList.length == 0){
            // Do nothing
          }
          else {
            // Get the lesson content

            lessonItemList.forEach((lessonItem) => {

              content.push("LESSON") // New lesson
              content.push("") // New lesson

              var title = lessonItem.querySelector("span[name=lesson-title]").textContent
              content.push(title) 

              var descEle = lessonItem.querySelector("div[name=description");
              var desc = '';
              if (descEle != null) {
                desc = descEle.innerHTML;
              }
              content.push("LESSON_DESC");
              content.push(desc);

              var resourceList = lessonItem.querySelectorAll("div[name=resource-item]");
              // var resourceArr = [];
              content.push("LESSON_RESOURCE");
              if (resourceList != null && resourceList.length > 0){
                resourceList.forEach((resource) => {
                  content.push(resource.innerHTML);

                })    
              }

              var embedEle = lessonItem.querySelector("div[name=embed]");
              var embed = '';
              if (embedEle != null) {
                embed = embedEle.innerHTML;
              }
              content.push("LESSON_EMBED");
              content.push(embed);

            });

          }

        });

      }

      return content;
    }
  
    //---------- Init All Admin's Class details ----------//
    const classAdminLoadmore = document.getElementById('btnClassLoadMore');
    classAdminLoadmore.style.visibility='hidden';
    const classAdminLoadmoreHandleClick = () =>{
      loadAllAdminClasses();
    }
    classAdminLoadmore.addEventListener('click', classAdminLoadmoreHandleClick );

   // Load All Class that owned by class admin. 
    var allClassData = []; 
    var allCourseId = []; // Used to disabled linked Class
    var allCourseCat = []; // Used to disabled used Category
    var allCourseSub = []; // Used to disabled used Subject
    var latestClassDoc = '';// Store last document - Used for Class Load More btn

    function loadAllAdminClasses(){

      var docRef = db.collection("Class")
        .doc("v1")
        .collection("Class")
        .where(CLASS_ADMIN_ID, "==", tutorId)
        .where(STATUS_KEY, "==", true)
        .orderBy(CLASS_STATUS, 'asc')
        .orderBy(CLASS_NAME, 'asc')
        .startAfter(latestClassDoc)
        .limit(25);

      const promiseArr = [];

      promiseArr.push(docRef.get());

      Promise.all(promiseArr).then((snapshots) => {
    
        // For Class
        document.getElementById("card-load").style.display = "none";
        if (( snapshots[0].docs.length== null || snapshots[0].docs.length == 0) && latestClassDoc == null){
          document.getElementById("noDataPlaceholder").style.display = 'initial';
        }else{
          document.getElementById("noDataPlaceholder").style.display = 'none';
        }

        if (snapshots[0].empty){
          // Load empty data 
        }else {
          snapshots[0].forEach((doc) => {
            allClassData.push(doc.data());
            // console.log(doc.data());

            // Check if course already existed.
            let courseExist = false;
            allCourseId.forEach((courseId) => {
              if (courseId == doc.data()[CLASS_ID] && courseId != ""){
                courseExist = true;
              }

            });

            renderAllActiveClasses(doc, courseExist);

          });

          // console.log(allClassData)

        }

        // Load more handling
        latestClassDoc = snapshots[0].docs[snapshots[0].docs.length - 1];
        // console.log(snapshots[0].docs.length)

        // Handle Lesson Load more btn
        if (snapshots[0].empty){
          classAdminLoadmore.removeEventListener('click', classAdminLoadmoreHandleClick );
        }
        if (snapshots[0].docs.length == 25){
          classAdminLoadmore.style.visibility='visible';
        }else{
          classAdminLoadmore.style.visibility='hidden';
        }

      })


    }

    
    // Render all class view
    function renderAllActiveClasses(doc, courseExist){
      // <div class="row tutor-wrapper">
      //   <div class="col-md-1">
      //     <div style="height: 50px; width: 50px; display: inline-block; position: relative; overflow: hidden; border-radius: 50%;">
      //       <img id="viewTutorImgUrl" style="height: 100%;width: 100%; object-fit: cover;" src="../../assets/img/empty-photo.png"/>
      //     </div>
      //   </div>
      //   <div class="col-md-6">
      //     <p class="tutor-item">Y3 English Class</p>
      //   </div>
      //   <div class="col-md-3">
      //     <p class="tutor-item">Alric Liew </p>
      //   </div>
      //   <div class="col-md-2">
      //     <button type="button" class="btn btn-primary btn-sm" data-dismiss="modal" id="btnSelectTutor">Select</button>
      //   </div>
      // </div>

      let imgUrl_temp = "";
      let img = document.createElement('img');
      img.setAttribute('style', 'height: 100%; width: 100%; object-fit: cover;');

      // Check if img is valid. If no, create a 2 chars avatar
      if (doc.data()[CLASS_IMG_URL] == null || doc.data()[CLASS_IMG_URL] == "" 
      || doc.data()[CLASS_IMG_URL] == "data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D"
      || tutorImgUrlChecker(doc.data()[CLASS_IMG_URL])){

        let AvatarText = doc.data()[CLASS_NAME][0] + doc.data()[CLASS_NAME][1];
        img.src = generateAvatar(AvatarText, "#eaeaea", "#f6f6f6", "100px");
        imgUrl_temp = "";

      }
      else {
        img.src = doc.data()[CLASS_IMG_URL];
        imgUrl_temp = doc.data()[CLASS_IMG_URL];
      }

      let img_div = document.createElement('div');
      img_div.setAttribute('style', 'height: 50px; width: 50px; display: inline-block; position: relative; overflow: hidden; border-radius: 50%;');
      img_div.appendChild(img);
      let imgTop_div = document.createElement('div');
      imgTop_div.className = "col-md-1";
      imgTop_div.appendChild(img_div);

      // Class Name
      let className_p = document.createElement('p');
      className_p.className = "tutor-item";
      className_p.textContent = doc.data()[CLASS_NAME];
      let className_div = document.createElement('div');
      className_div.className = "col-md-6";
      className_div.appendChild(className_p);

      // Class Teacher Name
      let teacherText = '';
      if (doc.data()[CLASS_TUTOR_NAME_ARR][1] == null || doc.data()[CLASS_TUTOR_NAME_ARR][1] == ""){
        // Check if second teacher existed
        teacherText = doc.data()[CLASS_TUTOR_NAME_ARR][0];
      }else {
        teacherText = doc.data()[CLASS_TUTOR_NAME_ARR][0]+", "+doc.data()[CLASS_TUTOR_NAME_ARR][1];
      }
      let tutorName_p = document.createElement('p');
      tutorName_p.className = "tutor-item";
      tutorName_p.textContent = teacherText;
      let tutorName_div = document.createElement('div');
      tutorName_div.className = "col-md-3";
      tutorName_div.appendChild(tutorName_p);

      let sel_btn = document.createElement('button');
      sel_btn.className = "btn btn-primary btn-sm";
      if (courseExist){
        sel_btn.textContent = 'Linked';
        sel_btn.setAttribute('disabled', true);

      }else {
        sel_btn.textContent = 'Select';
      }
      sel_btn.setAttribute('data-dismiss','modal');
      sel_btn.setAttribute('type','button')
      sel_btn.setAttribute('onclick',"AddClassDetailsToField('"+doc.data()[CLASS_ID]+"')");
      let sel_div = document.createElement('div');
      sel_div.className = "col-md-2";
      sel_div.appendChild(sel_btn);

      let tutorDetail_div = document.createElement('div');
      tutorDetail_div.className = 'row tutor-wrapper';
      tutorDetail_div.appendChild(imgTop_div);
      tutorDetail_div.appendChild(className_div);
      tutorDetail_div.appendChild(tutorName_div);
      tutorDetail_div.appendChild(sel_div);

      const add_tutor_modal_container = document.getElementById("add-tutor-modal-container");
      add_tutor_modal_container.appendChild(tutorDetail_div);

      // add_tutor_modal_container.insertBefore(tutorDetail_div, add_tutor_modal_container.children[1])
    }

        // Populate class data to fields 
    function AddClassDetailsToField(class_id){
      allClassData.forEach((item) => {
        if (item.id == class_id){
          document.getElementById("inClassName").textContent = item[CLASS_NAME];
          // document.getElementById("inClassNameId").setAttribute('value', item[CLASS_ID]);
          saveLinkedClass(item[CLASS_ID], item[CLASS_NAME]);
        }
      });
    }

    // Update the class Id in course
    function saveLinkedClass(classId, className){
      
      courseClassId = classId; // assigne the class id to the original one

      var data = {
        [COURSE_CLASS_ID]: classId,
        [COURSE_DATE_UPDATE]: new Date(),
      }
      console.log(data)

      var batch = db.batch();
      var courseRef = db.collection("course")
      .doc('v1')
      .collection("course")
      .doc(courseId);

      batch.update(courseRef, data);

      if (courseContentId == null || courseContentId == ""){
        // Do nothing
      }else {
        var courseContentRef = db.collection("course")
          .doc('v1')
          .collection("content")
          .doc(courseContentId);

        var dataContent = {
            [COURSE_CONTENT_COURSE_ID]: classId,
            [COURSE_CONTENT_DATE_UPDATE]: new Date(),
          }
        batch.update(courseContentRef, dataContent);
      }

      batch.commit().then(() => {
        document.getElementById("btnLinkClass").textContent = 'Unlink';
        document.getElementById("btnLinkClass").setAttribute('data-target', '#unlinkModal');
        document.getElementById("btnLinkClass").removeAttribute('disabled');
        func.showNotification('top','center', 'success', 'check_circle', "Successfully linked to " + className );
      });

    }

    // Remove the class Id in course
    function removeLinkedClass(){
      var data = {
        [COURSE_CLASS_ID]: '',
        [COURSE_DATE_UPDATE]: new Date(),
      }
      console.log(data)

      var batch = db.batch();
      var courseRef = db.collection("course")
      .doc('v1')
      .collection("course")
      .doc(courseId);

      batch.update(courseRef, data);

      if (courseContentId == null || courseContentId == ""){
        // Do nothing
      }else {
        var courseContentRef = db.collection("course")
          .doc('v1')
          .collection("content")
          .doc(courseContentId);

        var dataContent = {
            [COURSE_CONTENT_COURSE_ID]: '',
            [COURSE_CONTENT_DATE_UPDATE]: new Date(),
          }
        batch.update(courseContentRef, dataContent);
      }

      batch.commit().then(() => {
        document.getElementById("inClassName").textContent = '';
        // document.getElementById("inClassNameId").setAttribute('value', item[CLASS_ID]);
        document.getElementById("btnLinkClass").textContent = 'Link';
        document.getElementById("btnLinkClass").setAttribute('data-target', '#addClassModal');
        document.getElementById("btnLinkClass").removeAttribute('disabled');
        func.showNotification('top','center', 'success', 'check_circle', "Class unlinked" );
      })

    }


    // This function check the validity of imgUrl. Return true when invalid.
    function tutorImgUrlChecker(imgUrl){
      // Tutor Panel
      let isHelloGifExist = false ;
      let helloGifArr =  imgUrl.match(/hello.gif/gi)
      if ( helloGifArr != null) {
        if (helloGifArr.length > 0){
          isHelloGifExist = true;
        }
      }
      let isEmptyPhotoPngExist = false;
      let emptyPhotoPngArr = imgUrl.match(/empty-photo.png/gi)
      if ( emptyPhotoPngArr != null) {
        if (emptyPhotoPngArr.length > 0){
          isEmptyPhotoPngExist = true;
        }
      }
      let isGeneratedAvatar = false; 
      let generatedAvatarArr = imgUrl.match(/data:image\/png;base64,/gi)
      if ( generatedAvatarArr != null) {
        if (generatedAvatarArr.length > 0){
          isGeneratedAvatar = true;
        }
      }

      if (isHelloGifExist || isEmptyPhotoPngExist || isGeneratedAvatar)
        return true;
      else
        return false;
    }

    // Update Course Status
    function updateCourseStatus(){
      var data = {};
      if (courseStatus === COURSE_STATUS_ACTIVE){
        data = {
          [COURSE_STATUS]: COURSE_STATUS_ACTIVE,
          [COURSE_DATE_UPDATE]: new Date(),
        }
      }
      else if (courseStatus === COURSE_STATUS_INACTIVE){
        data = {
          [COURSE_STATUS]: COURSE_STATUS_INACTIVE,
          [COURSE_DATE_UPDATE]: new Date(),
        }
      }

      var batch = db.batch();
      var courseRef = db.collection("course")
      .doc('v1')
      .collection("course")
      .doc(courseId);

      batch.update(courseRef, data);

      batch.commit().then(() => {
        func.showNotification('top','center', 'success', 'check_circle', "Course Status Updated! Reloading ... ");
        window.location.reload();
      });

    }


    function deleteClass(){
      
      var batch = db.batch();
      var courseRef = db.collection("course")
      .doc('v1')
      .collection("course")
      .doc(courseId);

      var courseContentRef = db.collection("course")
      .doc('v1')
      .collection("content")
      .doc(courseContentId);

      batch.delete(courseRef);

      batch.delete(courseContentRef);


      // batch.commit().then(() => {
      //   func.showNotification('top','center', 'success', 'check_circle', "Course Status Deleted! ");
      
      //   window.location = "./"
      // });
    }

  </script>

  <script>

    $( document ).ready(function() {

      // General Panel: Character limitations
      $('#inCourseName').on('input', function(){        
        document.getElementById("countCourseName").textContent = this.value.length + '/80';
        
        if (this.value != courseNameOri){
          document.getElementById("btnPublishDiv").style.display = "";
          document.getElementById("btnPublish").removeAttribute("disabled");
          document.getElementById("btnPublish").textContent = "Publish";
        }
      });

      $('#inCourseDesc').on('input', function(){        
        document.getElementById("countCourseDesc").textContent = this.value.length + '/400'
      });
      
      $('#inCourseFeeDesc').on('input', function(){        
        document.getElementById("countCourseFeeDesc").textContent = this.value.length + '/250'
      });

      // Populate Time Slot 
      $('#btnAddTimeSlot').on('click', function(e) {

        e.preventDefault();

        // create empty timeslot placeholder
        addTimeSlot('','','');

        // Reinit the time picker 
        initTimePicker();
      });

      // Content Panel
      
      // Content panel
      var EDIT_ITEM_ID = '';
      var EDIT_ITEM_TITLE = ''; 
      var EDIT_ITEM_NAME = ''; // section-title / lesson-title

      // Edit Item Modal
      $('#editTitleModal').on('show.bs.modal', function (event) {

        var button = $(event.relatedTarget) // Button/Components that triggered the modal

        EDIT_ITEM_ID = button.data('id');
        EDIT_ITEM_NAME = button.data('name');
        console.log(EDIT_ITEM_ID, EDIT_ITEM_NAME);

        // Get the lesson / section title
        EDIT_ITEM_TITLE = document.getElementById(EDIT_ITEM_ID).querySelector("span[name="+EDIT_ITEM_NAME+"]").textContent; 

        console.log(EDIT_ITEM_TITLE);
        document.getElementById("inItemId").setAttribute("value", EDIT_ITEM_ID);
        document.getElementById("inItemName").setAttribute("value", EDIT_ITEM_NAME);
        document.getElementById("inItemTitle").value = EDIT_ITEM_TITLE;
        document.getElementById("countName").textContent = EDIT_ITEM_TITLE.length + '/80'

      });
      
      // Clear all values
      $('#editTitleModal').on('hide.bs.modal', function (event) {
        EDIT_ITEM_ID = "";
        EDIT_ITEM_NAME = "";
        EDIT_ITEM_TITLE = "";
        document.getElementById("inItemTitle").value = "";
        document.getElementById("inItemId").setAttribute("value", "");
        document.getElementById("inItemName").setAttribute("value", "");

      });
      
      // Update the selected item
      $('#btnEditTitleModalUpdate').on('click', function (e) {

        let itemId = document.getElementById("inItemId").getAttribute('value');
        let itemName = document.getElementById("inItemName").getAttribute('value');
        let itemTitle = document.getElementById("inItemTitle").value;
        // console.log(itemId, itemName, itemTitle);

        // Update the edited value
        document.getElementById(itemId).querySelector("span[name="+itemName+"]").textContent = itemTitle;

		  });

      
      $('#inItemTitle').on('input', function(event){        
        document.getElementById("countName").textContent = this.value.length + '/80'
      });


      // Edit Description Model
      var ADD_DESC_ITEM_ID = '';
      var ADD_DESC_ACTION_ID = ''; // new (Add new description) / edit (Edit description)

      $('#addLessonDetailDescModal').on('show.bs.modal', function (event) {

        var button = $(event.relatedTarget) // Button/Components that triggered the modal
        ADD_DESC_ITEM_ID = button.data('id') 
        ADD_DESC_ACTION_ID = button.data('action') 

        // console.log(itemParent)
        // console.log(button[0].parentElement.parentElement.textContent)

        document.getElementById("inLessonDetailDescId").setAttribute("value", ADD_DESC_ITEM_ID);

        if (ADD_DESC_ACTION_ID == 'edit'){
          let descTopEle = document.getElementById(ADD_DESC_ITEM_ID).querySelector(".lessonDetailDesc");
          let descEle = descTopEle.querySelector("div[name=description]");
          // console.log(descTopEle);
          // console.log(descEle);

          initTinyMCE();

          tinymce.get("inLessonDetailDesc").setContent(descEle.innerHTML);

          // document.getElementById("inLessonDetailDesc").value = ;
        }
        else {
          initTinyMCE();
        }
        

      });

      // Clear all values
      $('#addLessonDetailDescModal').on('hide.bs.modal', function (event) {
        ADD_DESC_ITEM_ID = '';
        document.getElementById("inLessonDetailDesc").value = "";
        document.getElementById("btnaddLessonDetailDescModalUpdate").setAttribute("disabled", true);

        tinymce.get("inLessonDetailDesc").setContent('');

      });

      // Add a new description
      $('#btnaddLessonDetailDescModalUpdate').on('click', function (e) {
        let descInnerHtml = tinymce.get("inLessonDetailDesc").getContent();
        let itemId = document.getElementById("inLessonDetailDescId").getAttribute('value')

        addLessonDetailDesc2(itemId, descInnerHtml);

		  });


      // Edit Resource Model
      var ADD_RESOURCE_ITEM_ID = '';

      $('#addLessonDetailResourceModal').on('show.bs.modal', function (event) {

        var button = $(event.relatedTarget) // Button/Components that triggered the modal
        ADD_RESOURCE_ITEM_ID = button.data('id') 
        // console.log(itemParent)
        // console.log(button[0].parentElement.parentElement.textContent)

        document.getElementById("inLessonDetailResourceId").setAttribute("value", ADD_RESOURCE_ITEM_ID);

      });

      // Clear all values
      $('#addLessonDetailResourceModal').on('hide.bs.modal', function (event) {
        ADD_RESOURCE_ITEM_ID = '';
        document.getElementById("inLessonDetailResource").value = "";
        document.getElementById("btnaddLessonDetailResourceModalUpdate").setAttribute("disabled", true);
        document.getElementById("inLessonDetailResourceValid").textContent = ""
      });

      // Check if valid url
      $('#inLessonDetailResource').on('keyup', function(){  
        // console.log(this.value)
        // console.log(isValidHttpUrl(this.value))

        if (isValidHttpUrl(this.value)){
          document.getElementById("inLessonDetailResourceValid").textContent = ""
          document.getElementById("btnaddLessonDetailResourceModalUpdate").removeAttribute("disabled");
        }else{
          document.getElementById("inLessonDetailResourceValid").textContent = "Please enter a valid url.";
          document.getElementById("btnaddLessonDetailResourceModalUpdate").setAttribute("disabled", true);
        }
      });
      
      // Add a new resource
      $('#btnaddLessonDetailResourceModalUpdate').on('click', function (e) {

        let itemId = document.getElementById("inLessonDetailResourceId").getAttribute('value')
        let itemResourceUrl = document.getElementById("inLessonDetailResource").value;
        console.log(itemId, itemResourceUrl)
        addLessonDetailResource(itemId, itemResourceUrl);

		  });

      // Edit Embed Media Model
      var ADD_EMBED_ITEM_ID = '';

      $('#addLessonDetailEmbedModal').on('show.bs.modal', function (event) {

        var button = $(event.relatedTarget) // Button/Components that triggered the modal
        ADD_EMBED_ITEM_ID = button.data('id') 
        // console.log(itemParent)
        // console.log(button[0].parentElement.parentElement.textContent)

        document.getElementById("inLessonDetailEmbedId").setAttribute("value", ADD_EMBED_ITEM_ID);

      });

      // Clear all values
      $('#addLessonDetailEmbedModal').on('hide.bs.modal', function (event) {
        ADD_EMBED_ITEM_ID = '';
        document.getElementById("inLessonDetailEmbed").value = "";
        document.getElementById("btnaddLessonDetailEmbedModalUpdate").setAttribute("disabled", true);
        document.getElementById("inLessonDetailEmbedValid").textContent = ""
      });

      // Check if valid embed code
      $('#inLessonDetailEmbed').on('keyup', function(){  
        // console.log(this.value)
        // console.log(isValidHttpUrl(this.value))

        let pattern1 = /<\s*iframe/i;
        let pattern2 = /<\s*\/iframe\s*>/i;
        let result1 = this.value.match(pattern1)
        let result2 = this.value.match(pattern2)

        if (result1 != null && result2 != null){
          document.getElementById("inLessonDetailEmbedValid").textContent = ""
          document.getElementById("btnaddLessonDetailEmbedModalUpdate").removeAttribute("disabled");
        }else{
          document.getElementById("inLessonDetailEmbedValid").textContent = "Please enter an valid embed code.";
          document.getElementById("btnaddLessonDetailEmbedModalUpdate").setAttribute("disabled", true);
        }
      });
      
      // Add a new embed media
      $('#btnaddLessonDetailEmbedModalUpdate').on('click', function (e) {

        let itemId = document.getElementById("inLessonDetailEmbedId").getAttribute('value')
        let itemResourceUrl = document.getElementById("inLessonDetailEmbed").value;
        console.log(itemId, itemResourceUrl)
        addLessonDetailEmbed(itemId, itemResourceUrl);

		  });

      // Remove Lesson Item Model
      var REMOVE_ITEM_ID = '';
      var REMOVE_ITEM_TYPE = ''; // description, resource, embed, lesson (Entire lesson item), section (Entire section +all items in it)

      $('#removeLessonDetailModal').on('show.bs.modal', function (event) {

        var button = $(event.relatedTarget) // Button/Components that triggered the modal
        REMOVE_ITEM_ID = button.data('id'); 
        REMOVE_ITEM_TYPE = button.data('type');

        document.getElementById("removeLessonDetailId").setAttribute('value', REMOVE_ITEM_ID);
        document.getElementById("removeLessonDetailType").setAttribute('value', REMOVE_ITEM_TYPE);

        if (REMOVE_ITEM_TYPE == 'description'){
          document.getElementById("removeLessonDetailModalTitle").textContent = "Description";
        }
        else if (REMOVE_ITEM_TYPE == 'resource'){
          document.getElementById("removeLessonDetailModalTitle").textContent = "Resource";
        }
        else if (REMOVE_ITEM_TYPE == 'embed'){
          document.getElementById("removeLessonDetailModalTitle").textContent = "Embeded Media";
        }
        else if (REMOVE_ITEM_TYPE == 'lesson'){
          document.getElementById("removeLessonDetailModalTitle").textContent = "This Lesson";
        }
        else if (REMOVE_ITEM_TYPE == 'section'){
          document.getElementById("removeLessonDetailModalTitle").textContent = "Entire Section";
        }

      });

      // Clear all values
      $('#removeLessonDetailModal').on('hide.bs.modal', function (event) {
        REMOVE_ITEM_ID = '';
        REMOVE_ITEM_TYPE = '';
        document.getElementById("removeLessonDetailId").setAttribute('value', '');
        document.getElementById("removeLessonDetailType").setAttribute('value', '');
      });

      // Remove Item 
      $('#btnRemoveLessonDetaillUpdate').on('click', function (e) {

        let removeItemId = document.getElementById("removeLessonDetailId").getAttribute('value')
        let removeItemType = document.getElementById("removeLessonDetailType").getAttribute('value')

        // description, resource, embed, lesson, section
        if (removeItemType == 'description'){
          removeLessonDetailDesc(removeItemId);
        }
        else if (removeItemType == 'resource'){
          removeLessonDetailDesc(removeItemId);
        }
        else if (removeItemType == 'embed'){
          removeLessonDetailEmbed(removeItemId);
        }
        else if (removeItemType == 'lesson'){
          removeLesson(removeItemId);
        }
        else if (removeItemType == 'section'){
          removeSection(removeItemId);
        }
        
		  });

      // Advanced panel: Delete Class
      $('#delCourseModalIn').on('input', function(){
        if (this.value === 'DELETE'){
          $('#btndelCourseModalUpdate').prop('disabled', false);
        }
        else{
          $('#btndelCourseModalUpdate').prop('disabled', true);
        }
      });

      // Advanced panel: Delete Class btn clicked
      $('#btndelCourseModalUpdate').on('click', function (event) {
        
        deleteClass();

      });

      // Save and Proceed - Save btn clicked
      $('#btnSaveModalUpdate').on('click', function (event) {
        
        let validateField = ValidateFields('multitabs_form');

        if (validateField){
          SaveCourse();
        }
        else {
          func.showNotification('top','center', 'danger', 'error_outline', 'Please make sure all compulsory fields are filled up.' );

        }
        

      });

      // Publish & Save - Publish btn clicked
      $('#btnPublishModalUpdate').on('click', function (event) {
        
        let validateField = ValidateFields('multitabs_form');

        if (validateField){

          SaveCourse(true); // isPublish == true
        }
        else {
          func.showNotification('top','center', 'danger', 'error_outline', 'Please make sure all compulsory fields are filled up.' );
        }
        

      });


      // Load All Admin's Classes
      $('#addClassModal').on('show.bs.modal', function (event) {
        latestClassDoc = '';
        allClassData = [];

        loadAllAdminClasses();

        document.getElementById("card-load").style.display = "";

        // Add click listener to load more
        classAdminLoadmore.addEventListener('click', classAdminLoadmoreHandleClick );
        classAdminLoadmore.style.visibility='hidden';
      });
      
      // Remove all Admin's class
      $('#addClassModal').on('hidden.bs.modal', function (event) {
        latestClassDoc = '';
        allClassData = [];

        var classList = document.getElementById("add-tutor-modal-container").querySelectorAll(".tutor-wrapper")
        classList.forEach((item) => {
          item.remove();
        })
      });

      
      // Publish & Save - Publish btn clicked
      $('#btnUnlinkModalUpdate').on('click', function (event) {

        removeLinkedClass();

      });

      // Advanced: Class Status

      // Remove Lesson Item Model
      $('#statusToggleModal').on('show.bs.modal', function (event) {
  
        if (courseStatus === COURSE_STATUS_DRAFT){
          document.getElementById("classStatusCheck").checked = false;
          document.getElementById("btnStatusToggleModalUpdate").setAttribute('style', 'display:none');
          document.getElementById("statusToggleLabel").textContent = "Ops! You can't do so"
          document.getElementById("inCourseStatusToggleMessage").textContent =  "Publish your course first!"
        }
        else if (courseStatus === COURSE_STATUS_REVIEW){
          document.getElementById("classStatusCheck").checked = false;
          document.getElementById("btnStatusToggleModalUpdate").setAttribute('style', 'display:none');
          document.getElementById("statusToggleLabel").textContent = "Under Review"
          document.getElementById("inCourseStatusToggleMessage").textContent =  "This course is under review. It takes around 36 hours for the review process to be completed."
        }
        else if (courseStatus === COURSE_STATUS_SUSPENDED){
          document.getElementById("classStatusCheck").checked = false;
          document.getElementById("btnStatusToggleModalUpdate").setAttribute('style', 'display:none');
          document.getElementById("statusToggleLabel").textContent = "Course Suspended"
          document.getElementById("inCourseStatusToggleMessage").textContent =  "This course is suspended."
        }
        else if (courseStatus === COURSE_STATUS_INACTIVE){
          document.getElementById("statusToggleLabel").textContent = "Activate Course?"
          document.getElementById("inCourseStatusToggleMessage").textContent =  "Are you sure you want to continue?"
        }
        else if (courseStatus === COURSE_STATUS_ACTIVE){
          document.getElementById("statusToggleLabel").textContent = "Deactivate Course?"
          document.getElementById("inCourseStatusToggleMessage").textContent =  "Are you sure you want to continue?"
        }
        else {
          document.getElementById("btnStatusToggleModalUpdate").setAttribute('style', 'display:none');

        }

      });
      
      // Remove all Admin's class
      $('#statusToggleModal').on('hidden.bs.modal', function (event) {
        document.getElementById("btnStatusToggleModalUpdate").setAttribute('style', "display:''");
        document.getElementById("statusToggleLabel").textContent = "";
        document.getElementById("inCourseStatusToggleMessage").textContent =  "";
      });

      $('#btnStatusToggleModalUpdate').on('click', function (event) {
        
        
        if(document.getElementById("classStatusCheck").checked){
          courseStatus = COURSE_STATUS_ACTIVE;
        }else {
          courseStatus = COURSE_STATUS_INACTIVE;
        }
        // console.log(document.getElementById("classStatusCheck").checked, courseStatus)
        console.log('courseStatus : ' + courseStatus);
        updateCourseStatus();

        
      });

      $('#btnStatusToggleModalClose1').on('click', function (event) {
        if (courseStatus === COURSE_STATUS_INACTIVE){
          document.getElementById("classStatusCheck").checked = false;
        }
        else if (courseStatus === COURSE_STATUS_ACTIVE){
          document.getElementById("classStatusCheck").checked = true;
        }
        else {
          document.getElementById("classStatusCheck").checked = false;
        }        
      });

      // When cancelled, change back to the ori states
      $('#btnStatusToggleModalClose2').on('click', function (event) {
        if (courseStatus === COURSE_STATUS_INACTIVE){
          document.getElementById("classStatusCheck").checked = false;
        }
        else if (courseStatus === COURSE_STATUS_ACTIVE){
          document.getElementById("classStatusCheck").checked = true;
        }
        else {
          document.getElementById("classStatusCheck").checked = false;
        }
      });

		});


  </script>
 
 
   <!-- Multiform-specific script -->
   <script>
    //DOM elements
    const DOMstrings = {
      stepsBtnClass: 'multitabs-form__progress-btn',
      stepsBtns: document.querySelectorAll(`.multitabs-form__progress-btn`),
      stepsBar: document.querySelector('.multitabs-form__progress'),
      stepsForm: document.querySelector('.multitabs-form__form'),
      stepsFormTextareas: document.querySelectorAll('.multitabs-form__textarea'),
      stepFormPanelClass: 'multitabs-form__panel',
      stepFormPanels: document.querySelectorAll('.multitabs-form__panel'),
      stepPrevBtnClass: 'js-btn-prev',
      stepNextBtnClass: 'js-btn-next',
      stepSendBtnClass: 'js-btn-send' };


    //remove class from a set of items
    const removeClasses = (elemSet, className) => {

      elemSet.forEach(elem => {

        elem.classList.remove(className);

      });

    };

    //return exect parent node of the element
    const findParent = (elem, parentClass) => {

      let currentNode = elem;

      while (!currentNode.classList.contains(parentClass)) {
        currentNode = currentNode.parentNode;
      }

      return currentNode;

    };

    //get active button step number
    const getActiveStep = elem => {
      return Array.from(DOMstrings.stepsBtns).indexOf(elem);
    };

    //set all steps before clicked (and clicked too) to active
    const setActiveStep = activeStepNum => {

      //remove active state from all the state
      removeClasses(DOMstrings.stepsBtns, 'js-active');

      //set picked items to active
      DOMstrings.stepsBtns.forEach((elem, index) => {

        if (index == activeStepNum) {
          elem.classList.add('js-active');
        }

      });
    };

    //get active panel
    const getActivePanel = () => {

      let activePanel;

      DOMstrings.stepFormPanels.forEach(elem => {

        if (elem.classList.contains('js-active')) {

          activePanel = elem;

        }

      });

      return activePanel;

    };

    //open active panel (and close unactive panels)
    const setActivePanel = activePanelNum => {

      //remove active class from all the panels
      removeClasses(DOMstrings.stepFormPanels, 'js-active');

      //show active panel
      DOMstrings.stepFormPanels.forEach((elem, index) => {
        if (index === activePanelNum) {

          elem.classList.add('js-active');

          setFormHeight(elem);

        }
      });

    };

    //set form height equal to current panel height
    const formHeight = activePanel => {

      const activePanelHeight = activePanel.offsetHeight;

      DOMstrings.stepsForm.style.height = `${activePanelHeight}px`;

    };

    const setFormHeight = () => {
      const activePanel = getActivePanel();

      formHeight(activePanel);
    };

    //STEPS BAR CLICK FUNCTION
    DOMstrings.stepsBar.addEventListener('click', e => {

      //check if click target is a step button
      const eventTarget = e.target;

      if (!eventTarget.classList.contains(`${DOMstrings.stepsBtnClass}`)) {
        return;
      }

      

      //get active button step number
      const activeStep = getActiveStep(eventTarget);

      //set all steps before clicked (and clicked too) to active
      setActiveStep(activeStep);

      //open active panel
      setActivePanel(activeStep);
    });

    //PREV/NEXT BTNS CLICK
    DOMstrings.stepsForm.addEventListener('click', e => {
       
      const eventTarget = e.target;

      //check if we clicked on `PREV` or NEXT` buttons
      if (eventTarget.classList.contains(`${DOMstrings.stepSendBtnClass}`))
      {
        // Create Class btn is clicked
        // /Class/v1/Class/ZGeLtRmzIaOPuBkbhHTH
        var docRef = db.collection("Class")
          .doc("v1")
          .collection("Class")
          .doc();

        // Notice that I use .add(..), instead of .set(..). This is because the docRef do not specify the docId.
        
        // func.showNotification('top','center', 'success', 'check_circle', "Class created.");
      }
      else if (eventTarget.classList.contains(`${DOMstrings.stepPrevBtnClass}`) || eventTarget.classList.contains(`${DOMstrings.stepNextBtnClass}`))
      {
        // Proceed to move to next / prev page
      }else{
        // Do nothing and return 
        return;
        
      }

      //find active panel
      const activePanel = findParent(eventTarget, `${DOMstrings.stepFormPanelClass}`);

      let activePanelNum = Array.from(DOMstrings.stepFormPanels).indexOf(activePanel);

      //set active step and active panel onclick
      if (eventTarget.classList.contains(`${DOMstrings.stepPrevBtnClass}`)) {
        activePanelNum--;

        setActiveStep(activePanelNum);
        setActivePanel(activePanelNum);
      } else {

        if (!validateForm(activePanelNum)){
          
        }else{
          activePanelNum++;
          setActiveStep(activePanelNum);
          setActivePanel(activePanelNum);
        }
      }
      // setActiveStep(activePanelNum);
      // setActivePanel(activePanelNum);
    });

    //SETTING PROPER FORM HEIGHT ONLOAD
    window.addEventListener('load', setFormHeight, false);

    //SETTING PROPER FORM HEIGHT ONRESIZE
    window.addEventListener('resize', setFormHeight, false);

    //changing animation via animation select !!!YOU DON'T NEED THIS CODE (if you want to change animation type, just change form panels data-attr)

    const setAnimationType = newType => {
      DOMstrings.stepFormPanels.forEach(elem => {
        elem.dataset.animation = newType;
      });
    };

    function validateForm(activePanelNum) {
      // This function deals with validation of the form fields with data-compulsory = 'true'
      var x, y, i, valid = true;
      x = document.getElementsByClassName("multitabs-form__panel");
      // y = x[activePanelNum].getElementsByTagName("input") && x[activePanelNum].querySelectorAll('[type="text"]');
      y =x[activePanelNum].querySelectorAll('[data-compulsory="true"]');

      // A loop that checks every input field in the current tab:
      for (i = 0; i < y.length; i++) {
        // console.log(y[i].value)
        // If a field is empty...
        if (y[i].value == "") {
          // add an "invalid" class to the field:
          y[i].className += " invalid";
          // and set the current valid status to false:
          valid = false;
        }
      }
      // If the valid status is true, mark the step as finished and valid:
      if (valid) {
        // document.getElementsByClassName("step")[activePanelNum].className += " finish";
      }
      return valid; // return the valid status
    }

  </script>

  <!-- Table Handler -->
  <script>
    // https://htmldom.dev/drag-and-drop-table-row/
    document.addEventListener('DOMContentLoaded', function () {
      table.querySelectorAll('tr').forEach(function (row, index) {
        // Ignore the header
        // We don't want user to change the order of header
        if (index === 0) {
            return;
        }
        // Ignore row with certain class name
        else if(row.className != 'item'){
          return;
        } 

        // console.log(row)
        // console.log(row.className)
        const firstCell = row.firstElementChild;
        firstCell.classList.add('draggable');
        // firstCell.addEventListener('mousedown', mouseDownHandler);
        firstCell.addEventListener('pointerdown',  mouseDownHandler );

      });
      assignDraggable();

      tableContent.querySelectorAll('tr').forEach(function (row, index) {
        // Ignore the header
        // We don't want user to change the order of header
        if (index === 0) {
            return;
        }
        // Ignore row with certain class name
        else if(row.className != 'item'){
          return;
        } 

        // console.log(row)
        // console.log(row.className)
        const firstCell = row.firstElementChild;
        firstCell.classList.add('draggable');
        // firstCell.addEventListener('mousedown', mouseDownHandlerContent);
        firstCell.addEventListener('pointerdown',  mouseDownHandlerContent );

      });
      assignDraggableContent();

    });
  </script>

</body>

</html>