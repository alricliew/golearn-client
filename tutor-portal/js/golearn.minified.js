var latestDoc=null;$("#sort-dropdown-menu .dropdown-item").click(function(){$("#SortBy:first-child").text($(this).text()),$("#SortBy:first-child").val($(this).text()),clearTutor(),latestDoc=null,window.location.href="#submitsearch";var e=$(this).text();loadTutor(gState,gArea,gLevel,gSubject,gOnlineOnly,e)}),$(".SortBy").on("change",function(){alert($(this).text())});const dropdownMenuButton=document.querySelector("#SortBy");function loadTutor(e,t,n,l,a,o="asc"){let c="fees",i="asc",d=999999;switch(o){case"Price Low to High":c="fees",i="asc",d=0;break;case"Price High to Low":c="fees",i="desc",d=999999;break;case"Highest Rated":c="rating",i="desc",d=999999;break;default:c="fees",i="asc",d=0}if(console.log(c+"  "+i),a){var s="country/malaysia/state/online/category/"+n+"/subject/"+l+"/tutor";db.collection(s).orderBy(c,i).startAfter(latestDoc||d).limit(10).get().then(e=>{dropdownMenuButton.style.visibility="visible";for(let t=0;t<e.docs.length;t++){renderTutor(e.docs[t],t)}latestDoc=e.docs[e.docs.length-1],e.empty&&loadmore.removeEventListener("click",handleClick),e.docs.length<10?loadmore.style.visibility="hidden":loadmore.style.visibility="visible"}).catch(e=>{dropdownMenuButton.style.visibility="hidden",console.log("Error getting documents: ",e)})}else{s="country/malaysia/state/"+e+"/area/"+t+"/category/"+n+"/subject/"+l+"/tutor";db.collection(s).orderBy(c,i).startAfter(latestDoc||0).limit(10).get().then(e=>{dropdownMenuButton.style.visibility="visible";for(let t=0;t<e.docs.length;t++){renderTutor(e.docs[t],t)}latestDoc=e.docs[e.docs.length-1],e.empty&&loadmore.removeEventListener("click",handleClick),e.docs.length<10?loadmore.style.visibility="hidden":loadmore.style.visibility="visible"}).catch(e=>{dropdownMenuButton.style.visibility="hidden",console.log("Error getting documents: ",e)})}}dropdownMenuButton.style.visibility="hidden";const loadmore=document.querySelector("#loadmore");loadmore.style.visibility="hidden";const handleClick=()=>{loadTutor(gState,gArea,gLevel,gSubject,gOnlineOnly)};function renderTutor(e,t){let n=document.createElement("img");n.className="profile-image",null!=e.data().imgUrl||""!=e.data().imgUrl?n.src=e.data().imgUrl:(e.data().gender=0)?n.src="source/icon_boy01.png":n.src="source/icon_girl01.png";let l=document.createElement("div");l.className="img-box",l.appendChild(n);let a=document.createElement("li");a.className="social-item";let o=document.createElement("img");o.className="social-image";let c=document.createElement("span");c.className="tooltiptext",1==e.data().profileStatus[0]?(o.src="source/green-name-24.png",c.textContent="Profile VERIFIED"):(o.src="source/black-name-24.png",c.textContent="Profile"),a.appendChild(o),a.appendChild(c);let i=document.createElement("li");i.className="social-item";let d=document.createElement("img");d.className="social-image";let s=document.createElement("span");s.className="tooltiptext",1==e.data().profileStatus[1]?(d.src="source/green-iphone-24.png",s.textContent="Phone VERIFIED"):(d.src="source/black-iphone-24.png",s.textContent="Phone"),i.appendChild(d),i.appendChild(s);let r=document.createElement("li");r.className="social-item";let m=document.createElement("img");m.className="social-image";let p=document.createElement("span");p.className="tooltiptext",1==e.data().profileStatus[2]?(m.src="source/green-view-details-24.png",p.textContent="Qualification VERIFIED"):(m.src="source/black-view-details-24.png",p.textContent="Qualification"),r.appendChild(m),r.appendChild(p);let u=document.createElement("li");u.className="social-item";let h=document.createElement("img");h.className="social-image";let g=document.createElement("span");g.className="tooltiptext",1==e.data().profileStatus[3]?(h.src="source/green-marker-24.png",g.textContent="Location VERIFIED"):(h.src="source/black-marker-24.png",g.textContent="Location"),u.appendChild(h),u.appendChild(g);let C=document.createElement("span");C.className="fa fa-star fa-1.5x checked";let f=document.createElement("span");f.className="rating_font",rating=Math.round(e.data().rating/e.data().ratingTimes);let y=document.createElement("p");y.className="review",0==e.data().ratingTimes?f.textContent=" Not Rated":1==e.data().ratingTimes?(f.textContent=" "+rating,y.textContent=e.data().ratingTimes+"review"):(f.textContent=" "+rating,y.textContent=e.data().ratingTimes+"reviews");let b=document.createElement("ul");b.className="social-list",b.appendChild(a),b.appendChild(i),b.appendChild(r),b.appendChild(u);let E=document.createElement("div");E.className="profile-sidebar",E.appendChild(l),E.appendChild(b),E.appendChild(C),E.appendChild(f),E.appendChild(y);let N=document.createElement("h2");N.className="profile-name",N.textContent=e.data().name;let v=document.createElement("p");v.className="profile-detail";let x=0==e.data().gender?"Male":"Female",w=e.data().age,k=e.data().yearsExperience,T="";T=null==k||0==k?x+" | "+w:1==k?x+" | "+w+" |  1 year of experience":x+" | "+w+" | "+k+" years of experience",v.textContent=T;let S=document.createElement("p");S.className="profile-education",S.textContent=e.data().qualification;let A=document.createElement("p");A.className="profile-area",A.textContent=e.data().preferedAreaList;let I=document.createElement("p");I.className="profile-subject",I.textContent=e.data().preferedSubjectList;let R=document.createElement("p");R.className="profile-experience",R.textContent=e.data().tutoringApproach;let B=document.createElement("div");B.className="profile-main",B.appendChild(N),B.appendChild(v),B.appendChild(S),B.appendChild(A),B.appendChild(I),B.appendChild(R);let L=document.createElement("div");L.className="card",L.appendChild(E),L.appendChild(B);let M=document.createElement("a");M.className="btn btn-success btn-lg btn-block",M.setAttribute("id","selecttutor"),M.setAttribute("role","button"),M.setAttribute("target","_blank");let O="https://golearn.com.my/enquire-tutor/?tutor_name="+encodeURIComponent(e.data().name)+"&type="+(gOnlineOnly?"online":"home")+"&level="+encodeURIComponent(gLevelName)+"&subject="+encodeURIComponent(gSubjectName)+"&stop="+(gOnlineOnly?"":encodeURIComponent(" at"))+"&area="+(gOnlineOnly?"":encodeURIComponent(gArea))+"&areastop="+(gOnlineOnly?"":encodeURIComponent(","))+"&state="+(gOnlineOnly?"":encodeURIComponent(gStateName));console.log(O),M.href=O,M.textContent="Request Now";let F="";F+="<span class='profile-fee-bold'>RM"+calculateMonthlyFee(e.data().fees,e.data().feesType)+"</span>/month";let D=document.createElement("p");D.className="profile-fee",D.innerHTML=F;let U=document.createElement("span");U.className="tooltiptext-profile-fee",U.textContent="Assuming 2 hours per lesson, 4 lessons in a month";let j=document.createElement("div");j.className="fee-item";let q=document.createElement("div");if("Per Hour"==e.data().feesType){j.appendChild(D),j.appendChild(U);let t=document.createElement("p");t.className="profile-fee-hourly-rate",t.textContent="(RM"+e.data().fees+"/hour)",q.className="col-sm",q.appendChild(j),q.appendChild(t)}else j.appendChild(D),q.className="col-sm",q.appendChild(j);let P=document.createElement("div");P.className="col-sm";let $=document.createElement("div");$.className="col-sm",$.appendChild(M);let H=document.createElement("div");H.className="row",H.appendChild(q),H.appendChild(P),H.appendChild($);let _=document.createElement("div");_.className="container",_.appendChild(H);let V=document.createElement("div");V.className="footer",V.appendChild(_);let Q=document.createElement("div");Q.className="tutor-card",Q.setAttribute("id","tutor-card"),Q.appendChild(L),Q.appendChild(V);let G=document.createElement("h3");G.className="d-flex justify-content-center",4==t?G.textContent="Hard to decide? Let us help you.":9==t&&(G.textContent="Get the best offer from us!");let z=document.createElement("div");z.className="col-md-8 col-sm-8 mx-3",z.setAttribute("id","heading"),z.appendChild(G);let J=document.createElement("a");J.className="btn btn-warning btn-block bg-light active",J.href="https://golearn.com.my/request-a-tutor/",J.setAttribute("role","button"),J.setAttribute("id","requestnow-btn"),J.setAttribute("target","_blank"),J.textContent="Find Now";let K=document.createElement("div");K.className="col-md-3 col-sm-3 mx-3",K.appendChild(J);let W=document.createElement("div");W.className="col-md-1 col-sm-1";let X=document.createElement("div");X.className="row",X.setAttribute("id","heading-full-length"),X.appendChild(z),X.appendChild(K),X.appendChild(W);const Y=document.querySelector("#tutor-list");4==t||9==t?(Y.appendChild(Q),Y.appendChild(X)):Y.appendChild(Q)}function calculateMonthlyFee(e,t){return"Per Month"==t?e:2*e*4}function clearTutor(){var e=document.getElementById("tutor-list").childNodes;try{for(var t=e.length-1;t>=0;t--){var n=e[t];n.parentNode.removeChild(n)}}catch(e){console.log("No tutor list created yet")}}loadmore.addEventListener("click",handleClick);var mybutton=document.getElementById("myBtn");function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?mybutton.style.display="block":mybutton.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}window.onscroll=function(){scrollFunction()};